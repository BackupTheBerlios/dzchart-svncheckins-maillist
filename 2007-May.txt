From twm at mail.berlios.de  Sat May  5 21:30:34 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Sat, 5 May 2007 21:30:34 +0200
Subject: [Dzchart-svncheckins] r140 - utilities/dzLib/trunk/tests/dzfileutils
Message-ID: <200705051930.l45JUY1M006442@sheep.berlios.de>

Author: twm
Date: 2007-05-05 21:29:21 +0200 (Sat, 05 May 2007)
New Revision: 140

Modified:
   utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dproj
Log:
removed dunit sources from search path because the unit FastMMMemLeakCheck cannot be found

Modified: utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dproj
===================================================================
--- utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dproj	2007-04-01 18:12:14 UTC (rev 139)
+++ utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dproj	2007-05-05 19:29:21 UTC (rev 140)
@@ -1,4 +1,5 @@
-?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+?<?xml version="1.0" encoding="utf-8"?>
+<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
   <PropertyGroup>
     <ProjectGuid>{9732bdc0-39a6-4dbb-817c-3fb77772e288}</ProjectGuid>
     <MainSource>DUnitTest_dzFileUtils.dpr</MainSource>
@@ -17,10 +18,10 @@
   <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
     <Version>7.0</Version>
     <DCC_Define>DEBUG;_CONSOLE_TESTRUNNER;no_translation</DCC_Define>
-    <DCC_UnitSearchPath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;;$(BDS)\Source\DUnit\src;..\..\inc</DCC_UnitSearchPath>
-    <DCC_ResourcePath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;;$(BDS)\Source\DUnit\src;..\..\inc</DCC_ResourcePath>
-    <DCC_ObjPath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;;$(BDS)\Source\DUnit\src;..\..\inc</DCC_ObjPath>
-    <DCC_IncludePath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;;$(BDS)\Source\DUnit\src;..\..\inc</DCC_IncludePath>
+    <DCC_UnitSearchPath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;..\..\inc</DCC_UnitSearchPath>
+    <DCC_ResourcePath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;..\..\inc</DCC_ResourcePath>
+    <DCC_ObjPath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;..\..\inc</DCC_ObjPath>
+    <DCC_IncludePath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;..\..\inc</DCC_IncludePath>
     <DCC_DcuOutput>dcu</DCC_DcuOutput>
     <DCC_ObjOutput>dcu</DCC_ObjOutput>
     <DCC_HppOutput>dcu</DCC_HppOutput>
@@ -34,45 +35,7 @@
     <Borland.Personality>Delphi.Personality</Borland.Personality>
     <Borland.ProjectType />
     <BorlandProject>
-<BorlandProject xmlns=""> <Delphi.Personality>   <Parameters>
-      <Parameters Name="UseLauncher">False</Parameters>
-      <Parameters Name="LoadAllSymbols">True</Parameters>
-      <Parameters Name="LoadUnspecifiedSymbols">False</Parameters>
-    </Parameters>
-    <VersionInfo>
-      <VersionInfo Name="IncludeVerInfo">False</VersionInfo>
-      <VersionInfo Name="AutoIncBuild">False</VersionInfo>
-      <VersionInfo Name="MajorVer">1</VersionInfo>
-      <VersionInfo Name="MinorVer">0</VersionInfo>
-      <VersionInfo Name="Release">0</VersionInfo>
-      <VersionInfo Name="Build">0</VersionInfo>
-      <VersionInfo Name="Debug">False</VersionInfo>
-      <VersionInfo Name="PreRelease">False</VersionInfo>
-      <VersionInfo Name="Special">False</VersionInfo>
-      <VersionInfo Name="Private">False</VersionInfo>
-      <VersionInfo Name="DLL">False</VersionInfo>
-      <VersionInfo Name="Locale">1033</VersionInfo>
-      <VersionInfo Name="CodePage">1252</VersionInfo>
-    </VersionInfo>
-    <VersionInfoKeys>
-      <VersionInfoKeys Name="CompanyName"></VersionInfoKeys>
-      <VersionInfoKeys Name="FileDescription"></VersionInfoKeys>
-      <VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys>
-      <VersionInfoKeys Name="InternalName"></VersionInfoKeys>
-      <VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys>
-      <VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys>
-      <VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys>
-      <VersionInfoKeys Name="ProductName"></VersionInfoKeys>
-      <VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys>
-      <VersionInfoKeys Name="Comments"></VersionInfoKeys>
-    </VersionInfoKeys>
-    <Source>
-      <Source Name="MainSource">DUnitTest_dzFileUtils.dpr</Source>
-    </Source>
-  </Delphi.Personality>   <UnitTesting>   <TestFramework>DUnit / Delphi Win32</TestFramework>
-    <TestRunner>GUI</TestRunner>
-  </UnitTesting>
-</BorlandProject></BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><VersionInfo><VersionInfo Name="IncludeVerInfo">False</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1033</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionI!
 nfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Source><Source Name="MainSource">DUnitTest_dzFileUtils.dpr</Source></Source></Delphi.Personality><UnitTesting><TestFramework>DUnit / Delphi Win32</TestFramework><TestRunner>GUI</TestRunner></UnitTesting></BorlandProject></BorlandProject>
   </ProjectExtensions>
   <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
   <ItemGroup>



From twm at mail.berlios.de  Sat May  5 22:31:23 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Sat, 5 May 2007 22:31:23 +0200
Subject: [Dzchart-svncheckins] r141 - in component/trunk: . Packages
	Packages/Delphi2006 Packages/Delphi2007
	Packages/Delphi2007/dcu examples examples/test-d2007
Message-ID: <200705052031.l45KVNKJ011260@sheep.berlios.de>

Author: twm
Date: 2007-05-05 22:31:13 +0200 (Sat, 05 May 2007)
New Revision: 141

Added:
   component/trunk/Packages/Delphi2007/
   component/trunk/Packages/Delphi2007/dcldummzeuchchart.dpk
   component/trunk/Packages/Delphi2007/dcldummzeuchchart.dproj
   component/trunk/Packages/Delphi2007/dcu/
   component/trunk/Packages/Delphi2007/dummzeuchchart.dpk
   component/trunk/Packages/Delphi2007/dummzeuchchart.dproj
   component/trunk/dzchart-d2007.groupproj
   component/trunk/examples/test-d2007/
   component/trunk/examples/test-d2007/ChartTest.dpr
   component/trunk/examples/test-d2007/ChartTest.dproj
   component/trunk/examples/test-d2007/w_ChartTest.dfm
   component/trunk/examples/test-d2007/w_ChartTest.pas
Modified:
   component/trunk/Packages/Delphi2006/
Log:
support for Delphi 2007


Property changes on: component/trunk/Packages/Delphi2006
___________________________________________________________________
Name: svn:ignore
   + dcldummzeuchchart.res



Property changes on: component/trunk/Packages/Delphi2007
___________________________________________________________________
Name: svn:ignore
   + dcldummzeuchchart.res
dummzeuchchart.res


Added: component/trunk/Packages/Delphi2007/dcldummzeuchchart.dpk
===================================================================
--- component/trunk/Packages/Delphi2007/dcldummzeuchchart.dpk	2007-05-05 19:29:21 UTC (rev 140)
+++ component/trunk/Packages/Delphi2007/dcldummzeuchchart.dpk	2007-05-05 20:31:13 UTC (rev 141)
@@ -0,0 +1,41 @@
+package dcldummzeuchchart;
+
+{$R *.res}
+{$ALIGN 8}
+{$ASSERTIONS OFF}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST ON}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'dummzeuch.de Charts - designtime package'}
+{$LIBSUFFIX '100'}
+{$DESIGNONLY}
+{$IMPLICITBUILD OFF}
+
+requires
+  rtl,
+  designide,
+  vcl,
+  vclsmp,
+  dummzeuchchart;
+
+contains
+  u_dzRegister in '..\..\source\u_dzRegister.pas',
+  w_dzPolynomEdit in '..\..\source\w_dzPolynomEdit.pas' {f_dzPolynomEdit};
+
+end.

Added: component/trunk/Packages/Delphi2007/dcldummzeuchchart.dproj
===================================================================
--- component/trunk/Packages/Delphi2007/dcldummzeuchchart.dproj	2007-05-05 19:29:21 UTC (rev 140)
+++ component/trunk/Packages/Delphi2007/dcldummzeuchchart.dproj	2007-05-05 20:31:13 UTC (rev 141)
@@ -0,0 +1,68 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{66496834-eb40-4262-b3e6-76f33c52b94e}</ProjectGuid>
+    <MainSource>dcldummzeuchchart.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dcldummzeuchchart100.bpl</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_AssertionsAtRuntime>False</DCC_AssertionsAtRuntime>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_WriteableConstants>True</DCC_WriteableConstants>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_MapFile>3</DCC_MapFile>
+    <DCC_DcuOutput>dcu</DCC_DcuOutput>
+    <DCC_ObjOutput>dcu</DCC_ObjOutput>
+    <DCC_HppOutput>dcu</DCC_HppOutput>
+    <DCC_UnitSearchPath>$(DELPHI)\Lib\Debug</DCC_UnitSearchPath>
+    <DCC_ResourcePath>$(DELPHI)\Lib\Debug</DCC_ResourcePath>
+    <DCC_ObjPath>$(DELPHI)\Lib\Debug</DCC_ObjPath>
+    <DCC_IncludePath>$(DELPHI)\Lib\Debug</DCC_IncludePath>
+    <DCC_Define>RELEASE</DCC_Define>
+    <DCC_SYMBOL_PLATFORM>False</DCC_SYMBOL_PLATFORM>
+    <DCC_UNIT_PLATFORM>False</DCC_UNIT_PLATFORM>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_AssertionsAtRuntime>False</DCC_AssertionsAtRuntime>
+    <DCC_WriteableConstants>True</DCC_WriteableConstants>
+    <DCC_MapFile>3</DCC_MapFile>
+    <DCC_DcuOutput>dcu</DCC_DcuOutput>
+    <DCC_ObjOutput>dcu</DCC_ObjOutput>
+    <DCC_HppOutput>dcu</DCC_HppOutput>
+    <DCC_UnitSearchPath>$(DELPHI)\Lib\Debug</DCC_UnitSearchPath>
+    <DCC_ResourcePath>$(DELPHI)\Lib\Debug</DCC_ResourcePath>
+    <DCC_ObjPath>$(DELPHI)\Lib\Debug</DCC_ObjPath>
+    <DCC_IncludePath>$(DELPHI)\Lib\Debug</DCC_IncludePath>
+    <DCC_SYMBOL_PLATFORM>False</DCC_SYMBOL_PLATFORM>
+    <DCC_UNIT_PLATFORM>False</DCC_UNIT_PLATFORM>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="HostApplication">C:\Program Files\Borland\BDS\3.0\Bin\bds.exe</Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="PackageDescription">dummzeuch.de Charts - designtime package</Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">True</VersionInfo><VersionInfo Name="MajorVer">2</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">42</VersionInfo><VersionInfo !
 Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1033</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName">dummzeuch.de</VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">2.0.0.42</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright">copyright 2003-2007 by Thomas Mueller</VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName">dummzeuch.de charts</VersionInfoKeys><VersionInfoKeys Name="ProductVersion">2.0</VersionInfoKeys><VersionInfoKeys Name="Comments">released under MPL 1.1</Vers!
 ionInfoKeys></VersionInfoKeys><Excluded_Packages>
+      
+      <Excluded_Packages Name="C:\Documents and Settings\Administrator\My Documents\Borland Studio Projects\Bpl\Unicode.bpl">(untitled)</Excluded_Packages>
+    </Excluded_Packages><Source><Source Name="MainSource">dcldummzeuchchart.dpk</Source></Source></Delphi.Personality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+  <ItemGroup>
+    <DelphiCompile Include="dcldummzeuchchart.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="..\..\source\u_dzRegister.pas" />
+    <DCCReference Include="..\..\source\w_dzPolynomEdit.pas">
+      <Form>f_dzPolynomEdit</Form>
+    </DCCReference>
+    <DCCReference Include="designide.dcp" />
+    <DCCReference Include="dummzeuchchart.dcp" />
+    <DCCReference Include="rtl.dcp" />
+    <DCCReference Include="vcl.dcp" />
+    <DCCReference Include="vclsmp.dcp" />
+  </ItemGroup>
+</Project>
\ No newline at end of file


Property changes on: component/trunk/Packages/Delphi2007/dcu
___________________________________________________________________
Name: svn:ignore
   + *.dcu


Added: component/trunk/Packages/Delphi2007/dummzeuchchart.dpk
===================================================================
--- component/trunk/Packages/Delphi2007/dummzeuchchart.dpk	2007-05-05 19:29:21 UTC (rev 140)
+++ component/trunk/Packages/Delphi2007/dummzeuchchart.dpk	2007-05-05 20:31:13 UTC (rev 141)
@@ -0,0 +1,46 @@
+package dummzeuchchart;
+
+{$R *.res}
+{$ALIGN 8}
+{$ASSERTIONS OFF}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST ON}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'dummzeuch.de Charts - runtime package'}
+{$LIBSUFFIX '100'}
+{$RUNONLY}
+{$IMPLICITBUILD OFF}
+
+requires
+  rtl,
+  vcl;
+
+contains
+  u_dzDataSeries in '..\..\source\u_dzDataSeries.pas',
+  u_dzCustomCharts in '..\..\source\u_dzCustomCharts.pas',
+  u_dzPieChart in '..\..\source\u_dzPieChart.pas',
+  u_dzXYChart in '..\..\source\u_dzXYChart.pas',
+  u_dzPolynomialDataseries in '..\..\source\u_dzPolynomialDataseries.pas',
+  u_dzCanvas in '..\..\source\u_dzCanvas.pas',
+  u_dzPointStyleCombo in '..\..\source\u_dzPointStyleCombo.pas',
+  u_dzLineStyleCombo in '..\..\source\u_dzLineStyleCombo.pas',
+  u_dzGraphics in '..\..\source\u_dzGraphics.pas',
+  u_dzSvgOutput in '..\..\source\u_dzSvgOutput.pas';
+
+end.

Added: component/trunk/Packages/Delphi2007/dummzeuchchart.dproj
===================================================================
--- component/trunk/Packages/Delphi2007/dummzeuchchart.dproj	2007-05-05 19:29:21 UTC (rev 140)
+++ component/trunk/Packages/Delphi2007/dummzeuchchart.dproj	2007-05-05 20:31:13 UTC (rev 141)
@@ -0,0 +1,73 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{fb3ba3f6-ec08-472e-9da3-33f5ed43a870}</ProjectGuid>
+    <MainSource>dummzeuchchart.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dummzeuchchart100.bpl</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_AssertionsAtRuntime>False</DCC_AssertionsAtRuntime>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_WriteableConstants>True</DCC_WriteableConstants>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_MapFile>3</DCC_MapFile>
+    <DCC_ExeOutput>
+    </DCC_ExeOutput>
+    <DCC_DcuOutput>dcu</DCC_DcuOutput>
+    <DCC_ObjOutput>dcu</DCC_ObjOutput>
+    <DCC_HppOutput>dcu</DCC_HppOutput>
+    <DCC_UnitSearchPath>$(DELPHI)\Lib\Debug</DCC_UnitSearchPath>
+    <DCC_ResourcePath>$(DELPHI)\Lib\Debug</DCC_ResourcePath>
+    <DCC_ObjPath>$(DELPHI)\Lib\Debug</DCC_ObjPath>
+    <DCC_IncludePath>$(DELPHI)\Lib\Debug</DCC_IncludePath>
+    <DCC_Define>RELEASE</DCC_Define>
+    <DCC_SYMBOL_PLATFORM>False</DCC_SYMBOL_PLATFORM>
+    <DCC_UNIT_PLATFORM>False</DCC_UNIT_PLATFORM>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_AssertionsAtRuntime>False</DCC_AssertionsAtRuntime>
+    <DCC_WriteableConstants>True</DCC_WriteableConstants>
+    <DCC_MapFile>3</DCC_MapFile>
+    <DCC_DcuOutput>dcu</DCC_DcuOutput>
+    <DCC_ObjOutput>dcu</DCC_ObjOutput>
+    <DCC_HppOutput>dcu</DCC_HppOutput>
+    <DCC_UnitSearchPath>$(DELPHI)\Lib\Debug</DCC_UnitSearchPath>
+    <DCC_ResourcePath>$(DELPHI)\Lib\Debug</DCC_ResourcePath>
+    <DCC_ObjPath>$(DELPHI)\Lib\Debug</DCC_ObjPath>
+    <DCC_IncludePath>$(DELPHI)\Lib\Debug</DCC_IncludePath>
+    <DCC_SYMBOL_PLATFORM>False</DCC_SYMBOL_PLATFORM>
+    <DCC_UNIT_PLATFORM>False</DCC_UNIT_PLATFORM>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="HostApplication">C:\Program Files\Borland\Delphi7\Bin\delphi32.exe</Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="PackageDescription">dummzeuch.de Charts - runtime package</Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">False</Package_Options><Package_Options Name="RuntimeOnly">True</Package_Options><Package_Options Name="LibSuffix">100</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">True</VersionInfo><VersionInfo Name="MajorVer">2</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">141</VersionInfo><VersionIn!
 fo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1031</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName">dummzeuch.de</VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">2.0.0.141</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright">copyright 2004 by Thomas Mueller</VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName">dummzeuch.de charts</VersionInfoKeys><VersionInfoKeys Name="ProductVersion">2.0</VersionInfoKeys><VersionInfoKeys Name="Comments">released under the MPL 1.1</V!
 ersionInfoKeys></VersionInfoKeys><Excluded_Packages>
+      
+      <Excluded_Packages Name="C:\Documents and Settings\Administrator\My Documents\Borland Studio Projects\Bpl\Unicode.bpl">(untitled)</Excluded_Packages>
+    </Excluded_Packages><Source><Source Name="MainSource">dummzeuchchart.dpk</Source></Source></Delphi.Personality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+  <ItemGroup>
+    <DelphiCompile Include="dummzeuchchart.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="..\..\source\u_dzCanvas.pas" />
+    <DCCReference Include="..\..\source\u_dzCustomCharts.pas" />
+    <DCCReference Include="..\..\source\u_dzDataSeries.pas" />
+    <DCCReference Include="..\..\source\u_dzGraphics.pas" />
+    <DCCReference Include="..\..\source\u_dzLineStyleCombo.pas" />
+    <DCCReference Include="..\..\source\u_dzPieChart.pas" />
+    <DCCReference Include="..\..\source\u_dzPointStyleCombo.pas" />
+    <DCCReference Include="..\..\source\u_dzPolynomialDataseries.pas" />
+    <DCCReference Include="..\..\source\u_dzSvgOutput.pas" />
+    <DCCReference Include="..\..\source\u_dzXYChart.pas" />
+    <DCCReference Include="rtl.dcp" />
+    <DCCReference Include="vcl.dcp" />
+  </ItemGroup>
+</Project>
\ No newline at end of file

Added: component/trunk/dzchart-d2007.groupproj
===================================================================
--- component/trunk/dzchart-d2007.groupproj	2007-05-05 19:29:21 UTC (rev 140)
+++ component/trunk/dzchart-d2007.groupproj	2007-05-05 20:31:13 UTC (rev 141)
@@ -0,0 +1,49 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{84384748-3c4f-4431-9a4e-01d4926ac87c}</ProjectGuid>
+  </PropertyGroup>
+  <ItemGroup />
+  <ItemGroup />
+  <ProjectExtensions>
+    <Borland.Personality>Default.Personality</Borland.Personality>
+    <Borland.ProjectType />
+    <BorlandProject>
+<BorlandProject xmlns=""><Default.Personality></Default.Personality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Target Name="dummzeuchchart">
+    <MSBuild Projects="Packages\Delphi2007\dummzeuchchart.dproj" Targets="" />
+  </Target>
+  <Target Name="dummzeuchchart:Clean">
+    <MSBuild Projects="Packages\Delphi2007\dummzeuchchart.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="dummzeuchchart:Make">
+    <MSBuild Projects="Packages\Delphi2007\dummzeuchchart.dproj" Targets="Make" />
+  </Target>
+  <Target Name="dcldummzeuchchart">
+    <MSBuild Projects="Packages\Delphi2007\dcldummzeuchchart.dproj" Targets="" />
+  </Target>
+  <Target Name="dcldummzeuchchart:Clean">
+    <MSBuild Projects="Packages\Delphi2007\dcldummzeuchchart.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="dcldummzeuchchart:Make">
+    <MSBuild Projects="Packages\Delphi2007\dcldummzeuchchart.dproj" Targets="Make" />
+  </Target>
+  <Target Name="ChartTest">
+    <MSBuild Projects="examples\test-d2007\ChartTest.dproj" Targets="" />
+  </Target>
+  <Target Name="ChartTest:Clean">
+    <MSBuild Projects="examples\test-d2007\ChartTest.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="ChartTest:Make">
+    <MSBuild Projects="examples\test-d2007\ChartTest.dproj" Targets="Make" />
+  </Target>
+  <Target Name="Build">
+    <CallTarget Targets="dummzeuchchart;dcldummzeuchchart;ChartTest" />
+  </Target>
+  <Target Name="Clean">
+    <CallTarget Targets="dummzeuchchart:Clean;dcldummzeuchchart:Clean;ChartTest:Clean" />
+  </Target>
+  <Target Name="Make">
+    <CallTarget Targets="dummzeuchchart:Make;dcldummzeuchchart:Make;ChartTest:Make" />
+  </Target>
+</Project>
\ No newline at end of file


Property changes on: component/trunk/examples/test-d2007
___________________________________________________________________
Name: svn:ignore
   + ChartTest.exe
ChartTest.res
w_ChartTest.dcu


Added: component/trunk/examples/test-d2007/ChartTest.dpr
===================================================================
--- component/trunk/examples/test-d2007/ChartTest.dpr	2007-05-05 19:29:21 UTC (rev 140)
+++ component/trunk/examples/test-d2007/ChartTest.dpr	2007-05-05 20:31:13 UTC (rev 141)
@@ -0,0 +1,13 @@
+program ChartTest;
+
+uses
+  Forms,
+  w_ChartTest in 'w_ChartTest.pas' {f_ChartTest};
+
+{$R *.res}
+
+begin
+  Application.Initialize;
+  Application.CreateForm(Tf_ChartTest, f_ChartTest);
+  Application.Run;
+end.

Added: component/trunk/examples/test-d2007/ChartTest.dproj
===================================================================
--- component/trunk/examples/test-d2007/ChartTest.dproj	2007-05-05 19:29:21 UTC (rev 140)
+++ component/trunk/examples/test-d2007/ChartTest.dproj	2007-05-05 20:31:13 UTC (rev 141)
@@ -0,0 +1,82 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{c6d9a281-063e-435c-af4a-9b564f6b110b}</ProjectGuid>
+    <MainSource>ChartTest.dpr</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_EnabledPackages>true</DCC_EnabledPackages>
+    <DCC_UsePackage>rtl;vclx;vcl;dummzeuchchart</DCC_UsePackage>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>ChartTest.exe</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_Define>DEBUG</DCC_Define>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>VCLApplication</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject xmlns=""> <Delphi.Personality>   <Parameters>
+      <Parameters Name="UseLauncher">False</Parameters>
+      <Parameters Name="LoadAllSymbols">True</Parameters>
+      <Parameters Name="LoadUnspecifiedSymbols">False</Parameters>
+    </Parameters>
+    <VersionInfo>
+      <VersionInfo Name="IncludeVerInfo">False</VersionInfo>
+      <VersionInfo Name="AutoIncBuild">False</VersionInfo>
+      <VersionInfo Name="MajorVer">1</VersionInfo>
+      <VersionInfo Name="MinorVer">0</VersionInfo>
+      <VersionInfo Name="Release">0</VersionInfo>
+      <VersionInfo Name="Build">0</VersionInfo>
+      <VersionInfo Name="Debug">False</VersionInfo>
+      <VersionInfo Name="PreRelease">False</VersionInfo>
+      <VersionInfo Name="Special">False</VersionInfo>
+      <VersionInfo Name="Private">False</VersionInfo>
+      <VersionInfo Name="DLL">False</VersionInfo>
+      <VersionInfo Name="Locale">1031</VersionInfo>
+      <VersionInfo Name="CodePage">1252</VersionInfo>
+    </VersionInfo>
+    <VersionInfoKeys>
+      <VersionInfoKeys Name="CompanyName"></VersionInfoKeys>
+      <VersionInfoKeys Name="FileDescription"></VersionInfoKeys>
+      <VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys>
+      <VersionInfoKeys Name="InternalName"></VersionInfoKeys>
+      <VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys>
+      <VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys>
+      <VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys>
+      <VersionInfoKeys Name="ProductName"></VersionInfoKeys>
+      <VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys>
+      <VersionInfoKeys Name="Comments"></VersionInfoKeys>
+    </VersionInfoKeys>
+    <Excluded_Packages>
+      
+      
+      
+      
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIndyProtocols100.bpl">Indy 10 Protocols Design Time</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\dclRBC1010.bpl">ReportBuilder TeeChart 4.04 Components</Excluded_Packages>
+    </Excluded_Packages>
+    <Source>
+      <Source Name="MainSource">ChartTest.dpr</Source>
+    </Source>
+  </Delphi.Personality> </BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <ItemGroup />
+  <ItemGroup>
+    <DelphiCompile Include="ChartTest.dpr">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="w_ChartTest.pas">
+      <Form>f_ChartTest</Form>
+    </DCCReference>
+  </ItemGroup>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+</Project>
\ No newline at end of file

Added: component/trunk/examples/test-d2007/w_ChartTest.dfm
===================================================================
--- component/trunk/examples/test-d2007/w_ChartTest.dfm	2007-05-05 19:29:21 UTC (rev 140)
+++ component/trunk/examples/test-d2007/w_ChartTest.dfm	2007-05-05 20:31:13 UTC (rev 141)
@@ -0,0 +1,253 @@
+object f_ChartTest: Tf_ChartTest
+  Left = 329
+  Top = 172
+  Caption = 'Chart Test'
+  ClientHeight = 572
+  ClientWidth = 589
+  Color = clBtnFace
+  Constraints.MinHeight = 50
+  Font.Charset = DEFAULT_CHARSET
+  Font.Color = clWindowText
+  Font.Height = 11
+  Font.Name = 'MS Sans Serif'
+  Font.Pitch = fpVariable
+  Font.Style = []
+  OldCreateOrder = True
+  OnCreate = FormCreate
+  PixelsPerInch = 96
+  TextHeight = 13
+  object XYChart: TdzXYChart
+    Left = 0
+    Top = 0
+    Width = 589
+    Height = 572
+    Cursor = crHandPoint
+    OnGetPointHint = XYChartGetPointHint
+    Align = alClient
+    Grid.GridType = gtBoth
+    Grid.Color = clBlack
+    Grid.LineStyle = psDot
+    ChartTitle.Title = 'hello world'
+    ChartTitle.TitleFont.Charset = DEFAULT_CHARSET
+    ChartTitle.TitleFont.Color = clRed
+    ChartTitle.TitleFont.Height = 15
+    ChartTitle.TitleFont.Name = 'arial'
+    ChartTitle.TitleFont.Pitch = fpVariable
+    ChartTitle.TitleFont.Style = [fsBold]
+    BottomAxis.Title = 'Zeit'
+    BottomAxis.TitleFont.Charset = DEFAULT_CHARSET
+    BottomAxis.TitleFont.Color = clWindowText
+    BottomAxis.TitleFont.Height = -13
+    BottomAxis.TitleFont.Name = 'Arial'
+    BottomAxis.TitleFont.Pitch = fpVariable
+    BottomAxis.TitleFont.Style = [fsBold]
+    BottomAxis.LabelFont.Charset = DEFAULT_CHARSET
+    BottomAxis.LabelFont.Color = clWindowText
+    BottomAxis.LabelFont.Height = -11
+    BottomAxis.LabelFont.Name = 'Arial'
+    BottomAxis.LabelFont.Pitch = fpVariable
+    BottomAxis.LabelFont.Style = []
+    BottomAxis.LabelOrientation = loHorizontal
+    BottomAxis.OnFormatLabel = XYChart1FormatXAxisLabel
+    BottomAxis.Scale.Automatic = True
+    BottomAxis.Scale.Min = -1.000000000000000000
+    BottomAxis.Scale.Max = 1.000000000000000000
+    BottomAxis.Scale.Divisions = 10.000000000000000000
+    BottomAxis.Scale.ScaleType = stLinear
+    LeftAxis.Title = 'Wert'
+    LeftAxis.TitleFont.Charset = DEFAULT_CHARSET
+    LeftAxis.TitleFont.Color = clWindowText
+    LeftAxis.TitleFont.Height = -13
+    LeftAxis.TitleFont.Name = 'Arial'
+    LeftAxis.TitleFont.Pitch = fpVariable
+    LeftAxis.TitleFont.Style = [fsBold]
+    LeftAxis.LabelFont.Charset = ANSI_CHARSET
+    LeftAxis.LabelFont.Color = clWindowText
+    LeftAxis.LabelFont.Height = -11
+    LeftAxis.LabelFont.Name = 'Arial'
+    LeftAxis.LabelFont.Pitch = fpVariable
+    LeftAxis.LabelFont.Style = []
+    LeftAxis.LabelOrientation = loHorizontal
+    LeftAxis.Scale.Automatic = True
+    LeftAxis.Scale.Min = -1.000000000000000000
+    LeftAxis.Scale.Max = 15.000000000000000000
+    LeftAxis.Scale.Divisions = 10.000000000000000000
+    LeftAxis.Scale.ScaleType = stLinear
+    Legend.LegendFont.Charset = DEFAULT_CHARSET
+    Legend.LegendFont.Color = clWindowText
+    Legend.LegendFont.Height = -11
+    Legend.LegendFont.Name = 'Arial'
+    Legend.LegendFont.Pitch = fpVariable
+    Legend.LegendFont.Style = []
+    Legend.Position = lpBottom
+    Legend.Frame.Color = clRed
+    Legend.Frame.Width = 1
+    Legend.Frame.Rounded = False
+    Legend.BackGround = clWhite
+    Legend.Title = 'Legend'
+    Legend.TitleFont.Charset = DEFAULT_CHARSET
+    Legend.TitleFont.Color = clWindowText
+    Legend.TitleFont.Height = -11
+    Legend.TitleFont.Name = 'Arial'
+    Legend.TitleFont.Pitch = fpVariable
+    Legend.TitleFont.Style = [fsBold]
+    Legend.Columns = 1
+    ChartFrame.Color = clBlack
+    ChartFrame.Width = 1
+    ChartFrame.Rounded = False
+  end
+  object Button1: TButton
+    Left = 112
+    Top = 192
+    Width = 75
+    Height = 25
+    Caption = '&Button'
+    TabOrder = 0
+    OnClick = Button1Click
+  end
+  object pd_squared2: TdzPolynomialDataseries
+    ChartType = ctXY
+    MinX = -1.000000000000000000
+    MaxX = 1.000000000000000000
+    PointCount = 11
+    LineColor = clMaroon
+    LineStyle = psSolid
+    ForceLineColor = False
+    PointColor = clRed
+    PointStyle = psRectangle
+    FillColor = clSilver
+    Caption = 'y = x'#178' + x + 10'
+    Chart = XYChart
+    Polynom.Order = 2
+    Polynom.Coefficients = (
+      10.000000000000000000
+      1.000000000000000000
+      1.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000)
+    Left = 264
+    Top = 312
+  end
+  object pd_Cubic: TdzPolynomialDataseries
+    ChartType = ctXY
+    MinX = -1.000000000000000000
+    MaxX = 1.000000000000000000
+    PointCount = 11
+    LineColor = clTeal
+    LineStyle = psClear
+    ForceLineColor = True
+    PointColor = clTeal
+    PointStyle = psUpArrow
+    FillColor = clTeal
+    Caption = 'y = 8x^7 + 7x^6 + 6x^5 + 5x^4 + 4x'#179' + 3x'#178' + 2x + 1'
+    Chart = XYChart
+    Polynom.Order = 3
+    Polynom.Coefficients = (
+      0.000000000000000000
+      0.000000000000000000
+      7.000000000000000000
+      8.000000000000000000
+      5.000000000000000000
+      6.000000000000000000
+      7.000000000000000000
+      8.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000)
+    Left = 120
+    Top = 88
+  end
+  object pd_Squared1: TdzPolynomialDataseries
+    ChartType = ctXY
+    MinX = -1.000000000000000000
+    MaxX = 1.000000000000000000
+    PointCount = 11
+    LineColor = clGreen
+    LineStyle = psSolid
+    ForceLineColor = True
+    PointColor = clGreen
+    PointStyle = psDiagCross
+    FillColor = clGreen
+    Caption = 'y = x'#178' + x'
+    Chart = XYChart
+    Polynom.Order = 2
+    Polynom.Coefficients = (
+      0.000000000000000000
+      1.000000000000000000
+      1.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000)
+    Left = 272
+    Top = 256
+  end
+  object pd_Squared4: TdzPolynomialDataseries
+    ChartType = ctXY
+    MinX = -1.000000000000000000
+    MaxX = 1.000000000000000000
+    PointCount = 11
+    LineColor = clFuchsia
+    LineStyle = psSolid
+    ForceLineColor = False
+    PointColor = clFuchsia
+    PointStyle = psCircle
+    FillColor = clFuchsia
+    Caption = 'y = 2x'#178' + 1'
+    Chart = XYChart
+    Polynom.Order = 2
+    Polynom.Coefficients = (
+      1.000000000000000000
+      0.000000000000000000
+      2.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000)
+    Left = 312
+    Top = 360
+  end
+  object pd_Sqared3: TdzPolynomialDataseries
+    ChartType = ctXY
+    MinX = -1.000000000000000000
+    MaxX = 1.000000000000000000
+    PointCount = 11
+    LineColor = clOlive
+    LineStyle = psSolid
+    ForceLineColor = False
+    PointColor = clOlive
+    PointStyle = psDiamond
+    FillColor = clOlive
+    Caption = 'y = x'#178
+    Chart = XYChart
+    Polynom.Order = 2
+    Polynom.Coefficients = (
+      0.000000000000000000
+      0.000000000000000000
+      1.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000
+      0.000000000000000000)
+    Left = 192
+    Top = 360
+  end
+end

Added: component/trunk/examples/test-d2007/w_ChartTest.pas
===================================================================
--- component/trunk/examples/test-d2007/w_ChartTest.pas	2007-05-05 19:29:21 UTC (rev 140)
+++ component/trunk/examples/test-d2007/w_ChartTest.pas	2007-05-05 20:31:13 UTC (rev 141)
@@ -0,0 +1,185 @@
+unit w_ChartTest;
+
+interface
+
+uses
+  Windows,
+  Messages,
+  SysUtils,
+  Variants,
+  Classes,
+  Graphics,
+  Controls,
+  Forms,
+  Dialogs,
+  StdCtrls,
+  u_dzDataSeries,
+  u_dzCustomCharts,
+  u_dzXYChart,
+  u_dzPolynomialDataseries;
+
+type
+  Tf_ChartTest = class(TForm)XYChart: TdzXYChart;
+    pd_squared2: TdzPolynomialDataseries;
+    pd_Cubic: TdzPolynomialDataseries;
+    pd_Squared1: TdzPolynomialDataseries;
+    pd_Squared4: TdzPolynomialDataseries;
+    pd_Sqared3: TdzPolynomialDataseries;
+    Button1: TButton;
+    procedure FormCreate(Sender: TObject);
+    procedure XYChart1GetNextXAxisLabel(_Sender: TObject; _Idx: integer; var _Value: Double; var _Stop: Boolean);
+    procedure XYChart1FormatXAxisLabel(_Sender: TObject; _Value: Double; var _Text: string);
+    procedure XYChartGetNextLimitArrow(_Sender: TObject; _Idx: Integer; var _X, _Y: Double; var _IsMinimum, _Stop: Boolean);
+    procedure XYChartGetPointHint(_Sender: TObject; const _x, _y: Double; var _Hint: string);
+    procedure Button1Click(Sender: TObject);
+  private
+  public
+  end;
+
+var
+  f_ChartTest: Tf_ChartTest;
+
+implementation
+
+{$R *.dfm}
+
+uses
+  Math,
+  u_dzGraphics,
+  u_dzSvgOutput;
+
+procedure Tf_ChartTest.FormCreate(Sender: TObject);
+label
+  lbl;
+var
+  x: integer;
+  y: integer;
+  SvSeries: TdzPointDataSeries;
+  MvSeries: TdzMultiValueDataSeries;
+begin
+  goto lbl; // Have you ever used goto in Delphi? This is how it is done. ;-)
+  SvSeries := tdzPointDataSeries.Create;
+  SvSeries.Caption := 'horz. line';
+  svSeries.LineColor := clRed;
+  svSeries.LineStyle := psSolid;
+  SvSeries.PointStyle := psCircle;
+  SvSeries.ChartType := ctAlternatingLine;
+  SvSeries.AddDataPoint(NegInfinity, 0);
+  SvSeries.AddDataPoint(0, 0);
+  SvSeries.AddDataPoint(0, 1);
+  SvSeries.AddDataPoint(Infinity, 1);
+  //  SvSeries.AddDataPoint(Infinity, 12);
+  XYChart.AddDataSeries(SvSeries);
+  exit;
+
+lbl:
+  MvSeries := TdzMultiValueDataSeries.Create;
+  for x := 0 to 3 do
+    begin
+      y := sqr(x * 10);
+      MvSeries.AddDataPoint(x * 60 * 60, [y / 2 - 1000, y / 2 - 800, y / 2, y / 2 + 300, y / 2 + 1000]);
+    end;
+  MvSeries.Caption := 'test';
+  MvSeries.ChartType := ctHighLowOpenClose;
+  MvSeries.LineColor := clRed;
+  MvSeries.FillColor := clWhite;
+  MvSeries.PointStyle := psNone;
+  MvSeries.PointColor := clRed;
+  XYChart.AddDataSeries(MvSeries);
+  exit;
+
+  SvSeries := TdzPointDataSeries.Create;
+  SvSeries.Caption := 'x Square';
+  SvSeries.LineColor := clBlack;
+  SvSeries.LineStyle := psDot;
+  SvSeries.PointColor := clYellow;
+  SvSeries.PointStyle := psRectangle;
+  SvSeries.ChartType := ctXY;
+  for x := 0 to 20 do
+    SvSeries.AddDataPoint(x * 60 * 60, sqr(x * 10));
+  XYChart.AddDataSeries(SvSeries);
+
+  SvSeries := TdzPointDataSeries.Create;
+  SvSeries.Caption := 'Linear';
+  SvSeries.LineColor := clRed;
+  SvSeries.PointColor := clBlue;
+  SvSeries.PointStyle := psTriangle;
+  SvSeries.ChartType := ctXY;
+  for x := 12 to 24 do
+    SvSeries.AddDataPoint(x * 60 * 60, x * 30);
+  XYChart.AddDataSeries(SvSeries);
+end;
+
+procedure Tf_ChartTest.XYChart1GetNextXAxisLabel(_Sender: TObject; _Idx: integer; var _Value: Double; var _Stop: Boolean);
+begin
+  if _Idx = 0 then
+    _Value := 0
+  else
+    _Value := _Value + 60 * 60;
+  _Stop := (_Value > 24 * 60 * 60);
+end;
+
+procedure Tf_ChartTest.XYChart1FormatXAxisLabel(_Sender: TObject; _Value: Double; var _Text: string);
+var
+  Sign: string;
+begin
+  if _Value < 0 then
+    begin
+      Sign := '-';
+      _Value := -_Value;
+    end
+  else
+    Sign := '';
+  _Text := Sign + Format('%.2d:%.2d:%.2d', [Round(_Value) div 3600, (Round(_Value) div 60) mod 60, Round(_Value) mod 60]);
+end;
+
+procedure Tf_ChartTest.XYChartGetNextLimitArrow(_Sender: TObject; _Idx: Integer; var _X, _Y: Double; var _IsMinimum, _Stop: Boolean);
+begin
+  if _Idx = 0 then
+    begin
+      _X := 3600;
+      _Y := 5000;
+      _IsMinimum := false;
+    end
+  else
+    _Stop := true;
+end;
+
+procedure Tf_ChartTest.XYChartGetPointHint(_Sender: TObject; const _x, _y: Double; var _Hint: string);
+begin
+  _Hint := 'some hint'#13#10 + _Hint;
+end;
+
+procedure Tf_ChartTest.Button1Click(Sender: TObject);
+var
+  wmf: TMetafile;
+var
+  svg: IdzSvgGraphics;
+begin
+  svg := TdzSvgGraphics.Create;
+  XYChart.PaintTo(svg);
+  svg.WriteToFile('c:\dzcharttext.svg');
+
+  exit;
+  if XYChart.BottomAxis.LabelOrientation = loVertical then
+    XYChart.BottomAxis.LabelOrientation := loHorizontal
+  else
+    XYChart.BottomAxis.LabelOrientation := loVertical;
+
+  //  XYChart.BottomAxis.LabelFont.Size := 20;
+  exit;
+  { TODO -otwm : this does not work yet }
+  wmf := TMetaFile.Create;
+  try
+    wmf.Width := XYChart.ClientWidth;
+    wmf.Height := XYChart.ClientHeight;
+    wmf.Enhanced := true;
+    XYChart.PaintTo(wmf.Handle, 0, 0);
+    wmf.SaveToFile('c:\screenshot.wmf');
+  finally
+    wmf.Free;
+  end;
+end;
+
+end.
+



From twm at mail.berlios.de  Sat May  5 22:35:49 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Sat, 5 May 2007 22:35:49 +0200
Subject: [Dzchart-svncheckins] r142 - utilities/dzCmdLineParser/trunk
Message-ID: <200705052035.l45KZn56011925@sheep.berlios.de>

Author: twm
Date: 2007-05-05 22:35:47 +0200 (Sat, 05 May 2007)
New Revision: 142

Added:
   utilities/dzCmdLineParser/trunk/CmdLineParserTest.dproj
Log:
added Delphi2007 support

Added: utilities/dzCmdLineParser/trunk/CmdLineParserTest.dproj
===================================================================
--- utilities/dzCmdLineParser/trunk/CmdLineParserTest.dproj	2007-05-05 20:31:13 UTC (rev 141)
+++ utilities/dzCmdLineParser/trunk/CmdLineParserTest.dproj	2007-05-05 20:35:47 UTC (rev 142)
@@ -0,0 +1,234 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{ff87c54f-7bb3-4fb0-8be9-da726c81d33c}</ProjectGuid>
+    <MainSource>CmdLineParserTest.dpr</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>CmdLineParserTest.exe</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_Optimize>False</DCC_Optimize>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_ImageBase>700000</DCC_ImageBase>
+    <DCC_UnitSearchPath>$(BDS)\Source\DUnit\src;D:\source\berlios.dztemplates\Units;D:\source\berlios.dztemplates\Templates</DCC_UnitSearchPath>
+    <DCC_ResourcePath>$(BDS)\Source\DUnit\src;D:\source\berlios.dztemplates\Units;D:\source\berlios.dztemplates\Templates</DCC_ResourcePath>
+    <DCC_ObjPath>$(BDS)\Source\DUnit\src;D:\source\berlios.dztemplates\Units;D:\source\berlios.dztemplates\Templates</DCC_ObjPath>
+    <DCC_IncludePath>$(BDS)\Source\DUnit\src;D:\source\berlios.dztemplates\Units;D:\source\berlios.dztemplates\Templates</DCC_IncludePath>
+    <DCC_Define>_CONSOLE_TESTRUNNER;RELEASE</DCC_Define>
+    <DCC_SYMBOL_PLATFORM>False</DCC_SYMBOL_PLATFORM>
+    <DCC_UNIT_PLATFORM>False</DCC_UNIT_PLATFORM>
+    <DCC_Description>RTS Highlighter Extensions</DCC_Description>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_Optimize>False</DCC_Optimize>
+    <DCC_ImageBase>700000</DCC_ImageBase>
+    <DCC_Define>_CONSOLE_TESTRUNNER;DEBUG</DCC_Define>
+    <DCC_SYMBOL_PLATFORM>False</DCC_SYMBOL_PLATFORM>
+    <DCC_UNIT_PLATFORM>False</DCC_UNIT_PLATFORM>
+    <DCC_Description>RTS Highlighter Extensions</DCC_Description>
+    <DCC_UnitSearchPath>..\dzTemplates\units;..\dztemplates\templates</DCC_UnitSearchPath>
+    <DCC_ResourcePath>..\dzTemplates\units;..\dztemplates\templates</DCC_ResourcePath>
+    <DCC_ObjPath>..\dzTemplates\units;..\dztemplates\templates</DCC_ObjPath>
+    <DCC_IncludePath>..\dzTemplates\units;..\dztemplates\templates</DCC_IncludePath>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType />
+    <BorlandProject>
+<BorlandProject xmlns=""> <Delphi.Personality>   <Parameters>
+      <Parameters Name="HostApplication">C:\Delphi7\Bin\delphi32.exe</Parameters>
+      <Parameters Name="UseLauncher">False</Parameters>
+      <Parameters Name="LoadAllSymbols">True</Parameters>
+      <Parameters Name="LoadUnspecifiedSymbols">False</Parameters>
+    </Parameters>
+    <Language>
+      <Language Name="RootDir">C:\Delphi7\Bin\</Language>
+    </Language>
+    <VersionInfo>
+      <VersionInfo Name="IncludeVerInfo">True</VersionInfo>
+      <VersionInfo Name="AutoIncBuild">False</VersionInfo>
+      <VersionInfo Name="MajorVer">1</VersionInfo>
+      <VersionInfo Name="MinorVer">0</VersionInfo>
+      <VersionInfo Name="Release">0</VersionInfo>
+      <VersionInfo Name="Build">0</VersionInfo>
+      <VersionInfo Name="Debug">False</VersionInfo>
+      <VersionInfo Name="PreRelease">False</VersionInfo>
+      <VersionInfo Name="Special">False</VersionInfo>
+      <VersionInfo Name="Private">False</VersionInfo>
+      <VersionInfo Name="DLL">True</VersionInfo>
+      <VersionInfo Name="Locale">4105</VersionInfo>
+      <VersionInfo Name="CodePage">1252</VersionInfo>
+    </VersionInfo>
+    <VersionInfoKeys>
+      <VersionInfoKeys Name="CompanyName"></VersionInfoKeys>
+      <VersionInfoKeys Name="FileDescription"></VersionInfoKeys>
+      <VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys>
+      <VersionInfoKeys Name="InternalName"></VersionInfoKeys>
+      <VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys>
+      <VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys>
+      <VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys>
+      <VersionInfoKeys Name="ProductName"></VersionInfoKeys>
+      <VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys>
+      <VersionInfoKeys Name="Comments"></VersionInfoKeys>
+    </VersionInfoKeys>
+    <Excluded_Packages>
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcldb100.bpl">Borland Database Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\bin\dclado100.bpl">Borland ADO DB Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcldbx100.bpl">Borland dbExpress Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclib100.bpl">Borland InterBase Express Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclnet100.bpl">Borland Internet Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclIndyCore100.bpl">Indy 10 Core Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIndyProtocols100.bpl">Indy 10 Protocols Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclmid100.bpl">Borland MyBase DataAccess Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclbde100.bpl">Borland BDE DB Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dbx100.bpl">Borland SQL Explorer UI Package</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\applet100.bpl">Borland Control Panel Applet Package</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclact100.bpl">Borland ActionBar Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclsoap100.bpl">Borland SOAP Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\bcbie100.bpl">Borland C++Builder Internet Explorer 5 Components Package</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcltee100.bpl">TeeChart Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcldbxcds100.bpl">Borland SimpleDataset Component (DBX)</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIntraweb_80_100.bpl">Intraweb 8.0 Design Package for Borland Development Studio 2006</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcloffice2k100.bpl">Microsoft Office 2000 Sample Automation Server Wrapper Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclie100.bpl">Internet Explorer Components</Excluded_Packages>
+    </Excluded_Packages>
+    <Source>
+      <Source Name="MainSource">CmdLineParserTest.dpr</Source>
+    </Source>
+  </Delphi.Personality> </BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+  <ItemGroup>
+    <DelphiCompile Include="CmdLineParserTest.dpr">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="u_dzCmdLineParser.pas" />
+    <DCCReference Include="u_dzCmdLineParser_UnitTest.pas" />
+    <DCCReference Include="u_dzGetOpt.pas" />
+    <DCCReference Include="u_dzGetOpt_UnitTest.pas" />
+    <DCCReference Include="u_dzOptionDescList.pas" />
+    <DCCReference Include="u_dzOptionFoundList.pas" />
+    <DCCReference Include="u_dzOptionNameList.pas" />
+    <DCCReference Include="u_dzParamDescList.pas" />
+    <DCCReference Include="u_dzParamFoundList.pas" />
+  </ItemGroup>
+</Project>
\ No newline at end of file



From twm at mail.berlios.de  Sat May  5 23:01:43 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Sat, 5 May 2007 23:01:43 +0200
Subject: [Dzchart-svncheckins] r143 - in
	utilities/dzBdsIdeScript/trunk/dws2: . Libraries
	Libraries/ClassesLib Libraries/delphi2007 Source bds4
	delphi2007 design
Message-ID: <200705052101.l45L1h1r014880@sheep.berlios.de>

Author: twm
Date: 2007-05-05 23:01:36 +0200 (Sat, 05 May 2007)
New Revision: 143

Added:
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2ClassesLibrary.dpk
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2ClassesLibrary.dproj
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2DbIsamLibrary.dpk
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2DbLibrary.dpk
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2IniLibrary.dpk
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2MFLibrary.dpk
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2SMTPLib.dpk
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2SymbolsLibrary.dpk
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2WebLib.dpk
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2hhIbo3Lib.dpk
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2hhIboLib.dpk
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007.groupproj
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007/
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dcldws2.dpk
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dcldws2.dproj
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2Runtime.dpk
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2Runtime.dproj
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2SynEditUtilsRuntime.dpk
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2SynEditUtilsRuntime.dproj
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2VCLRuntime.dpk
   utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2VCLRuntime.dproj
   utilities/dzBdsIdeScript/trunk/dws2/design/
   utilities/dzBdsIdeScript/trunk/dws2/design/dws2Register.pas
Removed:
   utilities/dzBdsIdeScript/trunk/dws2/bds4/dws2Register.pas
Modified:
   utilities/dzBdsIdeScript/trunk/dws2/Libraries/ClassesLib/
   utilities/dzBdsIdeScript/trunk/dws2/Source/
Log:
* moved dws2register to new subdirectory design
* started to add Delphi 2007 support


Property changes on: utilities/dzBdsIdeScript/trunk/dws2/Libraries/ClassesLib
___________________________________________________________________
Name: svn:ignore
   + *.dcu



Property changes on: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007
___________________________________________________________________
Name: svn:ignore
   + dws2ClassesLibrary.dcu
dws2ClassesLibrary.res


Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2ClassesLibrary.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2ClassesLibrary.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2ClassesLibrary.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,40 @@
+package dws2ClassesLibrary;
+
+{$R *.res}
+{$R '..\ClassesLib\dws2ClassesLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION OFF}
+{$OVERFLOWCHECKS ON}
+{$RANGECHECKS ON}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES ON}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS OFF}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - Lists and Hashtables Library'}
+{$LIBSUFFIX '100'}
+{$IMPLICITBUILD OFF}
+
+requires
+  dws2Runtime,
+  vcl,
+  rtl;
+
+contains
+  dws2ClassesLibModule in '..\ClassesLib\dws2ClassesLibModule.pas' {dws2ClassesLib: TDataModule},
+  dws2Hashtables in '..\ClassesLib\dws2Hashtables.pas',
+  dws2Classes in '..\ClassesLib\dws2Classes.pas';
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2ClassesLibrary.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2ClassesLibrary.dproj	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2ClassesLibrary.dproj	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,222 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{ab496b45-f336-4d36-b799-6f98af5de8e0}</ProjectGuid>
+    <MainSource>dws2ClassesLibrary.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dws2ClassesLibrary100.bpl</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_Optimize>False</DCC_Optimize>
+    <DCC_IntegerOverflowCheck>True</DCC_IntegerOverflowCheck>
+    <DCC_RangeChecking>True</DCC_RangeChecking>
+    <DCC_StrictVarStrings>False</DCC_StrictVarStrings>
+    <DCC_GenerateStackFrames>True</DCC_GenerateStackFrames>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_UnitSearchPath>..\..\source</DCC_UnitSearchPath>
+    <DCC_ResourcePath>..\..\source</DCC_ResourcePath>
+    <DCC_ObjPath>..\..\source</DCC_ObjPath>
+    <DCC_IncludePath>..\..\source</DCC_IncludePath>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_Optimize>False</DCC_Optimize>
+    <DCC_IntegerOverflowCheck>True</DCC_IntegerOverflowCheck>
+    <DCC_RangeChecking>True</DCC_RangeChecking>
+    <DCC_StrictVarStrings>False</DCC_StrictVarStrings>
+    <DCC_GenerateStackFrames>True</DCC_GenerateStackFrames>
+    <DCC_UnitSearchPath>..\..\source</DCC_UnitSearchPath>
+    <DCC_ResourcePath>..\..\source</DCC_ResourcePath>
+    <DCC_ObjPath>..\..\source</DCC_ObjPath>
+    <DCC_IncludePath>..\..\source</DCC_IncludePath>
+    <DCC_Define>DEBUG</DCC_Define>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject xmlns=""> <Delphi.Personality>   <Parameters>
+      <Parameters Name="UseLauncher">False</Parameters>
+      <Parameters Name="LoadAllSymbols">True</Parameters>
+      <Parameters Name="LoadUnspecifiedSymbols">False</Parameters>
+    </Parameters>
+    <Package_Options>
+      <Package_Options Name="PackageDescription">DelphiWebScript II - Lists and Hashtables Library</Package_Options>
+      <Package_Options Name="ImplicitBuild">False</Package_Options>
+      <Package_Options Name="DesigntimeOnly">False</Package_Options>
+      <Package_Options Name="RuntimeOnly">False</Package_Options>
+      <Package_Options Name="LibSuffix">100</Package_Options>
+    </Package_Options>
+    <VersionInfo>
+      <VersionInfo Name="IncludeVerInfo">True</VersionInfo>
+      <VersionInfo Name="AutoIncBuild">False</VersionInfo>
+      <VersionInfo Name="MajorVer">1</VersionInfo>
+      <VersionInfo Name="MinorVer">0</VersionInfo>
+      <VersionInfo Name="Release">0</VersionInfo>
+      <VersionInfo Name="Build">0</VersionInfo>
+      <VersionInfo Name="Debug">False</VersionInfo>
+      <VersionInfo Name="PreRelease">False</VersionInfo>
+      <VersionInfo Name="Special">False</VersionInfo>
+      <VersionInfo Name="Private">False</VersionInfo>
+      <VersionInfo Name="DLL">False</VersionInfo>
+      <VersionInfo Name="Locale">2055</VersionInfo>
+      <VersionInfo Name="CodePage">1252</VersionInfo>
+    </VersionInfo>
+    <VersionInfoKeys>
+      <VersionInfoKeys Name="CompanyName"></VersionInfoKeys>
+      <VersionInfoKeys Name="FileDescription"></VersionInfoKeys>
+      <VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys>
+      <VersionInfoKeys Name="InternalName"></VersionInfoKeys>
+      <VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys>
+      <VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys>
+      <VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys>
+      <VersionInfoKeys Name="ProductName"></VersionInfoKeys>
+      <VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys>
+      <VersionInfoKeys Name="Comments"></VersionInfoKeys>
+    </VersionInfoKeys>
+    <Excluded_Packages>
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclbde100.bpl">Borland BDE DB Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclib100.bpl">Borland InterBase Express Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclofficexp100.bpl">Microsoft Office XP Sample Automation Server Wrapper Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclIndyCore100.bpl">Indy 10 Core Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclsoap100.bpl">Borland SOAP Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\applet100.bpl">Borland Control Panel Applet Package</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcltee100.bpl">TeeChart Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIndyProtocols100.bpl">Indy 10 Protocols Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIntraweb_80_100.bpl">Intraweb 8.0 Design Package for Borland Development Studio 2006</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\CivEvoButtons.bpl">(untitled)</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclie100.bpl">Internet Explorer Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvAppFrmD10D.bpl">JVCL Application and Form Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBandsD10D.bpl">JVCL Band Objects</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBDED10D.bpl">JVCL BDE Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCmpD10D.bpl">JVCL Non-Visual Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCryptD10D.bpl">JVCL Encryption and Compression</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCtrlsD10D.bpl">JVCL Visual Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCustomD10D.bpl">JVCL Custom Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDBD10D.bpl">JVCL Database Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDlgsD10D.bpl">JVCL Dialog Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDockingD10D.bpl">JVCL Docking Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDotNetCtrlsD10D.bpl">JVCL DotNet Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvEDID10D.bpl">JVCL EDI Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvGlobusD10D.bpl">JVCL Globus Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvHMID10D.bpl">JVCL HMI Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvInterpreterD10D.bpl">JVCL Interpreter Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvJansD10D.bpl">JVCL Jans Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvManagedThreadsD10D.bpl">JVCL Managed Threads</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvMMD10D.bpl">JVCL Multimedia and Image Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvNetD10D.bpl">JVCL Network Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPageCompsD10D.bpl">JVCL Page Style Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPluginD10D.bpl">JVCL Plugin Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPrintPreviewD10D.bpl">JVCL Print Preview Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvRuntimeDesignD10D.bpl">JVCL Runtime Design Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvTimeFrameworkD10D.bpl">JVCL Time Framework</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvUIBD10D.bpl">JVCL Unified Interbase Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvValidatorsD10D.bpl">JVCL Validators and Error Provider Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvWizardD10D.bpl">JVCL Wizard</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvXPCtrlsD10D.bpl">JVCL XP Controls</Excluded_Packages>
+    </Excluded_Packages>
+    <Source>
+      <Source Name="MainSource">dws2ClassesLibrary.dpk</Source>
+    </Source>
+  </Delphi.Personality> </BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <ItemGroup />
+  <ItemGroup>
+    <DelphiCompile Include="dws2ClassesLibrary.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="..\ClassesLib\dws2Classes.pas" />
+    <DCCReference Include="..\ClassesLib\dws2ClassesLib.dcr" />
+    <DCCReference Include="..\ClassesLib\dws2ClassesLibModule.pas">
+      <Form>dws2ClassesLib</Form>
+    </DCCReference>
+    <DCCReference Include="..\ClassesLib\dws2Hashtables.pas" />
+    <DCCReference Include="dws2Runtime.dcp" />
+    <DCCReference Include="rtl.dcp" />
+    <DCCReference Include="vcl.dcp" />
+  </ItemGroup>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+</Project>
\ No newline at end of file

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2DbIsamLibrary.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2DbIsamLibrary.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2DbIsamLibrary.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,41 @@
+package dws2DbIsamLibrary;
+
+{$R *.res}
+{$R '..\DbIsamLib\dws2DbIsamLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION OFF}
+{$OVERFLOWCHECKS ON}
+{$RANGECHECKS ON}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES ON}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS OFF}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - DbISAM Support'}
+{$LIBSUFFIX '70'}
+{$IMPLICITBUILD OFF}
+
+requires
+  dws2Runtime,
+  vcl,
+  dbrtl,
+  bdertl,
+  vcldb,
+  db319d7r;
+
+contains
+  dws2DbIsamLibModule in '..\DbIsamLib\dws2DbIsamLibModule.pas' {dws2DbIsamLib: TDataModule};
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2DbLibrary.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2DbLibrary.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2DbLibrary.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,39 @@
+package dws2DbLibrary;
+
+{$R *.res}
+{$R '..\DbLib\dws2DbLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION OFF}
+{$OVERFLOWCHECKS ON}
+{$RANGECHECKS ON}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES ON}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS OFF}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - Simple Database Library'}
+{$LIBSUFFIX '70'}
+{$IMPLICITBUILD OFF}
+
+requires
+  dws2Runtime,
+  vcl,
+  dbrtl,
+  bdertl;
+
+contains
+  dws2DbLibModule in '..\DbLib\dws2DbLibModule.pas' {dws2DbLib: TDataModule};
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2IniLibrary.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2IniLibrary.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2IniLibrary.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,37 @@
+package dws2IniLibrary;
+
+{$R *.res}
+{$R '..\IniLib\dws2IniLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION OFF}
+{$OVERFLOWCHECKS ON}
+{$RANGECHECKS ON}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES ON}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS OFF}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - Ini-File Library'}
+{$LIBSUFFIX '70'}
+{$IMPLICITBUILD OFF}
+
+requires
+  dws2Runtime,
+  vcl;
+
+contains
+  dws2IniModule in '..\IniLib\dws2IniModule.pas' {dws2Ini: TDataModule};
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2MFLibrary.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2MFLibrary.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2MFLibrary.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,45 @@
+package dws2MFLibrary;
+
+{$R *.res}
+{$R '..\MFLib\dws2MFLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - MFLib'}
+{$LIBSUFFIX '70'}
+{$IMPLICITBUILD OFF}
+
+requires
+  rtl,
+  vcl,
+  dws2Runtime;
+
+contains
+  RegExpr in '..\MFLib\RegExpr.pas',
+  ProcessViewer in '..\MFLib\ProcessViewer.pas',
+  dws2MFLoader in '..\MFLib\dws2MFLoader.pas',
+  dws2MFLibFuncs in '..\MFLib\dws2MFLibFuncs.pas',
+  dws2MFLibUtils in '..\MFLib\dws2MFLibUtils.pas',
+  dws2MFLibModule in '..\MFLib\dws2MFLibModule.pas' {dws2MFLib: TDataModule},
+  ZipUnzip in '..\MFLib\ZipUnzip.pas',
+  dws2MFZipLibModule in '..\MFLib\dws2MFZipLibModule.pas' {dws2MFZipLib: TDataModule};
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2SMTPLib.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2SMTPLib.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2SMTPLib.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,37 @@
+package dws2SMTPLib;
+
+{$R *.res}
+{$R '..\SmtpLib\dws2SMTPLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION OFF}
+{$OVERFLOWCHECKS ON}
+{$RANGECHECKS ON}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES ON}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS OFF}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - SMTP Library'}
+{$LIBSUFFIX '70'}
+{$IMPLICITBUILD OFF}
+
+requires
+  dws2Runtime,
+  NMFAST;
+
+contains
+  dws2SMTPmodule in '..\SmtpLib\dws2SMTPmodule.pas' {dws2SMTPlib: TDataModule};
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2SymbolsLibrary.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2SymbolsLibrary.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2SymbolsLibrary.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,37 @@
+package dws2SymbolsLibrary;
+
+{$R *.res}
+{$R '..\SymbolsLib\dws2SymbolsLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION OFF}
+{$OVERFLOWCHECKS ON}
+{$RANGECHECKS ON}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES ON}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS OFF}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - Symboltable Access '}
+{$LIBSUFFIX '70'}
+{$IMPLICITBUILD OFF}
+
+requires
+  dws2Runtime,
+  vcl;
+
+contains
+  dws2SymbolsLibModule in '..\SymbolsLib\dws2SymbolsLibModule.pas' {dws2SymbolsLib: TDataModule};
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2WebLib.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2WebLib.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2WebLib.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,45 @@
+package dws2WebLib;
+
+{$R *.res}
+{$R '..\WebLib\dws2WebLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION OFF}
+{$OVERFLOWCHECKS ON}
+{$RANGECHECKS ON}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES ON}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS OFF}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - Web Library'}
+{$LIBSUFFIX '70'}
+{$IMPLICITBUILD OFF}
+
+requires
+  inet,
+  dws2Runtime,
+  indy;
+
+contains
+  dws2WebLibModule in '..\WebLib\dws2WebLibModule.pas' {dws2WebLib: TDataModule},
+  dws2WebBasics in '..\WebLib\dws2WebBasics.pas',
+  dws2SessionLibModule in '..\WebLib\dws2SessionLibModule.pas' {dws2SessionLib: TDataModule},
+  MatlusMultipartParser in '..\WebLib\MatlusMultipartParser.pas',
+  dws2SessionGlobals in '..\WebLib\dws2SessionGlobals.pas',
+  dws2PageProducer in '..\WebLib\dws2PageProducer.pas',
+  dws2PageloaderModule in '..\WebLib\dws2PageloaderModule.pas' {dws2Pageloader: TDataModule},
+  dws2SessionBasics in '..\WebLib\dws2SessionBasics.pas';
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2hhIbo3Lib.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2hhIbo3Lib.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2hhIbo3Lib.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,38 @@
+package dws2hhIbo3Lib;
+
+{$R *.res}
+{$R '..\IboLib\dws2IboLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST ON}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - IBO Library (hh)'}
+{$LIBSUFFIX '60'}
+{$IMPLICITBUILD OFF}
+
+requires
+  dws2Runtime,
+  IBO_D6;
+
+contains
+  dws2IboModule in '..\IboLib\dws2IboModule.pas' {dws2IboLib: TDataModule},
+  dws2IboDataSrc in '..\IboLib\dws2IboDataSrc.pas';
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2hhIboLib.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2hhIboLib.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/Libraries/delphi2007/dws2hhIboLib.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,38 @@
+package dws2hhIboLib;
+
+{$R *.res}
+{$R '..\IboLib\dws2IboLib.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST ON}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - IBO Library (hh)'}
+{$LIBSUFFIX '60'}
+{$IMPLICITBUILD OFF}
+
+requires
+  dws2Runtime,
+  IBO40ADT;
+
+contains
+  dws2IboModule in '..\IboLib\dws2IboModule.pas' {dws2IboLib: TDataModule},
+  dws2IboDataSrc in '..\IboLib\dws2IboDataSrc.pas';
+
+end.


Property changes on: utilities/dzBdsIdeScript/trunk/dws2/Source
___________________________________________________________________
Name: svn:ignore
   + *.dcu


Deleted: utilities/dzBdsIdeScript/trunk/dws2/bds4/dws2Register.pas
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/bds4/dws2Register.pas	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/bds4/dws2Register.pas	2007-05-05 21:01:36 UTC (rev 143)
@@ -1,69 +0,0 @@
-{**********************************************************************}
-{                                                                      }
-{    "The contents of this file are subject to the Mozilla Public      }
-{    License Version 1.1 (the "License"); you may not use this         }
-{    file except in compliance with the License. You may obtain        }
-{    a copy of the License at                                          }
-{                                                                      }
-{    http://www.mozilla.org/MPL/                                       }
-{                                                                      }
-{    Software distributed under the License is distributed on an       }
-{    "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, either express       }
-{    or implied. See the License for the specific language             }
-{    governing rights and limitations under the License.               }
-{                                                                      }
-{    The Original Code is DelphiWebScriptII source code, released      }
-{    January 1, 2001                                                   }
-{                                                                      }
-{    The Initial Developer of the Original Code is Matthias            }
-{    Ackermann. Portions created by Matthias Ackermann are             }
-{    Copyright (C) 2000 Matthias Ackermann, Switzerland. All           }
-{    Rights Reserved.                                                  }
-{                                                                      }
-{    Contributor(s): Willibald Krenn                                   }
-{                                                                      }
-{**********************************************************************}
-
-{$I ..\source\dws2.inc}
-
-// Design-Time only, do NOT include this unit in runtime packages.
-//
-unit dws2Register;
-
-interface
-
-procedure Register;
-
-implementation
-
-uses
-  Classes, Controls, dws2Comp,
-  dws2HtmlFilter, dws2ComConnector, dws2Debugger,
-  dws2FileFunctions,
-  dws2VCLGUIFunctions, dws2GlobalVarsFunctions,
-  dws2StringResult;
-
-procedure Register;
-begin
-  GroupDescendentsWith(dws2VCLGUIFunctions.Tdws2GUIFunctions,
-    Controls.TControl);
-  GroupDescendentsWith(Tdws2ComConnector,
-    Controls.TControl);
-//  GroupDescendentsWith(dws2CLXGUIFunctions.Tdws2GUIFunctions,
-//    QControls.TControl);
-
-  RegisterClass(dws2VCLGUIFunctions.Tdws2GUIFunctions);
-  RegisterClass(Tdws2ComConnector);
-//  RegisterClass(dws2CLXGUIFunctions.Tdws2GUIFunctions);
-
-  RegisterComponents('DWS2', [TDelphiWebScriptII,
-    Tdws2ComConnector, Tdws2HtmlFilter,  Tdws2SimpleDebugger,
-      Tdws2FileFunctions,
-      dws2VCLGUIFunctions.Tdws2GUIFunctions,
-//      dws2CLXGUIFunctions.Tdws2GUIFunctions,
-      Tdws2GlobalVarsFunctions, Tdws2StringResultType, Tdws2Unit, Tdws2HTMLUnit, 
-      Tdws2StringsUnit]);
-end;
-
-end.
-


Property changes on: utilities/dzBdsIdeScript/trunk/dws2/delphi2007
___________________________________________________________________
Name: svn:ignore
   + dcldws2.dcu
dws2SynEditUtilsRuntime.res
dws2VCLRuntime.dcu
dws2VCLRuntime.res
dcldws2.res
dws2Runtime.dcu
dws2Runtime.res


Added: utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dcldws2.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dcldws2.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dcldws2.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,40 @@
+package dcldws2;
+
+{$R *.res}
+{$R '..\source\dws2.dcr'}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II - Designtime Package'}
+{$LIBSUFFIX '100'}
+{$LIBVERSION '20'}
+{$DESIGNONLY}
+{$IMPLICITBUILD OFF}
+
+requires
+  dws2VCLRuntime,
+  designide;
+
+contains
+  dws2Register in '..\design\dws2Register.pas',
+  dws2Experts in '..\source\dws2Experts.pas';
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dcldws2.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dcldws2.dproj	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dcldws2.dproj	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,87 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{fefb6414-97ce-45eb-b761-2d8ed8ba3d54}</ProjectGuid>
+    <MainSource>dcldws2.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dcldws2100.bpl.20</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="PackageDescription">DelphiWebScript II - Designtime Package</Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">20</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">2</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">1</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><Versi!
 onInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1033</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName">DelphiWebScript OpenSource Project</VersionInfoKeys><VersionInfoKeys Name="FileDescription">DWSII components</VersionInfoKeys><VersionInfoKeys Name="FileVersion">2.0.0.1</VersionInfoKeys><VersionInfoKeys Name="InternalName">dcldws2.dpk</VersionInfoKeys><VersionInfoKeys Name="LegalCopyright">see http://www.dwscript.com for list</VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename">dcldws2.bpl</VersionInfoKeys><VersionInfoKeys Name="ProductName">DelphiWebScript II</VersionInfoKeys><VersionInfoKeys Name="ProductVersion">2.0</VersionInfoKeys><VersionInfoKeys Name="Comments">http://ww!
 w.dwscript.com</VersionInfoKeys></VersionInfoKeys><Excluded_Pa!
 ckages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclbde100.bpl">Borland BDE DB Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclib100.bpl">Borland InterBase Express Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclofficexp100.bpl">Microsoft Office XP Sample Automation Server Wrapper Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclIndyCore100.bpl">Indy 10 Core Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclsoap100.bpl">Borland SOAP Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\applet100.bpl">Borland Control Panel Applet Package</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcltee100.bpl">TeeChart Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIndyProtocols100.bpl">Indy 10 Protocols Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIntraweb_80_100.bpl">Intraweb 8.0 Design Package for Borland Development Studio 2006</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\CivEvoButtons.bpl">(untitled)</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclie100.bpl">Internet Explorer Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvAppFrmD10D.bpl">JVCL Application and Form Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBandsD10D.bpl">JVCL Band Objects</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBDED10D.bpl">JVCL BDE Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCmpD10D.bpl">JVCL Non-Visual Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCryptD10D.bpl">JVCL Encryption and Compression</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCtrlsD10D.bpl">JVCL Visual Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCustomD10D.bpl">JVCL Custom Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDBD10D.bpl">JVCL Database Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDlgsD10D.bpl">JVCL Dialog Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDockingD10D.bpl">JVCL Docking Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDotNetCtrlsD10D.bpl">JVCL DotNet Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvEDID10D.bpl">JVCL EDI Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvGlobusD10D.bpl">JVCL Globus Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvHMID10D.bpl">JVCL HMI Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvInterpreterD10D.bpl">JVCL Interpreter Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvJansD10D.bpl">JVCL Jans Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvManagedThreadsD10D.bpl">JVCL Managed Threads</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvMMD10D.bpl">JVCL Multimedia and Image Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvNetD10D.bpl">JVCL Network Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPageCompsD10D.bpl">JVCL Page Style Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPluginD10D.bpl">JVCL Plugin Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPrintPreviewD10D.bpl">JVCL Print Preview Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvRuntimeDesignD10D.bpl">JVCL Runtime Design Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvTimeFrameworkD10D.bpl">JVCL Time Framework</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvUIBD10D.bpl">JVCL Unified Interbase Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvValidatorsD10D.bpl">JVCL Validators and Error Provider Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvWizardD10D.bpl">JVCL Wizard</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvXPCtrlsD10D.bpl">JVCL XP Controls</Excluded_Packages>
+    </Excluded_Packages><Source><Source Name="MainSource">dcldws2.dpk</Source></Source></Delphi.Personality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+  <ItemGroup>
+    <DelphiCompile Include="dcldws2.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="..\Delphi7\dws2Register.pas" />
+    <DCCReference Include="..\design\dws2Register.pas" />
+    <DCCReference Include="..\desig\dws2Register.pas" />
+    <DCCReference Include="..\desi\dws2Register.pas" />
+    <DCCReference Include="..\desugb\dws2Register.pas" />
+    <DCCReference Include="..\desug\dws2Register.pas" />
+    <DCCReference Include="..\desu\dws2Register.pas" />
+    <DCCReference Include="..\des\dws2Register.pas" />
+    <DCCReference Include="..\de\dws2Register.pas" />
+    <DCCReference Include="..\d\dws2Register.pas" />
+    <DCCReference Include="..\source\dws2.dcr" />
+    <DCCReference Include="..\source\dws2.dcr" />
+    <DCCReference Include="..\source\dws2Experts.pas" />
+    <DCCReference Include="C:\Documents and Settings\developer\designide.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dws2VCLRuntime.dcp" />
+  </ItemGroup>
+</Project>
\ No newline at end of file

Added: utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2Runtime.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2Runtime.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2Runtime.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,57 @@
+package dws2Runtime;
+
+{$R *.res}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION OFF}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES ON}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS OFF}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II'}
+{$LIBSUFFIX '100'}
+{$LIBVERSION '20'}
+{$RUNONLY}
+{$IMPLICITBUILD OFF}
+
+requires
+  rtl;
+
+contains
+  dws2Errors in '..\source\dws2Errors.pas',
+  dws2Strings in '..\source\dws2Strings.pas',
+  dws2Tokenizer in '..\source\dws2Tokenizer.pas',
+  dws2Functions in '..\source\dws2Functions.pas',
+  dws2Symbols in '..\source\dws2Symbols.pas',
+  dws2Exprs in '..\source\dws2Exprs.pas',
+  dws2Comp in '..\source\dws2Comp.pas',
+  dws2Compiler in '..\source\dws2Compiler.pas',
+  dws2Debugger in '..\source\dws2Debugger.pas',
+  dws2Stack in '..\source\dws2Stack.pas',
+  dws2MathFunctions in '..\source\dws2MathFunctions.pas',
+  dws2TimeFunctions in '..\source\dws2TimeFunctions.pas',
+  dws2FileFunctions in '..\source\dws2FileFunctions.pas',
+  dws2CompStrings in '..\source\dws2CompStrings.pas',
+  dws2HtmlFilter in '..\source\dws2HtmlFilter.pas',
+  dws2GlobalVarsFunctions in '..\source\dws2GlobalVarsFunctions.pas',
+  dws2StringResult in '..\Source\dws2StringResult.pas',
+  dws2StringFunctions in '..\Source\dws2StringFunctions.pas',
+  dws2VariantFunctions in '..\Source\dws2VariantFunctions.pas',
+  dws2IDEUtils in '..\Source\dws2IDEUtils.pas',
+  dws2UnitUtils in '..\Source\dws2UnitUtils.pas';
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2Runtime.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2Runtime.dproj	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2Runtime.dproj	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,263 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{0ed76341-caae-4037-aa69-3ae5698bdd64}</ProjectGuid>
+    <MainSource>dws2Runtime.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dws2Runtime100.bpl.20</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_Optimize>False</DCC_Optimize>
+    <DCC_StrictVarStrings>False</DCC_StrictVarStrings>
+    <DCC_GenerateStackFrames>True</DCC_GenerateStackFrames>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_Optimize>False</DCC_Optimize>
+    <DCC_StrictVarStrings>False</DCC_StrictVarStrings>
+    <DCC_GenerateStackFrames>True</DCC_GenerateStackFrames>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject xmlns=""> <Delphi.Personality>   <Parameters>
+      <Parameters Name="UseLauncher">False</Parameters>
+      <Parameters Name="LoadAllSymbols">True</Parameters>
+      <Parameters Name="LoadUnspecifiedSymbols">False</Parameters>
+    </Parameters>
+    <Package_Options>
+      <Package_Options Name="PackageDescription">DelphiWebScript II</Package_Options>
+      <Package_Options Name="ImplicitBuild">False</Package_Options>
+      <Package_Options Name="DesigntimeOnly">False</Package_Options>
+      <Package_Options Name="RuntimeOnly">True</Package_Options>
+      <Package_Options Name="LibSuffix">100</Package_Options>
+      <Package_Options Name="LibVersion">20</Package_Options>
+    </Package_Options>
+    <VersionInfo>
+      <VersionInfo Name="IncludeVerInfo">True</VersionInfo>
+      <VersionInfo Name="AutoIncBuild">False</VersionInfo>
+      <VersionInfo Name="MajorVer">2</VersionInfo>
+      <VersionInfo Name="MinorVer">0</VersionInfo>
+      <VersionInfo Name="Release">0</VersionInfo>
+      <VersionInfo Name="Build">1</VersionInfo>
+      <VersionInfo Name="Debug">False</VersionInfo>
+      <VersionInfo Name="PreRelease">False</VersionInfo>
+      <VersionInfo Name="Special">False</VersionInfo>
+      <VersionInfo Name="Private">False</VersionInfo>
+      <VersionInfo Name="DLL">False</VersionInfo>
+      <VersionInfo Name="Locale">1033</VersionInfo>
+      <VersionInfo Name="CodePage">1252</VersionInfo>
+    </VersionInfo>
+    <VersionInfoKeys>
+      <VersionInfoKeys Name="CompanyName">DelphiWebScript OpenSource Project</VersionInfoKeys>
+      <VersionInfoKeys Name="FileDescription">DWSII runtime interpreter core</VersionInfoKeys>
+      <VersionInfoKeys Name="FileVersion">2.0.0.1</VersionInfoKeys>
+      <VersionInfoKeys Name="InternalName">dws2Runtime.dpk</VersionInfoKeys>
+      <VersionInfoKeys Name="LegalCopyright">see http://www.dwscript.com for list</VersionInfoKeys>
+      <VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys>
+      <VersionInfoKeys Name="OriginalFilename">dws2Runtime.bpl</VersionInfoKeys>
+      <VersionInfoKeys Name="ProductName">DelphiWebScriptII</VersionInfoKeys>
+      <VersionInfoKeys Name="ProductVersion">2.0</VersionInfoKeys>
+      <VersionInfoKeys Name="Comments">see http://www.dwscript.com</VersionInfoKeys>
+    </VersionInfoKeys>
+    <Excluded_Packages>
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclbde100.bpl">Borland BDE DB Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclib100.bpl">Borland InterBase Express Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclofficexp100.bpl">Microsoft Office XP Sample Automation Server Wrapper Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclIndyCore100.bpl">Indy 10 Core Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclsoap100.bpl">Borland SOAP Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\applet100.bpl">Borland Control Panel Applet Package</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcltee100.bpl">TeeChart Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIndyProtocols100.bpl">Indy 10 Protocols Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIntraweb_80_100.bpl">Intraweb 8.0 Design Package for Borland Development Studio 2006</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\CivEvoButtons.bpl">(untitled)</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclie100.bpl">Internet Explorer Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvAppFrmD10D.bpl">JVCL Application and Form Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBandsD10D.bpl">JVCL Band Objects</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBDED10D.bpl">JVCL BDE Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCmpD10D.bpl">JVCL Non-Visual Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCryptD10D.bpl">JVCL Encryption and Compression</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCtrlsD10D.bpl">JVCL Visual Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCustomD10D.bpl">JVCL Custom Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDBD10D.bpl">JVCL Database Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDlgsD10D.bpl">JVCL Dialog Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDockingD10D.bpl">JVCL Docking Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDotNetCtrlsD10D.bpl">JVCL DotNet Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvEDID10D.bpl">JVCL EDI Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvGlobusD10D.bpl">JVCL Globus Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvHMID10D.bpl">JVCL HMI Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvInterpreterD10D.bpl">JVCL Interpreter Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvJansD10D.bpl">JVCL Jans Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvManagedThreadsD10D.bpl">JVCL Managed Threads</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvMMD10D.bpl">JVCL Multimedia and Image Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvNetD10D.bpl">JVCL Network Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPageCompsD10D.bpl">JVCL Page Style Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPluginD10D.bpl">JVCL Plugin Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPrintPreviewD10D.bpl">JVCL Print Preview Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvRuntimeDesignD10D.bpl">JVCL Runtime Design Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvTimeFrameworkD10D.bpl">JVCL Time Framework</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvUIBD10D.bpl">JVCL Unified Interbase Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvValidatorsD10D.bpl">JVCL Validators and Error Provider Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvWizardD10D.bpl">JVCL Wizard</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvXPCtrlsD10D.bpl">JVCL XP Controls</Excluded_Packages>
+    </Excluded_Packages>
+    <Source>
+      <Source Name="MainSource">dws2Runtime.dpk</Source>
+    </Source>
+  </Delphi.Personality> </BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <ItemGroup />
+  <ItemGroup>
+    <DelphiCompile Include="dws2Runtime.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="..\source\dws2Comp.pas" />
+    <DCCReference Include="..\source\dws2Compiler.pas" />
+    <DCCReference Include="..\source\dws2CompStrings.pas" />
+    <DCCReference Include="..\source\dws2Debugger.pas" />
+    <DCCReference Include="..\source\dws2Errors.pas" />
+    <DCCReference Include="..\source\dws2Exprs.pas" />
+    <DCCReference Include="..\source\dws2FileFunctions.pas" />
+    <DCCReference Include="..\source\dws2Functions.pas" />
+    <DCCReference Include="..\source\dws2GlobalVarsFunctions.pas" />
+    <DCCReference Include="..\source\dws2HtmlFilter.pas" />
+    <DCCReference Include="..\Source\dws2IDEUtils.pas" />
+    <DCCReference Include="..\source\dws2MathFunctions.pas" />
+    <DCCReference Include="..\source\dws2Stack.pas" />
+    <DCCReference Include="..\Source\dws2StringFunctions.pas" />
+    <DCCReference Include="..\Source\dws2StringResult.pas" />
+    <DCCReference Include="..\source\dws2Strings.pas" />
+    <DCCReference Include="..\source\dws2Symbols.pas" />
+    <DCCReference Include="..\source\dws2TimeFunctions.pas" />
+    <DCCReference Include="..\source\dws2Tokenizer.pas" />
+    <DCCReference Include="..\Source\dws2UnitUtils.pas" />
+    <DCCReference Include="..\Source\dws2VariantFunctions.pas" />
+    <DCCReference Include="rtl.dcp" />
+    <None Include="..\source\dws2.inc" />
+  </ItemGroup>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+</Project>
\ No newline at end of file

Added: utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2SynEditUtilsRuntime.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2SynEditUtilsRuntime.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2SynEditUtilsRuntime.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,44 @@
+package dws2SynEditUtilsRuntime;
+
+{$R *.res}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphWebScript II - SynEdit IDE Utility runtime'}
+{$LIBSUFFIX '100'}
+{$LIBVERSION '20'}
+{$RUNONLY}
+{$IMPLICITBUILD OFF}
+
+requires
+  rtl,
+  vcl,
+  SynEdit_D2007,
+  vclx,
+  vcldb,
+  dbrtl,
+  dws2Runtime,
+  dws2VCLRuntime;
+
+contains
+  dws2SynEditUtils in '..\Source\dws2SynEditUtils.pas';
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2SynEditUtilsRuntime.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2SynEditUtilsRuntime.dproj	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2SynEditUtilsRuntime.dproj	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,83 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{6ba3ab1e-9f31-46c5-9712-d997fd8c8074}</ProjectGuid>
+    <MainSource>dws2SynEditUtilsRuntime.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dws2SynEditUtilsRuntime100.bpl.20</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="PackageDescription">DelphWebScript II - SynEdit IDE Utility runtime</Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">False</Package_Options><Package_Options Name="RuntimeOnly">True</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">20</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">False</VersionInf!
 o><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">3079</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Excluded_Packages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclbde100.bpl">Borland BDE DB Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclib100.bpl">Borland InterBase Express Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclofficexp100.bpl">Microsoft Office XP Sample Automation Server Wrapper Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclIndyCore100.bpl">Indy 10 Core Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclsoap100.bpl">Borland SOAP Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\applet100.bpl">Borland Control Panel Applet Package</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcltee100.bpl">TeeChart Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIndyProtocols100.bpl">Indy 10 Protocols Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIntraweb_80_100.bpl">Intraweb 8.0 Design Package for Borland Development Studio 2006</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\CivEvoButtons.bpl">(untitled)</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclie100.bpl">Internet Explorer Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvAppFrmD10D.bpl">JVCL Application and Form Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBandsD10D.bpl">JVCL Band Objects</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBDED10D.bpl">JVCL BDE Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCmpD10D.bpl">JVCL Non-Visual Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCryptD10D.bpl">JVCL Encryption and Compression</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCtrlsD10D.bpl">JVCL Visual Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCustomD10D.bpl">JVCL Custom Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDBD10D.bpl">JVCL Database Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDlgsD10D.bpl">JVCL Dialog Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDockingD10D.bpl">JVCL Docking Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDotNetCtrlsD10D.bpl">JVCL DotNet Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvEDID10D.bpl">JVCL EDI Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvGlobusD10D.bpl">JVCL Globus Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvHMID10D.bpl">JVCL HMI Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvInterpreterD10D.bpl">JVCL Interpreter Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvJansD10D.bpl">JVCL Jans Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvManagedThreadsD10D.bpl">JVCL Managed Threads</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvMMD10D.bpl">JVCL Multimedia and Image Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvNetD10D.bpl">JVCL Network Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPageCompsD10D.bpl">JVCL Page Style Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPluginD10D.bpl">JVCL Plugin Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPrintPreviewD10D.bpl">JVCL Print Preview Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvRuntimeDesignD10D.bpl">JVCL Runtime Design Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvTimeFrameworkD10D.bpl">JVCL Time Framework</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvUIBD10D.bpl">JVCL Unified Interbase Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvValidatorsD10D.bpl">JVCL Validators and Error Provider Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvWizardD10D.bpl">JVCL Wizard</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvXPCtrlsD10D.bpl">JVCL XP Controls</Excluded_Packages>
+    </Excluded_Packages><Source><Source Name="MainSource">dws2SynEditUtilsRuntime.dpk</Source></Source></Delphi.Personality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+  <ItemGroup>
+    <DelphiCompile Include="dws2SynEditUtilsRuntime.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="..\Source\dws2SynEditUtils.pas" />
+    <DCCReference Include="C:\Documents and Settings\developer\dbrtl.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dws2Runtime.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dws2VCLRuntime.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\rtl.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\SynEdit_D2.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\SynEdit_D20.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\SynEdit_D200.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\vcl.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\vcldb.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\vclx.dcp" />
+  </ItemGroup>
+</Project>
\ No newline at end of file

Added: utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2VCLRuntime.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2VCLRuntime.dpk	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2VCLRuntime.dpk	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,43 @@
+package dws2VCLRuntime;
+
+{$R *.res}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS OFF}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'DelphiWebScript II'}
+{$LIBSUFFIX '100'}
+{$LIBVERSION '20'}
+{$RUNONLY}
+{$IMPLICITBUILD OFF}
+
+requires
+  VCL,
+  dws2Runtime,
+  rtl;
+
+contains
+  dws2VCLGUIFunctions in '..\source\dws2VCLGUIFunctions.pas',
+  dws2ComConnector in '..\Source\dws2ComConnector.pas',
+  dws_VCLmwPasToRtf in '..\Source\dws_VCLmwPasToRtf.pas',
+  dws2VCLIDEUtils in '..\Source\dws2VCLIDEUtils.pas',
+  dws2VCLSymbolsToTree in '..\Source\dws2VCLSymbolsToTree.pas';
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2VCLRuntime.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2VCLRuntime.dproj	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/delphi2007/dws2VCLRuntime.dproj	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,245 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{8da558fe-6640-460e-958b-463532a85777}</ProjectGuid>
+    <MainSource>dws2VCLRuntime.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dws2VCLRuntime100.bpl.20</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_StrictVarStrings>False</DCC_StrictVarStrings>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_StrictVarStrings>False</DCC_StrictVarStrings>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject xmlns=""> <Delphi.Personality>   <Parameters>
+      <Parameters Name="UseLauncher">False</Parameters>
+      <Parameters Name="LoadAllSymbols">True</Parameters>
+      <Parameters Name="LoadUnspecifiedSymbols">False</Parameters>
+    </Parameters>
+    <Package_Options>
+      <Package_Options Name="PackageDescription">DelphiWebScript II</Package_Options>
+      <Package_Options Name="ImplicitBuild">False</Package_Options>
+      <Package_Options Name="DesigntimeOnly">False</Package_Options>
+      <Package_Options Name="RuntimeOnly">True</Package_Options>
+      <Package_Options Name="LibSuffix">100</Package_Options>
+      <Package_Options Name="LibVersion">20</Package_Options>
+    </Package_Options>
+    <VersionInfo>
+      <VersionInfo Name="IncludeVerInfo">True</VersionInfo>
+      <VersionInfo Name="AutoIncBuild">False</VersionInfo>
+      <VersionInfo Name="MajorVer">2</VersionInfo>
+      <VersionInfo Name="MinorVer">0</VersionInfo>
+      <VersionInfo Name="Release">0</VersionInfo>
+      <VersionInfo Name="Build">1</VersionInfo>
+      <VersionInfo Name="Debug">False</VersionInfo>
+      <VersionInfo Name="PreRelease">False</VersionInfo>
+      <VersionInfo Name="Special">False</VersionInfo>
+      <VersionInfo Name="Private">False</VersionInfo>
+      <VersionInfo Name="DLL">False</VersionInfo>
+      <VersionInfo Name="Locale">1033</VersionInfo>
+      <VersionInfo Name="CodePage">1252</VersionInfo>
+    </VersionInfo>
+    <VersionInfoKeys>
+      <VersionInfoKeys Name="CompanyName">DelphiWebScript OpenSource Project</VersionInfoKeys>
+      <VersionInfoKeys Name="FileDescription">DWSII internal VCL functions</VersionInfoKeys>
+      <VersionInfoKeys Name="FileVersion">2.0.0.1</VersionInfoKeys>
+      <VersionInfoKeys Name="InternalName">dws2VCLRuntime.dpk</VersionInfoKeys>
+      <VersionInfoKeys Name="LegalCopyright">see http://www.dwscript.com for list</VersionInfoKeys>
+      <VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys>
+      <VersionInfoKeys Name="OriginalFilename">dws2VCLRuntime.bpl</VersionInfoKeys>
+      <VersionInfoKeys Name="ProductName">DelphiWebScriptII</VersionInfoKeys>
+      <VersionInfoKeys Name="ProductVersion">2.0</VersionInfoKeys>
+      <VersionInfoKeys Name="Comments">see http://www.dwscript.com</VersionInfoKeys>
+    </VersionInfoKeys>
+    <Excluded_Packages>
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclbde100.bpl">Borland BDE DB Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclib100.bpl">Borland InterBase Express Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclofficexp100.bpl">Microsoft Office XP Sample Automation Server Wrapper Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Program Files\Borland\BDS\4.0\Bin\dclIndyCore100.bpl">Indy 10 Core Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclsoap100.bpl">Borland SOAP Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\applet100.bpl">Borland Control Panel Applet Package</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dcltee100.bpl">TeeChart Components</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIndyProtocols100.bpl">Indy 10 Protocols Design Time</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIntraweb_80_100.bpl">Intraweb 8.0 Design Package for Borland Development Studio 2006</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\CivEvoButtons.bpl">(untitled)</Excluded_Packages>
+      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclie100.bpl">Internet Explorer Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvAppFrmD10D.bpl">JVCL Application and Form Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBandsD10D.bpl">JVCL Band Objects</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBDED10D.bpl">JVCL BDE Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCmpD10D.bpl">JVCL Non-Visual Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCryptD10D.bpl">JVCL Encryption and Compression</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCtrlsD10D.bpl">JVCL Visual Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCustomD10D.bpl">JVCL Custom Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDBD10D.bpl">JVCL Database Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDlgsD10D.bpl">JVCL Dialog Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDockingD10D.bpl">JVCL Docking Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDotNetCtrlsD10D.bpl">JVCL DotNet Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvEDID10D.bpl">JVCL EDI Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvGlobusD10D.bpl">JVCL Globus Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvHMID10D.bpl">JVCL HMI Controls</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvInterpreterD10D.bpl">JVCL Interpreter Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvJansD10D.bpl">JVCL Jans Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvManagedThreadsD10D.bpl">JVCL Managed Threads</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvMMD10D.bpl">JVCL Multimedia and Image Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvNetD10D.bpl">JVCL Network Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPageCompsD10D.bpl">JVCL Page Style Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPluginD10D.bpl">JVCL Plugin Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPrintPreviewD10D.bpl">JVCL Print Preview Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvRuntimeDesignD10D.bpl">JVCL Runtime Design Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvTimeFrameworkD10D.bpl">JVCL Time Framework</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvUIBD10D.bpl">JVCL Unified Interbase Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvValidatorsD10D.bpl">JVCL Validators and Error Provider Components</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvWizardD10D.bpl">JVCL Wizard</Excluded_Packages>
+      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvXPCtrlsD10D.bpl">JVCL XP Controls</Excluded_Packages>
+    </Excluded_Packages>
+    <Source>
+      <Source Name="MainSource">dws2VCLRuntime.dpk</Source>
+    </Source>
+  </Delphi.Personality> </BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <ItemGroup />
+  <ItemGroup>
+    <DelphiCompile Include="dws2VCLRuntime.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="..\Source\dws2ComConnector.pas" />
+    <DCCReference Include="..\source\dws2VCLGUIFunctions.pas" />
+    <DCCReference Include="..\Source\dws2VCLIDEUtils.pas" />
+    <DCCReference Include="..\Source\dws2VCLSymbolsToTree.pas" />
+    <DCCReference Include="..\Source\dws_VCLmwPasToRtf.pas" />
+    <DCCReference Include="dws2Runtime.dcp" />
+    <DCCReference Include="rtl.dcp" />
+    <DCCReference Include="VCL.dcp" />
+    <None Include="..\source\dws2.inc" />
+  </ItemGroup>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+</Project>
\ No newline at end of file

Added: utilities/dzBdsIdeScript/trunk/dws2/delphi2007.groupproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dws2/delphi2007.groupproj	2007-05-05 20:35:47 UTC (rev 142)
+++ utilities/dzBdsIdeScript/trunk/dws2/delphi2007.groupproj	2007-05-05 21:01:36 UTC (rev 143)
@@ -0,0 +1,58 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{b1972940-0cf4-4cb2-a722-27bd9fa1ed2c}</ProjectGuid>
+  </PropertyGroup>
+  <ItemGroup />
+  <ItemGroup />
+  <ProjectExtensions>
+    <Borland.Personality>Default.Personality</Borland.Personality>
+    <Borland.ProjectType />
+    <BorlandProject>
+  <BorlandProject xmlns=""> <Default.Personality> </Default.Personality> </BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Target Name="dws2Runtime">
+    <MSBuild Projects="delphi2007\dws2Runtime.dproj" Targets="" />
+  </Target>
+  <Target Name="dws2Runtime:Clean">
+    <MSBuild Projects="delphi2007\dws2Runtime.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="dws2Runtime:Make">
+    <MSBuild Projects="delphi2007\dws2Runtime.dproj" Targets="Make" />
+  </Target>
+  <Target Name="dws2VCLRuntime">
+    <MSBuild Projects="delphi2007\dws2VCLRuntime.dproj" Targets="" />
+  </Target>
+  <Target Name="dws2VCLRuntime:Clean">
+    <MSBuild Projects="delphi2007\dws2VCLRuntime.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="dws2VCLRuntime:Make">
+    <MSBuild Projects="delphi2007\dws2VCLRuntime.dproj" Targets="Make" />
+  </Target>
+  <Target Name="dcldws2">
+    <MSBuild Projects="delphi2007\dcldws2.dproj" Targets="" />
+  </Target>
+  <Target Name="dcldws2:Clean">
+    <MSBuild Projects="delphi2007\dcldws2.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="dcldws2:Make">
+    <MSBuild Projects="delphi2007\dcldws2.dproj" Targets="Make" />
+  </Target>
+  <Target Name="dws2SynEditUtilsRuntime">
+    <MSBuild Projects="delphi2007\dws2SynEditUtilsRuntime.dproj" Targets="" />
+  </Target>
+  <Target Name="dws2SynEditUtilsRuntime:Clean">
+    <MSBuild Projects="delphi2007\dws2SynEditUtilsRuntime.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="dws2SynEditUtilsRuntime:Make">
+    <MSBuild Projects="delphi2007\dws2SynEditUtilsRuntime.dproj" Targets="Make" />
+  </Target>
+  <Target Name="Build">
+    <CallTarget Targets="dws2Runtime;dws2VCLRuntime;dcldws2;dws2SynEditUtilsRuntime" />
+  </Target>
+  <Target Name="Clean">
+    <CallTarget Targets="dws2Runtime:Clean;dws2VCLRuntime:Clean;dcldws2:Clean;dws2SynEditUtilsRuntime:Clean" />
+  </Target>
+  <Target Name="Make">
+    <CallTarget Targets="dws2Runtime:Make;dws2VCLRuntime:Make;dcldws2:Make;dws2SynEditUtilsRuntime:Make" />
+  </Target>
+</Project>
\ No newline at end of file


Property changes on: utilities/dzBdsIdeScript/trunk/dws2/design
___________________________________________________________________
Name: svn:ignore
   + *.dcu


Copied: utilities/dzBdsIdeScript/trunk/dws2/design/dws2Register.pas (from rev 139, utilities/dzBdsIdeScript/trunk/dws2/bds4/dws2Register.pas)



From twm at mail.berlios.de  Sat May  5 23:24:09 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Sat, 5 May 2007 23:24:09 +0200
Subject: [Dzchart-svncheckins] r144 - utilities/dzBdsIdeScript/trunk
Message-ID: <200705052124.l45LO9VW017026@sheep.berlios.de>

Author: twm
Date: 2007-05-05 23:24:07 +0200 (Sat, 05 May 2007)
New Revision: 144

Added:
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj
Modified:
   utilities/dzBdsIdeScript/trunk/
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk
Log:
support for Delphi 2007


Property changes on: utilities/dzBdsIdeScript/trunk
___________________________________________________________________
Name: svn:ignore
   - dzBdsIdeScript.cfg
dzBdsIdeScript.res
ModelSupport_dzBdsIdeScript

   + dzBdsIdeScript.cfg
dzBdsIdeScript.res
ModelSupport_dzBdsIdeScript
de.dummzeuch.experts.BaseExpert.dcu
de.dummzeuch.experts.BdsIdeScriptExpert.dcu
dzBdsIdeScript.dcu
dzBdsIdeScript_project.tvsconfig


Modified: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk	2007-05-05 21:01:36 UTC (rev 143)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk	2007-05-05 21:24:07 UTC (rev 144)
@@ -27,11 +27,6 @@
 {$LIBVERSION '1.0'}
 {$DESIGNONLY}
 {$IMPLICITBUILD OFF}
-{%TogetherDiagram 'ModelSupport_dzBdsIdeScript\default.txaPackage'}
-{%TogetherDiagram 'ModelSupport_dzBdsIdeScript\de\default.txaPackage'}
-{%TogetherDiagram 'ModelSupport_dzBdsIdeScript\de\dummzeuch\default.txaPackage'}
-{%TogetherDiagram 'ModelSupport_dzBdsIdeScript\de\dummzeuch\experts\default.txaPackage'}
-{%TogetherDiagram 'ModelSupport_dzBdsIdeScript\de\dummzeuch\experts\BaseExpert\default.txaPackage'}
 
 requires
   vcl,

Added: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj	2007-05-05 21:01:36 UTC (rev 143)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj	2007-05-05 21:24:07 UTC (rev 144)
@@ -0,0 +1,54 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{44cac5b7-0797-4334-9402-468a20b16190}</ProjectGuid>
+    <MainSource>dzBdsIdeScript.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dzBdsIdeScript100.bpl.1.0</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_WriteableConstants>True</DCC_WriteableConstants>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_WriteableConstants>True</DCC_WriteableConstants>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="HostApplication">$(BDS)\Bin\bds.exe</Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="PackageDescription">BDS IDE Scripting using Delphi Web Script II</Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">1.0</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="B!
 uild">0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1033</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Excluded_Packages>
+      
+      
+      <Excluded_Packages Name="C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dzBdsIdeScript100.bpl.1.0">BDS IDE Scripting using Delphi Web Script II</Excluded_Packages>
+    </Excluded_Packages><Source><Source Name="MainSource">dzBdsIdeScript.dpk</Source></Source></Delphi.Personality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+  <ItemGroup>
+    <DelphiCompile Include="dzBdsIdeScript.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="C:\Documents and Settings\developer\designide.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dws2ClassesLibrary.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dws2Runtime.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dws2VCLRuntime.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\vcl.dcp" />
+    <DCCReference Include="de.dummzeuch.experts.BaseExpert.pas">
+      <Form>dm_DzBaseExpert</Form>
+    </DCCReference>
+    <DCCReference Include="de.dummzeuch.experts.BdsIdeScriptExpert.pas">
+      <Form>dm_dzBdsIdeScriptExpert</Form>
+    </DCCReference>
+    <None Include="ModelSupport_dzBdsIdeScript\default.txaPackage" />
+    <None Include="ModelSupport_dzBdsIdeScript\de\default.txaPackage" />
+    <None Include="ModelSupport_dzBdsIdeScript\de\dummzeuch\default.txaPackage" />
+    <None Include="ModelSupport_dzBdsIdeScript\de\dummzeuch\experts\BaseExpert\default.txaPackage" />
+    <None Include="ModelSupport_dzBdsIdeScript\de\dummzeuch\experts\default.txaPackage" />
+  </ItemGroup>
+</Project>
\ No newline at end of file



From twm at mail.berlios.de  Sun May  6 16:48:06 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Sun, 6 May 2007 16:48:06 +0200
Subject: [Dzchart-svncheckins] r145 - in utilities/dzBdsIdeScript/trunk: .
	dcu src
Message-ID: <200705061448.l46Em69t031871@sheep.berlios.de>

Author: twm
Date: 2007-05-06 16:47:58 +0200 (Sun, 06 May 2007)
New Revision: 145

Added:
   utilities/dzBdsIdeScript/trunk/dcu/
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.groupproj
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dpk
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dproj
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj
   utilities/dzBdsIdeScript/trunk/out/
   utilities/dzBdsIdeScript/trunk/src/
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.ScriptHandler.DWS2.pas
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.ScriptHandler.Manager.pas
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BaseExpert.dfm
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BaseExpert.pas
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.dfm
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas
Removed:
   utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.dfm
   utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.pas
   utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BdsIdeScriptExpert.dfm
   utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BdsIdeScriptExpert.pas
Modified:
   utilities/dzBdsIdeScript/trunk/
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj
Log:
now has a plugin architecture that allows using different scripting engines


Property changes on: utilities/dzBdsIdeScript/trunk
___________________________________________________________________
Name: svn:ignore
   - dzBdsIdeScript.cfg
dzBdsIdeScript.res
ModelSupport_dzBdsIdeScript
de.dummzeuch.experts.BaseExpert.dcu
de.dummzeuch.experts.BdsIdeScriptExpert.dcu
dzBdsIdeScript.dcu
dzBdsIdeScript_project.tvsconfig

   + dzBdsIdeScript.cfg
dzBdsIdeScript.res
ModelSupport_dzBdsIdeScript
de.dummzeuch.experts.BaseExpert.dcu
de.dummzeuch.experts.BdsIdeScriptExpert.dcu
dzBdsIdeScript.dcu
dzBdsIdeScript_project.tvsconfig
dzBdsIdeScript_DWS2.dcu
dzBdsIdeScript_DWS2.res
dzBdsIdeScriptInterfaces.res



Property changes on: utilities/dzBdsIdeScript/trunk/dcu
___________________________________________________________________
Name: svn:ignore
   + *.dcu


Deleted: utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.dfm
===================================================================
--- utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.dfm	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.dfm	2007-05-06 14:47:58 UTC (rev 145)
@@ -1,5 +0,0 @@
-object dm_DzBaseExpert: Tdm_DzBaseExpert
-  OldCreateOrder = False
-  Height = 150
-  Width = 215
-end

Deleted: utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.pas
===================================================================
--- utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.pas	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.pas	2007-05-06 14:47:58 UTC (rev 145)
@@ -1,245 +0,0 @@
-unit de.dummzeuch.experts.BaseExpert;
-
-interface
-
-uses
-  SysUtils,
-  Classes,
-  Forms,
-  Graphics,
-  Menus,
-  ToolsAPI;
-
-type
-  IMsgWindow = interface ['{94A55B0E-1185-4469-85F6-28A2A433A609}']
-    procedure Write(const _Msg: string; _Show: Boolean = False);
-    procedure Clear;
-  end;
-
-type
-  Tdm_DzBaseExpert = class(TDataModule)
-  protected // helper methods
-    function GetMsgWindow(_Title: string): IMsgWindow;
-    function GetBaseRegistryKey: string;
-    function GetDelphiCustomMenu(const _Caption: string): TMenuItem;
-    function TryGetDelphiCustomMenu(const _Caption: string; out _Item: TMenuItem): Boolean;
-    procedure DeleteDelphiCustomMenu(const _Caption: string);
-    function GetSelectedText: string;
-    function GetSourceEditor: IOTASourceEditor;
-    procedure InsertText(const _Text: string);
-    procedure SetSelectedText(const _Text: string);
-  end;
-
-implementation
-
-{$R *.dfm}
-
-type
-  TMsgWindow = class(TInterfacedObject, IMsgWindow)
-  private
-    FTitle: string;
-  public
-    constructor Create(const _Title: string = '');
-    procedure Write(const _Msg: string; _Show: Boolean = False);
-    procedure Clear;
-  end;
-
-{ Tdm_DzBaseExpert }
-
-procedure Tdm_DzBaseExpert.DeleteDelphiCustomMenu(const _Caption: string);
-var
-  Item: TMenuItem;
-begin
-  if TryGetDelphiCustomMenu(_Caption, Item) then
-    Item.Free;
-end;
-
-function Tdm_DzBaseExpert.GetBaseRegistryKey: string;
-begin
-  Result := (BorlandIDEServices as IOTAServices).GetBaseRegistryKey;
-end;
-
-function Tdm_DzBaseExpert.GetDelphiCustomMenu(const _Caption: string): TMenuItem;
-var
-  MainMenu: TMenuItem;
-  NTAServices: INTAServices;
-begin
-  Result := nil;
-  if not Supports(BorlandIDEServices, INTAServices, NTAServices) then
-    Exit;
-
-  MainMenu := NTAServices.MainMenu.Items;
-  if not Assigned(MainMenu) then
-    Exit;
-
-  Result := MainMenu.Find(_Caption);
-  if Result = nil then begin
-    Result := TMenuItem.Create(MainMenu);
-    Result.Caption := _Caption;
-    MainMenu.Add(Result);
-  end;
-end;
-
-function Tdm_DzBaseExpert.GetMsgWindow(_Title: string): IMsgWindow;
-begin
-  Result := TMsgWindow.Create(_Title);
-end;
-
-function Tdm_DzBaseExpert.GetSelectedText: string;
-var
-  Block: IOTAEditBlock;
-  CurrMod: IOTAModule;
-  i: Integer;
-  Editor: IOTASourceEditor;
-  View: IOTAEditView;
-begin
-  Result := '';
-  CurrMod := (BorlandIDEServices as IOTAModuleServices).CurrentModule;
-  if not Assigned(CurrMod) then
-    Exit;
-  for i := 0 to CurrMod.GetModuleFileCount - 1 do
-    if CurrMod.GetModuleFileEditor(i).QueryInterface(IOTASourceEditor, Editor) = S_OK then begin
-      if Editor.GetEditViewCount = 0 then
-        continue;
-      View := Editor.EditViews[0];
-      if View = nil then
-        continue;
-      Block := View.GetBlock;
-      if Block = nil then
-        continue;
-      Result := Block.Text;
-      Exit;
-    end;
-end;
-
-function Tdm_DzBaseExpert.GetSourceEditor: IOTASourceEditor;
-var
-  CurrMod: IOTAModule;
-  i: Integer;
-begin
-  Result := nil;
-  CurrMod := (BorlandIDEServices as IOTAModuleServices).CurrentModule;
-  if not Assigned(CurrMod) then Exit;
-  for i := 0 to CurrMod.GetModuleFileCount - 1 do
-    if CurrMod.GetModuleFileEditor(i).QueryInterface(IOTASourceEditor, Result) = S_OK then
-      Exit;
-end;
-
-procedure Tdm_DzBaseExpert.InsertText(const _Text: string);
-var
-  OldAutoIndent: Boolean;
-  Buffer: IOTAEditBuffer;
-  Editor: IOTASourceEditor;
-  View: IOTAEditView;
-begin
-  Editor := GetSourceEditor;
-  if (Editor = nil) or (Editor.GetEditViewCount = 0) then
-    Exit;
-
-  View := Editor.GetEditView(0);
-  if View = nil then
-    Exit;
-
-  Buffer := View.GetBuffer;
-  if Buffer = nil then
-    Exit;
-
-  OldAutoIndent := Buffer.BufferOptions.AutoIndent;
-  try
-    Buffer.BufferOptions.AutoIndent := False;
-    View.Position.InsertText(_Text);
-    View.Paint;
-  finally
-    Buffer.BufferOptions.AutoIndent := OldAutoIndent;
-  end;
-end;
-
-procedure Tdm_DzBaseExpert.SetSelectedText(const _Text: string);
-var
-  OldAutoIndent: Boolean;
-  Buffer: IOTAEditBuffer;
-  Block: IOTAEditBlock;
-  Editor: IOTASourceEditor;
-  i: Integer;
-  View: IOTAEditView;
-begin
-  Editor := GetSourceEditor;
-  if Editor = nil then
-    Exit;
-  for i := 0 to Editor.GetEditViewCount - 1 do begin
-    View := Editor.GetEditView(i);
-    if View = nil then
-      continue;
-    Block := View.GetBlock;
-    if Block.Text <> '' then begin
-      Buffer := View.GetBuffer;
-      OldAutoIndent := Buffer.BufferOptions.AutoIndent;
-      try
-        Buffer.BufferOptions.AutoIndent := False;
-        View.Position.InsertText(_Text);
-        View.Paint;
-      finally
-        Buffer.BufferOptions.AutoIndent := OldAutoIndent;
-      end;
-      Exit;
-    end;
-  end;
-end;
-
-function Tdm_DzBaseExpert.TryGetDelphiCustomMenu(const _Caption: string; out _Item: TMenuItem): Boolean;
-var
-  NTAServices: INTAServices;
-  MainMenu: TMenuItem;
-begin
-  Result := Supports(BorlandIDEServices, INTAServices, NTAServices);
-  if not Result then
-    Exit;
-
-  MainMenu := NTAServices.MainMenu.Items;
-  _Item := MainMenu.Find(_Caption);
-  Result := Assigned(_Item);
-end;
-
-{ TMsgWindow }
-
-procedure TMsgWindow.Clear;
-var
-  MessageView: IOTAMessageServices;
-  MessageGroup: IOTAMessageGroup;
-begin
-  if Supports(BorlandIDEServices, IOTAMessageServices, MessageView) then begin
-    MessageGroup := MessageView.AddMessageGroup(FTitle);
-    MessageView.ClearMessageGroup(MessageGroup);
-  end;
-end;
-
-constructor TMsgWindow.Create(const _Title: string);
-begin
-  inherited Create;
-  FTitle := _Title;
-end;
-
-procedure TMsgWindow.Write(const _Msg: string; _Show: Boolean);
-var
-  MessageView: IOTAMessageServices;
-  MessageGroup: IOTAMessageGroup;
-  st: TStringList;
-  i: Integer;
-begin
-  if Supports(BorlandIDEServices, IOTAMessageServices, MessageView) then begin
-    st := TStringList.Create;
-    try
-      st.Text := _Msg;
-      MessageGroup := MessageView.AddMessageGroup(FTitle);
-      if _Show then
-        MessageView.ShowMessageView(MessageGroup);
-      for i := 0 to st.Count - 1 do
-        MessageView.AddTitleMessage(st[i], MessageGroup);
-    finally
-      st.Free;
-    end;
-  end;
-end;
-
-end.
-

Deleted: utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BdsIdeScriptExpert.dfm
===================================================================
--- utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BdsIdeScriptExpert.dfm	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BdsIdeScriptExpert.dfm	2007-05-06 14:47:58 UTC (rev 145)
@@ -1,52 +0,0 @@
-inherited dm_dzBdsIdeScriptExpert: Tdm_dzBdsIdeScriptExpert
-  OldCreateOrder = True
-  OnCreate = DataModuleCreate
-  OnDestroy = DataModuleDestroy
-  Height = 219
-  Width = 217
-  object TheTimer: TTimer
-    Enabled = False
-    Interval = 5000
-    OnTimer = TheTimerTimer
-    Left = 24
-    Top = 16
-  end
-  object dws2Unit: Tdws2Unit
-    Script = dws_Main
-    Arrays = <>
-    Classes = <>
-    Constants = <>
-    Dependencies.Strings = (
-      'Classes')
-    Enumerations = <>
-    Forwards = <>
-    Functions = <>
-    Instances = <>
-    Records = <>
-    Synonyms = <>
-    UnitName = 'dzIdeEditor'
-    Variables = <>
-    StaticSymbols = False
-    Left = 112
-    Top = 88
-  end
-  object dws_Main: TDelphiWebScriptII
-    Config.CompilerOptions = []
-    Config.MaxDataSize = 0
-    Config.Timeout = 0
-    Left = 24
-    Top = 88
-  end
-  inline dws2ClassesLib: Tdws2ClassesLib
-    OldCreateOrder = False
-    Script = dws_Main
-    Left = 24
-    Top = 144
-    Height = 0
-    Width = 0
-  end
-  object dws2FileFunctions: Tdws2FileFunctions
-    Left = 112
-    Top = 144
-  end
-end

Deleted: utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BdsIdeScriptExpert.pas
===================================================================
--- utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BdsIdeScriptExpert.pas	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BdsIdeScriptExpert.pas	2007-05-06 14:47:58 UTC (rev 145)
@@ -1,343 +0,0 @@
-unit de.dummzeuch.experts.BdsIdeScriptExpert;
-
-interface
-
-uses
-  Windows,
-  Messages,
-  SysUtils,
-  Classes,
-  Graphics,
-  Controls,
-  Forms,
-  Dialogs,
-  Menus,
-  ExtCtrls,
-  ToolsAPI,
-  dws2Comp,
-  dws2Exprs,
-  dws2StringFunctions,
-  dws2FileFunctions,
-  dws2ClassesLibModule,
-  de.dummzeuch.experts.BaseExpert;
-
-type
-  Tdm_dzBdsIdeScriptExpert = class(Tdm_DzBaseExpert)
-    TheTimer: TTimer;
-    dws2Unit: Tdws2Unit;
-    dws_Main: TDelphiWebScriptII;
-    dws2ClassesLib: Tdws2ClassesLib;
-    dws2FileFunctions: Tdws2FileFunctions;
-    procedure DataModuleCreate(Sender: TObject);
-    procedure DataModuleDestroy(Sender: TObject);
-    procedure RunScriptSubItemClick(Sender: TObject);
-    procedure RunScriptExplainClick(Sender: TObject);
-    procedure TheTimerTimer(Sender: TObject);
-  private
-    FScriptItems: TList;
-    FScripts: TStringList;
-
-    procedure ClearMenuItems(_List: TList);
-    procedure ClearScriptMenuItems;
-    procedure LoadScripts;
-    procedure RefreshMenuItems;
-    procedure RefreshScriptMenuItems;
-    procedure SetTimerRefreshing;
-  private
-    function Compile(const _Source: string): TProgram;
-    procedure ExecuteScript(_Code: TStrings);
-    procedure OnIdeEditorGetSelectedTextEval(_Info: TProgramInfo; _ExtObject: TObject);
-    procedure OnIdeEditorSetSelectedTextEval(_Info: TProgramInfo; _ExtObject: TObject);
-    procedure OnIdeEditorInsertTextEval(_Info: TProgramInfo; _ExtObject: TObject);
-    procedure RegisterOTAFunctions;
-  end;
-
-implementation
-
-{$R *.DFM}
-
-uses
-  Registry,
-  ShellAPI,
-  dws2Symbols,
-  dws2Compiler;
-
-const
-  MESSAGE_WINDOW_TITLE = 'BdsIdeScript';
-  CUSTOM_MENU_CAPTION = 'Scripts';
-  REGISTRY_BRANCH = 'dzBdsIdeScript';
-
-procedure Tdm_dzBdsIdeScriptExpert.ExecuteScript(_Code: TStrings);
-var
-  i: Integer;
-  Prog: TProgram;
-  Msg: IMsgWindow;
-begin
-  Msg := GetMsgWindow(MESSAGE_WINDOW_TITLE);
-  Msg.Write('Compiling script.');
-  try
-    Prog := Compile(_Code.Text);
-  except
-    on e: Exception do begin
-      Msg.Write('Error compiling script:'#13#10 + e.Message, True);
-      Exit;
-    end;
-  end;
-
-  Msg.Write('Running script.');
-  try
-//    Prog.BeginProgram();
-    Prog.Execute;
-//    Prog.EndProgram;
-
-    for i := 0 to Prog.Msgs.Count - 1 do
-      Msg.Write(Prog.Msgs[i].asInfo);
-    Msg.Write(Tdws2DefaultResult(Prog.Result).Text);
-
-  finally
-    Prog.Free;
-  end;
-  Msg.Write('Done.');
-end;
-
-function Tdm_dzBdsIdeScriptExpert.Compile(const _Source: string): TProgram;
-var
-  i: Integer;
-  err: string;
-begin
-  Result := dws_Main.Compile(_Source);
-  if Result.Msgs.HasCompilerErrors then begin
-    err := '';
-    for i := 0 to Result.Msgs.Count - 1 do begin
-      if err <> '' then
-        err := err + #13#10;
-      err := err + Result.Msgs[i].asInfo;
-    end;
-    Result.Free;
-    raise Exception.Create(err);
-  end;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.DataModuleCreate(Sender: TObject);
-begin
-  FScriptItems := TList.Create;
-  FScripts := TStringList.Create;
-
-  RefreshMenuItems;
-
-  RegisterOTAFunctions;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.DataModuleDestroy(Sender: TObject);
-begin
-  ClearScriptMenuItems;
-  DeleteDelphiCustomMenu(CUSTOM_MENU_CAPTION);
-  FScripts.Free;
-  FScriptItems.Free;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.OnIdeEditorGetSelectedTextEval(_Info: TProgramInfo; _ExtObject: TObject);
-begin
-  _Info.Result := GetSelectedText;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.OnIdeEditorSetSelectedTextEval(_Info: TProgramInfo; _ExtObject: TObject);
-begin
-  SetSelectedText(_Info.Value['_Text']);
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.OnIdeEditorInsertTextEval(_Info: TProgramInfo; _ExtObject: TObject);
-begin
-  InsertText(_Info.Value['_Text']);
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.RegisterOTAFunctions;
-var
-  Item: Tdws2Class;
-  Meth: Tdws2Method;
-  Param: Tdws2Parameter;
-begin
-  Item := dws2Unit.Classes.Add as Tdws2Class;
-  Item.Name := 'TIdeEditor';
-
-  Meth := Item.Methods.Add as Tdws2Method;
-  Meth.Name := 'GetSelectedText';
-  Meth.Kind := mkClassFunction;
-  Meth.ResultType := 'String';
-  Meth.OnEval := OnIdeEditorGetSelectedTextEval;
-
-  Meth := Item.Methods.Add as Tdws2Method;
-  Meth.Name := 'SetSelectedText';
-  Meth.Kind := mkClassProcedure;
-  Param := Meth.Parameters.Add as Tdws2Parameter;
-  Param.Name := '_Text';
-  Param.DataType := 'String';
-  Meth.OnEval := OnIdeEditorSetSelectedTextEval;
-
-  Meth := Item.Methods.Add as Tdws2Method;
-  Meth.Name := 'InsertText';
-  Meth.Kind := mkClassProcedure;
-  Param := Meth.Parameters.Add as Tdws2Parameter;
-  Param.Name := '_Text';
-  Param.DataType := 'String';
-  Meth.OnEval := OnIdeEditorInsertTextEval;
-end;
-
-procedure ListFiles(const Path: string; Strings: TStrings);
-var
-  Found: Integer;
-  SearchRec: TSearchRec;
-begin
-  Found := FindFirst(Path, faAnyFile, SearchRec);
-  while Found = 0 do begin
-    if (SearchRec.Attr and faDirectory) <> faDirectory then
-      Strings.Add(SearchRec.Name);
-    Found := FindNext(SearchRec);
-  end;
-  FindClose(SearchRec);
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.LoadScripts;
-var
-  Folder: string;
-  i: Integer;
-  Reg: TRegistry;
-begin
-  Reg := TRegistry.Create;
-  try
-    Reg.OpenKey(GetBaseRegistryKey + '\' + REGISTRY_BRANCH, True);
-    if not Reg.ValueExists('ScriptFolder') then
-      { Add the IDE's folder. }
-      Reg.WriteString('ScriptFolder',
-        IncludeTrailingPathDelimiter(ExtractFilePath(Application.ExeName)) + 'Scripts')
-    else
-      Folder := Reg.ReadString('ScriptFolder');
-  finally
-    Reg.Free;
-  end;
-  Folder := IncludeTrailingPathDelimiter(Folder);
-  FScripts.Clear;
-  ListFiles(Folder + '*.dws', FScripts);
-  for i := 0 to FScripts.Count - 1 do
-    FScripts[i] := Folder + FScripts[i];
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.RunScriptExplainClick(Sender: TObject);
-begin
-  ShowMessage(
-    'Scripts should be placed in the folder pointed by '#13 +
-    'the registry value at:'#13#13 +
-    'HKCU\' + GetBaseRegistryKey + '\' + REGISTRY_BRANCH +
-    #13#13'The value should be assigned to "ScriptFolder".' +
-    #13#13'You can always refresh the script list by clicking this item.'
-    );
-  RefreshMenuItems;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.TheTimerTimer(Sender: TObject);
-begin
-  RefreshMenuItems;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.RefreshMenuItems;
-begin
-  RefreshScriptMenuItems;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.RefreshScriptMenuItems;
-var
-  i: Integer;
-  Item, ScriptMenu: TMenuItem;
-begin
-  ScriptMenu := GetDelphiCustomMenu(CUSTOM_MENU_CAPTION);
-  if ScriptMenu = nil then begin { The menu may not exist yet. }
-    TheTimer.Enabled := True;
-    Exit;
-  end;
-
-  LoadScripts;
-  ClearScriptMenuItems;
-
-  for i := 0 to FScripts.Count - 1 do begin
-    Item := TMenuItem.Create(nil);
-    FScriptItems.Add(Item);
-    Item.Caption := ChangeFileExt(ExtractFileName(FScripts[i]), '');
-    Item.Tag := i;
-    Item.OnClick := RunScriptSubItemClick;
-    ScriptMenu.Add(Item);
-  end;
-
-  Item := TMenuItem.Create(nil);
-  FScriptItems.Add(Item);
-  Item.Caption := '(customize)';
-  Item.OnClick := RunScriptExplainClick;
-  ScriptMenu.Add(Item);
-  SetTimerRefreshing;
-
-  ScriptMenu.Visible := FScripts.Count > 0;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.ClearMenuItems(_List: TList);
-var
-  i: Integer;
-begin
-  if (not Assigned(_List)) or (_List.Count = 0) then
-    Exit;
-  for i := 0 to _List.Count - 1 do
-    TMenuItem(_List[i]).Free;
-  _List.Clear;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.ClearScriptMenuItems;
-begin
-  ClearMenuItems(FScriptItems);
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.SetTimerRefreshing;
-var
-  Reg: TRegistry;
-begin
-  Reg := TRegistry.Create;
-  try
-    Reg.OpenKey(GetBaseRegistryKey + '\' + REGISTRY_BRANCH + '\Options', True);
-    if Reg.ValueExists('Refresh') then begin
-      TheTimer.Enabled := Reg.ReadBool('Refresh');
-    end else begin
-      Reg.WriteBool('Refresh', True);
-      TheTimer.Enabled := True;
-    end;
-  finally
-    Reg.Free;
-  end;
-end;
-
-procedure Tdm_dzBdsIdeScriptExpert.RunScriptSubItemClick(Sender: TObject);
-var
-  Code: TStringList;
-  FileName: string;
-  Idx: Integer;
-  Msg: IMsgWindow;
-begin
-  Idx := (Sender as TComponent).Tag;
-  FileName := FScripts[Idx];
-  Msg := GetMsgWindow(MESSAGE_WINDOW_TITLE);
-  Msg.Clear;
-  Msg.Write('Loading script ' + FileName);
-  Code := TStringList.Create;
-  try
-    Code.LoadFromFile(FileName);
-    ExecuteScript(Code);
-  finally
-    Code.Free;
-  end;
-end;
-
-var
-  Expert: Tdm_dzBdsIdeScriptExpert;
-
-initialization
-  Expert := Tdm_dzBdsIdeScriptExpert.Create(nil);
-finalization
-  Expert.Free;
-end.
-

Modified: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk	2007-05-06 14:47:58 UTC (rev 145)
@@ -22,9 +22,8 @@
 {$WRITEABLECONST ON}
 {$MINENUMSIZE 1}
 {$IMAGEBASE $400000}
-{$DESCRIPTION 'BDS IDE Scripting using Delphi Web Script II'}
+{$DESCRIPTION 'dummzeuch.de - BDS IDE Scripting Expert'}
 {$LIBSUFFIX '100'}
-{$LIBVERSION '1.0'}
 {$DESIGNONLY}
 {$IMPLICITBUILD OFF}
 
@@ -33,10 +32,11 @@
   designide,
   dws2VCLRuntime,
   dws2Runtime,
-  dws2ClassesLibrary;
+  dws2ClassesLibrary,
+  dzBdsIdeScriptInterfaces;
 
 contains
-  de.dummzeuch.experts.BdsIdeScriptExpert in 'de.dummzeuch.experts.BdsIdeScriptExpert.pas' {dm_dzBdsIdeScriptExpert: TDataModule},
-  de.dummzeuch.experts.BaseExpert in 'de.dummzeuch.experts.BaseExpert.pas' {dm_DzBaseExpert: TDataModule};
+  de.dummzeuch.experts.BdsIdeScriptExpert.Expert in 'src\de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas' {dm_dzBdsIdeScriptExpert: TDataModule},
+  de.dummzeuch.experts.BaseExpert in 'src\de.dummzeuch.experts.BaseExpert.pas' {dm_DzBaseExpert: TDataModule};
 
 end.

Modified: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj	2007-05-06 14:47:58 UTC (rev 145)
@@ -1,11 +1,12 @@
-?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+?<?xml version="1.0" encoding="utf-8"?>
+<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
   <PropertyGroup>
     <ProjectGuid>{44cac5b7-0797-4334-9402-468a20b16190}</ProjectGuid>
     <MainSource>dzBdsIdeScript.dpk</MainSource>
     <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
     <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
     <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
-    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dzBdsIdeScript100.bpl.1.0</DCC_DependencyCheckOutputName>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dzBdsIdeScript100.bpl</DCC_DependencyCheckOutputName>
   </PropertyGroup>
   <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
     <Version>7.0</Version>
@@ -23,11 +24,7 @@
     <Borland.Personality>Delphi.Personality</Borland.Personality>
     <Borland.ProjectType>Package</Borland.ProjectType>
     <BorlandProject>
-<BorlandProject><Delphi.Personality><Parameters><Parameters Name="HostApplication">$(BDS)\Bin\bds.exe</Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="PackageDescription">BDS IDE Scripting using Delphi Web Script II</Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">1.0</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="B!
 uild">0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1033</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Excluded_Packages>
-      
-      
-      <Excluded_Packages Name="C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dzBdsIdeScript100.bpl.1.0">BDS IDE Scripting using Delphi Web Script II</Excluded_Packages>
-    </Excluded_Packages><Source><Source Name="MainSource">dzBdsIdeScript.dpk</Source></Source></Delphi.Personality></BorlandProject></BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="HostApplication">$(BDS)\Bin\bds.exe</Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="PackageDescription">dummzeuch.de - BDS IDE Scripting Expert</Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">1.1</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build"!
 >0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1033</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Excluded_Packages></Exclude!
 d_Packages><Source><Source Name="MainSource">dzBdsIdeScript.dp!
 k</Sourc
e></Source></Delphi.Personality></BorlandProject></BorlandProject>
   </ProjectExtensions>
   <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
   <ItemGroup>
@@ -38,11 +35,12 @@
     <DCCReference Include="C:\Documents and Settings\developer\dws2ClassesLibrary.dcp" />
     <DCCReference Include="C:\Documents and Settings\developer\dws2Runtime.dcp" />
     <DCCReference Include="C:\Documents and Settings\developer\dws2VCLRuntime.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dzBdsIdeScriptInterfaces.dcp" />
     <DCCReference Include="C:\Documents and Settings\developer\vcl.dcp" />
-    <DCCReference Include="de.dummzeuch.experts.BaseExpert.pas">
+    <DCCReference Include="src\de.dummzeuch.experts.BaseExpert.pas">
       <Form>dm_DzBaseExpert</Form>
     </DCCReference>
-    <DCCReference Include="de.dummzeuch.experts.BdsIdeScriptExpert.pas">
+    <DCCReference Include="src\de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas">
       <Form>dm_dzBdsIdeScriptExpert</Form>
     </DCCReference>
     <None Include="ModelSupport_dzBdsIdeScript\default.txaPackage" />

Added: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.groupproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.groupproj	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.groupproj	2007-05-06 14:47:58 UTC (rev 145)
@@ -0,0 +1,49 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{6c147b39-6e78-46ce-a011-b3fd6b0b9dd8}</ProjectGuid>
+  </PropertyGroup>
+  <ItemGroup />
+  <ItemGroup />
+  <ProjectExtensions>
+    <Borland.Personality>Default.Personality</Borland.Personality>
+    <Borland.ProjectType />
+    <BorlandProject>
+<BorlandProject xmlns=""><Default.Personality></Default.Personality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Target Name="dzBdsIdeScriptInterfaces">
+    <MSBuild Projects="dzBdsIdeScriptInterfaces.dproj" Targets="" />
+  </Target>
+  <Target Name="dzBdsIdeScriptInterfaces:Clean">
+    <MSBuild Projects="dzBdsIdeScriptInterfaces.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="dzBdsIdeScriptInterfaces:Make">
+    <MSBuild Projects="dzBdsIdeScriptInterfaces.dproj" Targets="Make" />
+  </Target>
+  <Target Name="dzBdsIdeScript">
+    <MSBuild Projects="dzBdsIdeScript.dproj" Targets="" />
+  </Target>
+  <Target Name="dzBdsIdeScript:Clean">
+    <MSBuild Projects="dzBdsIdeScript.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="dzBdsIdeScript:Make">
+    <MSBuild Projects="dzBdsIdeScript.dproj" Targets="Make" />
+  </Target>
+  <Target Name="dzBdsIdeScript_DWS2">
+    <MSBuild Projects="dzBdsIdeScript_DWS2.dproj" Targets="" />
+  </Target>
+  <Target Name="dzBdsIdeScript_DWS2:Clean">
+    <MSBuild Projects="dzBdsIdeScript_DWS2.dproj" Targets="Clean" />
+  </Target>
+  <Target Name="dzBdsIdeScript_DWS2:Make">
+    <MSBuild Projects="dzBdsIdeScript_DWS2.dproj" Targets="Make" />
+  </Target>
+  <Target Name="Build">
+    <CallTarget Targets="dzBdsIdeScriptInterfaces;dzBdsIdeScript;dzBdsIdeScript_DWS2" />
+  </Target>
+  <Target Name="Clean">
+    <CallTarget Targets="dzBdsIdeScriptInterfaces:Clean;dzBdsIdeScript:Clean;dzBdsIdeScript_DWS2:Clean" />
+  </Target>
+  <Target Name="Make">
+    <CallTarget Targets="dzBdsIdeScriptInterfaces:Make;dzBdsIdeScript:Make;dzBdsIdeScript_DWS2:Make" />
+  </Target>
+</Project>
\ No newline at end of file

Added: utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dpk	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dpk	2007-05-06 14:47:58 UTC (rev 145)
@@ -0,0 +1,36 @@
+package dzBdsIdeScriptInterfaces;
+
+{$R *.res}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'dummzeuch.de - interfaces for dzBdsIdeScript'}
+{$LIBSUFFIX '100'}
+{$RUNONLY}
+{$IMPLICITBUILD OFF}
+
+requires
+  rtl;
+
+contains
+  de.dummzeuch.ScriptHandler.Manager in 'src\de.dummzeuch.ScriptHandler.Manager.pas';
+
+end.

Added: utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dproj	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dproj	2007-05-06 14:47:58 UTC (rev 145)
@@ -0,0 +1,37 @@
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{1ca8af38-c375-4146-9045-b06a869ae28d}</ProjectGuid>
+    <MainSource>dzBdsIdeScriptInterfaces.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dzBdsIdeScriptInterfaces100.bpl</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DcuOutput>dcu</DCC_DcuOutput>
+    <DCC_ObjOutput>dcu</DCC_ObjOutput>
+    <DCC_HppOutput>dcu</DCC_HppOutput>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">False</Package_Options><Package_Options Name="RuntimeOnly">True</Package_Options><Package_Options Name="PackageDescription">dummzeuch.de - interfaces for dzBdsIdeScript</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">1.1</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo>!
 <VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">2057</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Source><Source Name="MainSource">dzBdsIdeScriptInterfaces.dpk</Source></Source></Delphi.!
 Personality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+  <ItemGroup>
+    <DelphiCompile Include="dzBdsIdeScriptInterfaces.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="C:\Documents and Settings\developer\rtl.dcp" />
+    <DCCReference Include="src\de.dummzeuch.ScriptHandler.Manager.pas" />
+  </ItemGroup>
+</Project>
\ No newline at end of file

Added: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk	2007-05-06 14:47:58 UTC (rev 145)
@@ -0,0 +1,41 @@
+package dzBdsIdeScript_DWS2;
+
+{$R *.res}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'dummzeuch.de - BDS IDE scripting using Delphi Web Script 2'}
+{$LIBSUFFIX '100'}
+{$DESIGNONLY}
+{$IMPLICITBUILD OFF}
+
+requires
+  rtl,
+  dws2VCLRuntime,
+  dws2Runtime,
+  dws2ClassesLibrary,
+  dzBdsIdeScriptInterfaces;
+
+contains
+  de.dummzeuch.ScriptHandler.DWS2 in 'src\de.dummzeuch.ScriptHandler.DWS2.pas';
+
+end.
+

Added: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj	2007-05-06 14:47:58 UTC (rev 145)
@@ -0,0 +1,40 @@
+?<?xml version="1.0" encoding="utf-8"?>
+<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{5606ee84-b6ae-4659-8779-dc746861e8b7}</ProjectGuid>
+    <MainSource>dzBdsIdeScript_DWS2.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dzBdsIdeScript_DWS2100.bpl</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">1.1</Package_Options>  <Package_Options Name="PackageDescription">dummzeuch.de - BDS IDE scripting using Delphi Web Script 2</Package_Options>
+    </Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">2057</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademar!
 ks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Source><Source Name="MainSource">dzBdsIdeScript_DWS2.dpk</Source></Source></Delphi.Personality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+  <ItemGroup>
+    <DelphiCompile Include="dzBdsIdeScript_DWS2.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="C:\Documents and Settings\developer\dws2ClassesLibrary.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dws2Runtime.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dws2VCLRuntime.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\dzBdsIdeScriptInterfaces.dcp" />
+    <DCCReference Include="C:\Documents and Settings\developer\rtl.dcp" />
+    <DCCReference Include="src\de.dummzeuch.ScriptHandler.DWS2.pas" />
+  </ItemGroup>
+</Project>
\ No newline at end of file


Property changes on: utilities/dzBdsIdeScript/trunk/src
___________________________________________________________________
Name: svn:ignore
   + de.dummzeuch.experts.BaseExpert.dcu
*.dcu


Added: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.ScriptHandler.DWS2.pas
===================================================================
--- utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.ScriptHandler.DWS2.pas	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.ScriptHandler.DWS2.pas	2007-05-06 14:47:58 UTC (rev 145)
@@ -0,0 +1,214 @@
+unit de.dummzeuch.ScriptHandler.DWS2;
+
+interface
+
+uses
+  SysUtils,
+  Classes,
+  dws2Comp,
+  dws2Exprs,
+  dws2StringFunctions,
+  dws2FileFunctions,
+  dws2ClassesLibModule,
+  de.dummzeuch.ScriptHandler.Manager;
+
+type
+  TScriptHandlerDWS2 = class(TInterfacedObject, IScriptHandler)
+  private
+    dws_Main: TDelphiWebScriptII;
+    dws2Unit: Tdws2Unit;
+    dws2FileFunctions: Tdws2FileFunctions;
+    FTextAccess: IEditorTextAccess;
+    {: compiles the source and returns an executable TProgram }
+    function Compile(const _Source: string): TProgram;
+    {: registers the IdeEditorXxxx scripting functions for accessing the editor text }
+    procedure RegisterOTAFunctions;
+  private // event functions called from the script
+    {: implements the script function IdeEditorGetSelectedText }
+    procedure OnIdeEditorGetSelectedTextEval(_Info: TProgramInfo; _ExtObject: TObject);
+    {: implements the script function IdeEditorSetSelectedText }
+    procedure OnIdeEditorSetSelectedTextEval(_Info: TProgramInfo; _ExtObject: TObject);
+    {: implements the script function IdeEditorInsertText }
+    procedure OnIdeEditorInsertTextEval(_Info: TProgramInfo; _ExtObject: TObject);
+  private // implementation of IScriptHandler
+    {: @returns '.dws' }
+    function GetScriptExtension: string;
+    {: @returns 'Delphi Web Script II' }
+    function GetName: string;
+    {: executes the script stored in the TStrings }
+    procedure Execute(_TextAccess: IEditorTextAccess; _Output: IMessageOutput;
+      _Code: TStrings);
+  public
+    constructor Create;
+    destructor Destroy; override;
+  end;
+
+implementation
+
+uses
+  dws2Compiler,
+  dws2Symbols;
+
+const
+  DWS_SCRIPT_EXTENSION = '.dws';
+  DWS_SCRIPT_NAME = 'Delphi Web Script II';
+
+
+{ TScriptHandler }
+
+constructor TScriptHandlerDWS2.Create;
+begin
+  inherited Create;
+
+  dws_Main := TDelphiWebScriptII.Create(nil);
+  with dws_Main do begin
+    Name := 'dws_Main';
+    Config.CompilerOptions := [];
+    Config.MaxDataSize := 0;
+    Config.Timeout := 0;
+  end;
+
+  dws2ClassesLib := Tdws2ClassesLib.Create(nil);
+  with dws2ClassesLib do
+    Script := dws_Main;
+
+  dws2Unit := Tdws2Unit.Create(nil);
+  with dws2Unit do begin
+    Name := 'dws2Unit';
+    Dependencies.Clear;
+    Dependencies.Add('Classes');
+    UnitName := 'dzIdeEditor';
+    StaticSymbols := False;
+    Script := dws_Main;
+  end;
+
+  dws2FileFunctions := Tdws2FileFunctions.Create(nil);
+  with dws2FileFunctions do begin
+    Name := 'dws2FileFunctions';
+  end;
+
+  RegisterOTAFunctions;
+end;
+
+destructor TScriptHandlerDWS2.Destroy;
+begin
+  dws2Unit.Free;
+  dws_Main.Free;
+  inherited;
+end;
+
+function TScriptHandlerDWS2.Compile(const _Source: string): TProgram;
+var
+  i: Integer;
+  err: string;
+begin
+  Result := dws_Main.Compile(_Source);
+  if Result.Msgs.HasCompilerErrors then begin
+    err := '';
+    for i := 0 to Result.Msgs.Count - 1 do begin
+      if err <> '' then
+        err := err + #13#10;
+      err := err + Result.Msgs[i].asInfo;
+    end;
+    Result.Free;
+    raise Exception.Create(err);
+  end;
+end;
+
+procedure TScriptHandlerDWS2.Execute(_TextAccess: IEditorTextAccess; _Output: IMessageOutput;
+  _Code: TStrings);
+var
+  i: Integer;
+  Prog: TProgram;
+begin
+  FTextAccess := _TextAccess;
+//  Msg := GetMsgWindow(MESSAGE_WINDOW_TITLE);
+  _Output.Write('Compiling script.');
+  try
+    Prog := Compile(_Code.Text);
+  except
+    on e: Exception do begin
+      _Output.Write('Error compiling script:'#13#10 + e.Message, True);
+      Exit;
+    end;
+  end;
+
+  _Output.Write('Running script.');
+  try
+//    Prog.BeginProgram();
+    Prog.Execute;
+//    Prog.EndProgram;
+
+    for i := 0 to Prog.Msgs.Count - 1 do
+      _Output.Write(Prog.Msgs[i].asInfo);
+    _Output.Write(Tdws2DefaultResult(Prog.Result).Text);
+
+  finally
+    Prog.Free;
+  end;
+  _Output.Write('Done.');
+end;
+
+function TScriptHandlerDWS2.GetName: string;
+begin
+  Result := DWS_SCRIPT_NAME;
+end;
+
+function TScriptHandlerDWS2.GetScriptExtension: string;
+begin
+  Result := DWS_SCRIPT_EXTENSION;
+end;
+
+procedure TScriptHandlerDWS2.OnIdeEditorGetSelectedTextEval(_Info: TProgramInfo; _ExtObject: TObject);
+begin
+  _Info.Result := FTextAccess.GetSelectedText;
+end;
+
+procedure TScriptHandlerDWS2.OnIdeEditorInsertTextEval(_Info: TProgramInfo; _ExtObject: TObject);
+begin
+  FTextAccess.InsertText(_Info.Value['_Text']);
+end;
+
+procedure TScriptHandlerDWS2.OnIdeEditorSetSelectedTextEval(_Info: TProgramInfo; _ExtObject: TObject);
+begin
+  FTextAccess.SetSelectedText(_Info.Value['_Text']);
+end;
+
+procedure TScriptHandlerDWS2.RegisterOTAFunctions;
+var
+  Item: Tdws2Class;
+  Meth: Tdws2Method;
+  Param: Tdws2Parameter;
+begin
+  Item := dws2Unit.Classes.Add as Tdws2Class;
+  Item.Name := 'TIdeEditor';
+
+  Meth := Item.Methods.Add as Tdws2Method;
+  Meth.Name := 'GetSelectedText';
+  Meth.Kind := mkClassFunction;
+  Meth.ResultType := 'String';
+  Meth.OnEval := OnIdeEditorGetSelectedTextEval;
+
+  Meth := Item.Methods.Add as Tdws2Method;
+  Meth.Name := 'SetSelectedText';
+  Meth.Kind := mkClassProcedure;
+  Param := Meth.Parameters.Add as Tdws2Parameter;
+  Param.Name := '_Text';
+  Param.DataType := 'String';
+  Meth.OnEval := OnIdeEditorSetSelectedTextEval;
+
+  Meth := Item.Methods.Add as Tdws2Method;
+  Meth.Name := 'InsertText';
+  Meth.Kind := mkClassProcedure;
+  Param := Meth.Parameters.Add as Tdws2Parameter;
+  Param.Name := '_Text';
+  Param.DataType := 'String';
+  Meth.OnEval := OnIdeEditorInsertTextEval;
+end;
+
+initialization
+  GetScriptManager.RegisterHandler(TScriptHandlerDWS2.Create);
+finalization
+  GetScriptManager.UnregisterHandler(DWS_SCRIPT_NAME);
+end.
+

Added: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.ScriptHandler.Manager.pas
===================================================================
--- utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.ScriptHandler.Manager.pas	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.ScriptHandler.Manager.pas	2007-05-06 14:47:58 UTC (rev 145)
@@ -0,0 +1,104 @@
+unit de.dummzeuch.ScriptHandler.Manager;
+
+interface
+
+uses
+  Windows,
+  SysUtils,
+  Classes;
+
+type
+  IEditorTextAccess = interface ['{FDD3CA3C-7B2C-4E7C-B688-1F1F9E8E9D80}']
+    function GetSelectedText: string;
+    procedure SetSelectedText(const _Text: string);
+    procedure InsertText(const _Text: string);
+  end;
+
+type
+  IMessageOutput = interface ['{8A5887AD-EB2F-43AC-A120-E6B93F21A280}']
+    procedure Write(const _Msg: string; _Show: Boolean = False);
+  end;
+
+type
+  IScriptHandler = interface ['{95602CF2-2F60-4611-87B3-6493301B9747}']
+    procedure Execute(_TextAccess: IEditorTextAccess; _Output: IMessageOutput; _Script: TStrings);
+    function GetScriptExtension: string;
+    function GetName: string;
+  end;
+
+type
+  IScriptHandlerManager = interface ['{4552B47D-AE45-4D83-A34F-1C0F944B6272}']
+    procedure RegisterHandler(_ScriptHandler: IScriptHandler);
+    procedure UnregisterHandler(const _Name: string);
+    function GetHandler(const _Extension: string): IScriptHandler;
+    function GetHandlers(_Idx: integer): IScriptHandler;
+    function Count: integer;
+  end;
+
+function GetScriptManager: IScriptHandlerManager;
+
+implementation
+
+type
+  TScriptHandlerManager = class(TInterfacedObject, IScriptHandlerManager)
+  private
+    procedure RegisterHandler(_ScriptHandler: IScriptHandler);
+    procedure UnregisterHandler(const _Name: string);
+    function GetHandler(const _Extension: string): IScriptHandler;
+    function GetHandlers(_Idx: integer): IScriptHandler;
+    function Count: integer;
+  end;
+
+function GetScriptManager: IScriptHandlerManager;
+begin
+  Result := TScriptHandlerManager.Create;
+end;
+
+var
+  RegisteredHandlers: TInterfaceList;
+
+function TScriptHandlerManager.Count: integer;
+begin
+  Result := RegisteredHandlers.Count;
+end;
+
+function TScriptHandlerManager.GetHandler(const _Extension: string): IScriptHandler;
+var
+  i: Integer;
+begin
+  for i := 0 to RegisteredHandlers.Count - 1 do begin
+    Result := RegisteredHandlers[i] as IScriptHandler;
+    if AnsiSameText(Result.GetScriptExtension, _Extension) then
+      exit;
+  end;
+  Result := nil;
+end;
+
+function TScriptHandlerManager.GetHandlers(_Idx: integer): IScriptHandler;
+begin
+  Result := RegisteredHandlers[_Idx] as IScriptHandler;
+end;
+
+procedure TScriptHandlerManager.RegisterHandler(_ScriptHandler: IScriptHandler);
+begin
+  RegisteredHandlers.Add(_ScriptHandler);
+end;
+
+procedure TScriptHandlerManager.UnregisterHandler(const _Name: string);
+var
+  i: Integer;
+begin
+  for i := 0 to RegisteredHandlers.Count - 1 do begin
+    if AnsiSameText((RegisteredHandlers[i] as IScriptHandler).GetName, _Name) then begin
+      RegisteredHandlers.Delete(i);
+      exit;
+    end;
+  end;
+end;
+
+initialization
+  RegisteredHandlers := TInterfaceList.Create;
+finalization
+  RegisteredHandlers.Free;
+end.
+

Copied: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BaseExpert.dfm (from rev 143, utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.dfm)

Copied: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BaseExpert.pas (from rev 143, utilities/dzBdsIdeScript/trunk/de.dummzeuch.experts.BaseExpert.pas)

Added: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.dfm
===================================================================
--- utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.dfm	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.dfm	2007-05-06 14:47:58 UTC (rev 145)
@@ -0,0 +1,14 @@
+inherited dm_dzBdsIdeScriptExpert: Tdm_dzBdsIdeScriptExpert
+  OldCreateOrder = True
+  OnCreate = DataModuleCreate
+  OnDestroy = DataModuleDestroy
+  Height = 219
+  Width = 217
+  object TheTimer: TTimer
+    Enabled = False
+    Interval = 5000
+    OnTimer = TheTimerTimer
+    Left = 24
+    Top = 16
+  end
+end

Added: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas
===================================================================
--- utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas	2007-05-05 21:24:07 UTC (rev 144)
+++ utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas	2007-05-06 14:47:58 UTC (rev 145)
@@ -0,0 +1,272 @@
+unit de.dummzeuch.experts.BdsIdeScriptExpert.Expert;
+
+interface
+
+uses
+  Windows,
+  Messages,
+  SysUtils,
+  Classes,
+  Graphics,
+  Controls,
+  Forms,
+  Dialogs,
+  Menus,
+  ExtCtrls,
+  ToolsAPI,
+  de.dummzeuch.experts.BaseExpert,
+  de.dummzeuch.ScriptHandler.Manager;
+
+type
+  Tdm_dzBdsIdeScriptExpert = class(Tdm_DzBaseExpert, IEditorTextAccess)
+    TheTimer: TTimer;
+    procedure DataModuleCreate(Sender: TObject);
+    procedure DataModuleDestroy(Sender: TObject);
+    procedure RunScriptSubItemClick(Sender: TObject);
+    procedure RunScriptExplainClick(Sender: TObject);
+    procedure TheTimerTimer(Sender: TObject);
+  private
+    {: contains all TMenuItems created for scripts }
+    FScriptItems: TList;
+    {: contains the names of all script files }
+    FScripts: TStringList;
+    {: frees all items in the script menu and clears the FScriptItems list }
+    procedure FreeScriptMenuItems;
+    {: initializes the FScripts list of available script files }
+    procedure InitScriptList;
+    {: recreates the script menu items, called once on startup and
+       after that periodically in the TheTimeTimer event }
+    procedure RefreshMenuItems;
+    {: enables the refresh timer based on the setting in the registry }
+    procedure SetTimerRefreshing;
+//    procedure LoadScriptHandlers;
+  end;
+
+implementation
+
+{$R *.DFM}
+
+uses
+  Registry;
+
+const
+  MESSAGE_WINDOW_TITLE = 'BdsIdeScript';
+  CUSTOM_MENU_CAPTION = 'Scripts';
+  REGISTRY_BRANCH = 'dzBdsIdeScript';
+
+procedure Tdm_dzBdsIdeScriptExpert.DataModuleCreate(Sender: TObject);
+begin
+  FScriptItems := TList.Create;
+  FScripts := TStringList.Create;
+
+//  LoadScriptHandlers;
+  RefreshMenuItems;
+end;
+
+procedure Tdm_dzBdsIdeScriptExpert.DataModuleDestroy(Sender: TObject);
+begin
+  FreeScriptMenuItems;
+  DeleteDelphiCustomMenu(CUSTOM_MENU_CAPTION);
+  FScripts.Free;
+  FScriptItems.Free;
+end;
+
+procedure ListFiles(const Path: string; Strings: TStrings);
+var
+  Found: Integer;
+  SearchRec: TSearchRec;
+begin
+  Found := FindFirst(Path, faAnyFile, SearchRec);
+  while Found = 0 do begin
+    if (SearchRec.Attr and faDirectory) <> faDirectory then
+      Strings.Add(SearchRec.Name);
+    Found := FindNext(SearchRec);
+  end;
+  FindClose(SearchRec);
+end;
+
+procedure Tdm_dzBdsIdeScriptExpert.InitScriptList;
+var
+  Folder: string;
+  i: Integer;
+  Reg: TRegistry;
+  Handler: IScriptHandler;
+  HandlerIdx: Integer;
+begin
+  Reg := TRegistry.Create;
+  try
+    Reg.OpenKey(GetBaseRegistryKey + '\' + REGISTRY_BRANCH, True);
+    if not Reg.ValueExists('ScriptFolder') then
+      { Add the IDE's folder. }
+      Reg.WriteString('ScriptFolder',
+        IncludeTrailingPathDelimiter(ExtractFilePath(Application.ExeName)) + 'Scripts')
+    else
+      Folder := Reg.ReadString('ScriptFolder');
+  finally
+    Reg.Free;
+  end;
+  Folder := IncludeTrailingPathDelimiter(Folder);
+
+  FScripts.Clear;
+  for HandlerIdx := 0 to GetScriptManager.Count - 1 do begin
+    Handler := GetScriptManager.GetHandlers(HandlerIdx);
+    ListFiles(Folder + '*' + Handler.GetScriptExtension, FScripts);
+    for i := 0 to FScripts.Count - 1 do
+      FScripts[i] := Folder + FScripts[i];
+  end;
+end;
+
+//procedure Tdm_dzBdsIdeScriptExpert.LoadScriptHandlers;
+//var
+//  Packages: TStringList;
+//  Filename: string;
+//  i: Integer;
+//begin
+//  Filename := GetModuleName(hInstance);
+//  Packages := TStringList.Create;
+//  try
+//    ListFiles(ExtractFilePath(Filename) + 'dzBdsIdeScript_*.bpl.*', Packages);
+//    for i := 0 to Packages.Count - 1 do begin
+//      LoadPackage(Packages[i]);
+//    end;
+//  finally
+//    Packages.Free;
+//  end;
+//end;
+
+procedure Tdm_dzBdsIdeScriptExpert.RunScriptExplainClick(Sender: TObject);
+begin
+  ShowMessage(
+    'Scripts should be placed in the folder pointed by '#13 +
+    'the registry value at:'#13#13 +
+    'HKCU\' + GetBaseRegistryKey + '\' + REGISTRY_BRANCH +
+    #13#13'The value should be assigned to "ScriptFolder".' +
+    #13#13'You can always refresh the script list by clicking this item.'
+    );
+  RefreshMenuItems;
+end;
+
+procedure Tdm_dzBdsIdeScriptExpert.TheTimerTimer(Sender: TObject);
+begin
+  RefreshMenuItems;
+end;
+
+procedure Tdm_dzBdsIdeScriptExpert.RefreshMenuItems;
+var
+  i: Integer;
+  Item, ScriptMenu: TMenuItem;
+begin
+  ScriptMenu := GetDelphiCustomMenu(CUSTOM_MENU_CAPTION);
+  if ScriptMenu = nil then begin { The menu may not exist yet. }
+    TheTimer.Enabled := True;
+    Exit;
+  end;
+
+  InitScriptList;
+  FreeScriptMenuItems;
+
+  for i := 0 to FScripts.Count - 1 do begin
+    Item := TMenuItem.Create(nil);
+    FScriptItems.Add(Item);
+    Item.Caption := ChangeFileExt(ExtractFileName(FScripts[i]), '');
+    Item.Tag := i;
+    Item.OnClick := RunScriptSubItemClick;
+    ScriptMenu.Add(Item);
+  end;
+
+  Item := TMenuItem.Create(nil);
+  FScriptItems.Add(Item);
+  Item.Caption := '(customize)';
+  Item.OnClick := RunScriptExplainClick;
+  ScriptMenu.Add(Item);
+  SetTimerRefreshing;
+end;
+
+procedure Tdm_dzBdsIdeScriptExpert.FreeScriptMenuItems;
+var
+  i: Integer;
+begin
+  if (not Assigned(FScriptItems)) or (FScriptItems.Count = 0) then
+    Exit;
+  for i := 0 to FScriptItems.Count - 1 do
+    TMenuItem(FScriptItems[i]).Free;
+  FScriptItems.Clear;
+end;
+
+procedure Tdm_dzBdsIdeScriptExpert.SetTimerRefreshing;
+var
+  Reg: TRegistry;
+begin
+  Reg := TRegistry.Create;
+  try
+    Reg.OpenKey(GetBaseRegistryKey + '\' + REGISTRY_BRANCH + '\Options', True);
+    if Reg.ValueExists('Refresh') then begin
+      TheTimer.Enabled := Reg.ReadBool('Refresh');
+    end else begin
+      Reg.WriteBool('Refresh', True);
+      TheTimer.Enabled := True;
+    end;
+  finally
+    Reg.Free;
+  end;
+end;
+
+type
+  TMsgWindowWrapper = class(TInterfacedObject, IMessageOutput)
+  private
+    FMsgWindow: IMsgWindow;
+    procedure Write(const _Msg: string; _Show: Boolean = False);
+  public
+    constructor Create(_MsgWindow: IMsgWindow);
+  end;
+
+procedure Tdm_dzBdsIdeScriptExpert.RunScriptSubItemClick(Sender: TObject);
+var
+  Code: TStringList;
+  FileName: string;
+  Idx: Integer;
+  Msg: IMsgWindow;
+  ScriptHandler: IScriptHandler;
+begin
+  Msg := GetMsgWindow(MESSAGE_WINDOW_TITLE);
+  Msg.Clear;
+
+  Idx := (Sender as TComponent).Tag;
+  FileName := FScripts[Idx];
+  Msg.Write('Loading script ' + FileName);
+
+  ScriptHandler := GetScriptManager.GetHandler(ExtractFileExt(FileName));
+  if not Assigned(ScriptHandler) then
+    raise exception.Create('No script handler registered for that script type.');
+
+  Code := TStringList.Create;
+  try
+    Code.LoadFromFile(FileName);
+    ScriptHandler.Execute(Self, TMsgWindowWrapper.Create(GetMsgWindow(MESSAGE_WINDOW_TITLE)), Code);
+  finally
+    Code.Free;
+  end;
+end;
+
+{ TMsgWindowWrapper }
+
+constructor TMsgWindowWrapper.Create(_MsgWindow: IMsgWindow);
+begin
+  inherited Create;
+  FMsgWindow := _MsgWindow;
+end;
+
+procedure TMsgWindowWrapper.Write(const _Msg: string; _Show: Boolean);
+begin
+  FMsgWindow.Write(_Msg, _Show);
+end;
+
+var
+  Expert: Tdm_dzBdsIdeScriptExpert;
+
+initialization
+  Expert := Tdm_dzBdsIdeScriptExpert.Create(nil);
+finalization
+  Expert.Free;
+end.
+



From twm at mail.berlios.de  Thu May 17 18:46:41 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Thu, 17 May 2007 18:46:41 +0200
Subject: [Dzchart-svncheckins] r146 - in utilities/dzBdsIdeScript/trunk: .
	src
Message-ID: <200705171646.l4HGkfXS013935@sheep.berlios.de>

Author: twm
Date: 2007-05-17 18:46:27 +0200 (Thu, 17 May 2007)
New Revision: 146

Added:
   utilities/dzBdsIdeScript/trunk/DWS2.dpk
   utilities/dzBdsIdeScript/trunk/DWS2.dproj
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.dfm
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.pas
Removed:
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.bdsproj
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj
Modified:
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.groupproj
   utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dproj
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BaseExpert.pas
   utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas
Log:
added configuration dialog, everything seems to work now

Copied: utilities/dzBdsIdeScript/trunk/DWS2.dpk (from rev 145, utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk)
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/DWS2.dpk	2007-05-17 16:46:27 UTC (rev 146)
@@ -0,0 +1,42 @@
+package DWS2;
+
+{$R *.res}
+{$ALIGN 8}
+{$ASSERTIONS ON}
+{$BOOLEVAL OFF}
+{$DEBUGINFO ON}
+{$EXTENDEDSYNTAX ON}
+{$IMPORTEDDATA ON}
+{$IOCHECKS ON}
+{$LOCALSYMBOLS ON}
+{$LONGSTRINGS ON}
+{$OPENSTRINGS ON}
+{$OPTIMIZATION ON}
+{$OVERFLOWCHECKS OFF}
+{$RANGECHECKS OFF}
+{$REFERENCEINFO ON}
+{$SAFEDIVIDE OFF}
+{$STACKFRAMES OFF}
+{$TYPEDADDRESS OFF}
+{$VARSTRINGCHECKS ON}
+{$WRITEABLECONST OFF}
+{$MINENUMSIZE 1}
+{$IMAGEBASE $400000}
+{$DESCRIPTION 'dummzeuch.de - BDS IDE scripting using Delphi Web Script 2'}
+{$LIBSUFFIX '100'}
+{$LIBVERSION 'script'}
+{$DESIGNONLY}
+{$IMPLICITBUILD OFF}
+
+requires
+  rtl,
+  dws2VCLRuntime,
+  dws2Runtime,
+  dws2ClassesLibrary,
+  dzBdsIdeScriptInterfaces;
+
+contains
+  de.dummzeuch.ScriptHandler.DWS2 in 'src\de.dummzeuch.ScriptHandler.DWS2.pas';
+
+end.
+

Copied: utilities/dzBdsIdeScript/trunk/DWS2.dproj (from rev 145, utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj)
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/DWS2.dproj	2007-05-17 16:46:27 UTC (rev 146)
@@ -0,0 +1,39 @@
+?<?xml version="1.0" encoding="utf-8"?>
+<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <ProjectGuid>{5606ee84-b6ae-4659-8779-dc746861e8b7}</ProjectGuid>
+    <MainSource>DWS2.dpk</MainSource>
+    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
+    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
+    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
+    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\DWS2100.bpl.script</DCC_DependencyCheckOutputName>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
+    <Version>7.0</Version>
+    <DCC_DebugInformation>False</DCC_DebugInformation>
+    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
+    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
+    <DCC_Define>RELEASE</DCC_Define>
+  </PropertyGroup>
+  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
+    <Version>7.0</Version>
+  </PropertyGroup>
+  <ProjectExtensions>
+    <Borland.Personality>Delphi.Personality</Borland.Personality>
+    <Borland.ProjectType>Package</Borland.ProjectType>
+    <BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">script</Package_Options><Package_Options Name="PackageDescription">dummzeuch.de - BDS IDE scripting using Delphi Web Script 2</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">Fa!
 lse</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">2057</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Source><Source Name="MainSource">DWS2.dpk</Source></Source></Delphi.Per!
 sonality></BorlandProject></BorlandProject>
+  </ProjectExtensions>
+  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
+  <ItemGroup>
+    <DelphiCompile Include="DWS2.dpk">
+      <MainSource>MainSource</MainSource>
+    </DelphiCompile>
+    <DCCReference Include="C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dws2ClassesLibrary.dcp" />
+    <DCCReference Include="C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dws2Runtime.dcp" />
+    <DCCReference Include="C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dws2VCLRuntime.dcp" />
+    <DCCReference Include="C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dzBdsIdeScriptInterfaces.dcp" />
+    <DCCReference Include="C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\rtl.dcp" />
+    <DCCReference Include="src\de.dummzeuch.ScriptHandler.DWS2.pas" />
+  </ItemGroup>
+</Project>
\ No newline at end of file

Deleted: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.bdsproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.bdsproj	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.bdsproj	2007-05-17 16:46:27 UTC (rev 146)
@@ -1,205 +0,0 @@
-?<?xml version="1.0" encoding="utf-8"?>
-<BorlandProject>
-	<PersonalityInfo>
-		<Option>
-			<Option Name="Personality">Delphi.Personality</Option>
-			<Option Name="ProjectType">VCLApplication</Option>
-			<Option Name="Version">1.0</Option>
-			<Option Name="GUID">{1FC34ED7-A042-45E8-9DE5-424028824E9F}</Option>
-		</Option>
-	</PersonalityInfo>
-	<Delphi.Personality>
-		<Source>
-			<Source Name="MainSource">dzBdsIdeScript.dpk</Source>
-		</Source>
-		<FileVersion>
-			<FileVersion Name="Version">7.0</FileVersion>
-		</FileVersion>
-		<Compiler>
-			<Compiler Name="A">8</Compiler>
-			<Compiler Name="B">0</Compiler>
-			<Compiler Name="C">1</Compiler>
-			<Compiler Name="D">1</Compiler>
-			<Compiler Name="E">0</Compiler>
-			<Compiler Name="F">0</Compiler>
-			<Compiler Name="G">1</Compiler>
-			<Compiler Name="H">1</Compiler>
-			<Compiler Name="I">1</Compiler>
-			<Compiler Name="J">1</Compiler>
-			<Compiler Name="K">0</Compiler>
-			<Compiler Name="L">1</Compiler>
-			<Compiler Name="M">0</Compiler>
-			<Compiler Name="N">1</Compiler>
-			<Compiler Name="O">1</Compiler>
-			<Compiler Name="P">1</Compiler>
-			<Compiler Name="Q">0</Compiler>
-			<Compiler Name="R">0</Compiler>
-			<Compiler Name="S">0</Compiler>
-			<Compiler Name="T">0</Compiler>
-			<Compiler Name="U">0</Compiler>
-			<Compiler Name="V">1</Compiler>
-			<Compiler Name="W">0</Compiler>
-			<Compiler Name="X">1</Compiler>
-			<Compiler Name="Y">1</Compiler>
-			<Compiler Name="Z">1</Compiler>
-			<Compiler Name="ShowHints">True</Compiler>
-			<Compiler Name="ShowWarnings">True</Compiler>
-			<Compiler Name="UnitAliases">WinTypes=Windows;WinProcs=Windows;DbiTypes=BDE;DbiProcs=BDE;DbiErrs=BDE;</Compiler>
-			<Compiler Name="NamespacePrefix"></Compiler>
-			<Compiler Name="GenerateDocumentation">False</Compiler>
-			<Compiler Name="DefaultNamespace"></Compiler>
-			<Compiler Name="SymbolDeprecated">True</Compiler>
-			<Compiler Name="SymbolLibrary">True</Compiler>
-			<Compiler Name="SymbolPlatform">True</Compiler>
-			<Compiler Name="SymbolExperimental">True</Compiler>
-			<Compiler Name="UnitLibrary">True</Compiler>
-			<Compiler Name="UnitPlatform">True</Compiler>
-			<Compiler Name="UnitDeprecated">True</Compiler>
-			<Compiler Name="UnitExperimental">True</Compiler>
-			<Compiler Name="HResultCompat">True</Compiler>
-			<Compiler Name="HidingMember">True</Compiler>
-			<Compiler Name="HiddenVirtual">True</Compiler>
-			<Compiler Name="Garbage">True</Compiler>
-			<Compiler Name="BoundsError">True</Compiler>
-			<Compiler Name="ZeroNilCompat">True</Compiler>
-			<Compiler Name="StringConstTruncated">True</Compiler>
-			<Compiler Name="ForLoopVarVarPar">True</Compiler>
-			<Compiler Name="TypedConstVarPar">True</Compiler>
-			<Compiler Name="AsgToTypedConst">True</Compiler>
-			<Compiler Name="CaseLabelRange">True</Compiler>
-			<Compiler Name="ForVariable">True</Compiler>
-			<Compiler Name="ConstructingAbstract">True</Compiler>
-			<Compiler Name="ComparisonFalse">True</Compiler>
-			<Compiler Name="ComparisonTrue">True</Compiler>
-			<Compiler Name="ComparingSignedUnsigned">True</Compiler>
-			<Compiler Name="CombiningSignedUnsigned">True</Compiler>
-			<Compiler Name="UnsupportedConstruct">True</Compiler>
-			<Compiler Name="FileOpen">True</Compiler>
-			<Compiler Name="FileOpenUnitSrc">True</Compiler>
-			<Compiler Name="BadGlobalSymbol">True</Compiler>
-			<Compiler Name="DuplicateConstructorDestructor">True</Compiler>
-			<Compiler Name="InvalidDirective">True</Compiler>
-			<Compiler Name="PackageNoLink">True</Compiler>
-			<Compiler Name="PackageThreadVar">True</Compiler>
-			<Compiler Name="ImplicitImport">True</Compiler>
-			<Compiler Name="HPPEMITIgnored">True</Compiler>
-			<Compiler Name="NoRetVal">True</Compiler>
-			<Compiler Name="UseBeforeDef">True</Compiler>
-			<Compiler Name="ForLoopVarUndef">True</Compiler>
-			<Compiler Name="UnitNameMismatch">True</Compiler>
-			<Compiler Name="NoCFGFileFound">True</Compiler>
-			<Compiler Name="ImplicitVariants">True</Compiler>
-			<Compiler Name="UnicodeToLocale">True</Compiler>
-			<Compiler Name="LocaleToUnicode">True</Compiler>
-			<Compiler Name="ImagebaseMultiple">True</Compiler>
-			<Compiler Name="SuspiciousTypecast">True</Compiler>
-			<Compiler Name="PrivatePropAccessor">True</Compiler>
-			<Compiler Name="UnsafeType">False</Compiler>
-			<Compiler Name="UnsafeCode">False</Compiler>
-			<Compiler Name="UnsafeCast">False</Compiler>
-			<Compiler Name="OptionTruncated">True</Compiler>
-			<Compiler Name="WideCharReduced">True</Compiler>
-			<Compiler Name="DuplicatesIgnored">True</Compiler>
-			<Compiler Name="UnitInitSeq">True</Compiler>
-			<Compiler Name="LocalPInvoke">True</Compiler>
-			<Compiler Name="MessageDirective">True</Compiler>
-			<Compiler Name="CodePage"></Compiler>
-		</Compiler>
-		<Linker>
-			<Linker Name="MapFile">0</Linker>
-			<Linker Name="OutputObjs">0</Linker>
-			<Linker Name="GenerateHpps">False</Linker>
-			<Linker Name="ConsoleApp">1</Linker>
-			<Linker Name="DebugInfo">False</Linker>
-			<Linker Name="RemoteSymbols">False</Linker>
-			<Linker Name="GenerateDRC">False</Linker>
-			<Linker Name="MinStackSize">16384</Linker>
-			<Linker Name="MaxStackSize">1048576</Linker>
-			<Linker Name="ImageBase">4194304</Linker>
-			<Linker Name="ExeDescription">BDS IDE Scripting using Delphi Web Script II</Linker>
-		</Linker>
-		<Directories>
-			<Directories Name="OutputDir"></Directories>
-			<Directories Name="UnitOutputDir"></Directories>
-			<Directories Name="PackageDLLOutputDir"></Directories>
-			<Directories Name="PackageDCPOutputDir"></Directories>
-			<Directories Name="SearchPath"></Directories>
-			<Directories Name="Packages"></Directories>
-			<Directories Name="Conditionals"></Directories>
-			<Directories Name="DebugSourceDirs">D:\source\berlios.BdsIdeScript\dws2\Source\</Directories>
-			<Directories Name="UsePackages">False</Directories>
-		</Directories>
-		<Parameters>
-			<Parameters Name="RunParams"></Parameters>
-			<Parameters Name="HostApplication">$(BDS)\Bin\bds.exe</Parameters>
-			<Parameters Name="Launcher"></Parameters>
-			<Parameters Name="UseLauncher">False</Parameters>
-			<Parameters Name="DebugCWD"></Parameters>
-			<Parameters Name="Debug Symbols Search Path"></Parameters>
-			<Parameters Name="LoadAllSymbols">True</Parameters>
-			<Parameters Name="LoadUnspecifiedSymbols">False</Parameters>
-		</Parameters>
-		<Language>
-			<Language Name="ActiveLang"></Language>
-			<Language Name="ProjectLang">$00000000</Language>
-			<Language Name="RootDir"></Language>
-		</Language>
-		<VersionInfo>
-			<VersionInfo Name="IncludeVerInfo">True</VersionInfo>
-			<VersionInfo Name="AutoIncBuild">False</VersionInfo>
-			<VersionInfo Name="MajorVer">1</VersionInfo>
-			<VersionInfo Name="MinorVer">0</VersionInfo>
-			<VersionInfo Name="Release">0</VersionInfo>
-			<VersionInfo Name="Build">0</VersionInfo>
-			<VersionInfo Name="Debug">False</VersionInfo>
-			<VersionInfo Name="PreRelease">False</VersionInfo>
-			<VersionInfo Name="Special">False</VersionInfo>
-			<VersionInfo Name="Private">False</VersionInfo>
-			<VersionInfo Name="DLL">False</VersionInfo>
-			<VersionInfo Name="Locale">1033</VersionInfo>
-			<VersionInfo Name="CodePage">1252</VersionInfo>
-		</VersionInfo>
-		<VersionInfoKeys>
-			<VersionInfoKeys Name="CompanyName"></VersionInfoKeys>
-			<VersionInfoKeys Name="FileDescription"></VersionInfoKeys>
-			<VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys>
-			<VersionInfoKeys Name="InternalName"></VersionInfoKeys>
-			<VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys>
-			<VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys>
-			<VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys>
-			<VersionInfoKeys Name="ProductName"></VersionInfoKeys>
-			<VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys>
-			<VersionInfoKeys Name="Comments"></VersionInfoKeys>
-		</VersionInfoKeys>  
-    
-    
-    
-    <Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\dzBdsIdeScript100.bpl.1.0">BDS IDE Scripting using Delphi Web Script II</Excluded_Packages>
-      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclie100.bpl">Internet Explorer Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvAppFrmD10D.bpl">JVCL Application and Form Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvBDED10D.bpl">JVCL BDE Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCmpD10D.bpl">JVCL Non-Visual Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCryptD10D.bpl">JVCL Encryption and Compression</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvCustomD10D.bpl">JVCL Custom Controls</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDockingD10D.bpl">JVCL Docking Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvDotNetCtrlsD10D.bpl">JVCL DotNet Controls</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvEDID10D.bpl">JVCL EDI Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvGlobusD10D.bpl">JVCL Globus Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvHMID10D.bpl">JVCL HMI Controls</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvInterpreterD10D.bpl">JVCL Interpreter Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvJansD10D.bpl">JVCL Jans Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvManagedThreadsD10D.bpl">JVCL Managed Threads</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvNetD10D.bpl">JVCL Network Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvPrintPreviewD10D.bpl">JVCL Print Preview Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvRuntimeDesignD10D.bpl">JVCL Runtime Design Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvTimeFrameworkD10D.bpl">JVCL Time Framework</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvUIBD10D.bpl">JVCL Unified Interbase Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvValidatorsD10D.bpl">JVCL Validators and Error Provider Components</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvWizardD10D.bpl">JVCL Wizard</Excluded_Packages>
-      <Excluded_Packages Name="C:\Documents and Settings\developer\My Documents\Borland Studio Projects\Bpl\JvXPCtrlsD10D.bpl">JVCL XP Controls</Excluded_Packages>
-      <Excluded_Packages Name="c:\program files\borland\bds\4.0\Bin\dclIndyProtocols100.bpl">Indy 10 Protocols Design Time</Excluded_Packages>
-    </Excluded_Packages>
-  </Delphi.Personality>
-	<ModelSupport>True</ModelSupport>
-</BorlandProject>

Modified: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dpk	2007-05-17 16:46:27 UTC (rev 146)
@@ -37,6 +37,7 @@
 
 contains
   de.dummzeuch.experts.BdsIdeScriptExpert.Expert in 'src\de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas' {dm_dzBdsIdeScriptExpert: TDataModule},
-  de.dummzeuch.experts.BaseExpert in 'src\de.dummzeuch.experts.BaseExpert.pas' {dm_DzBaseExpert: TDataModule};
+  de.dummzeuch.experts.BaseExpert in 'src\de.dummzeuch.experts.BaseExpert.pas' {dm_DzBaseExpert: TDataModule},
+  de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm in 'src\de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.pas' {f_ConfigForm};
 
 end.

Modified: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.dproj	2007-05-17 16:46:27 UTC (rev 146)
@@ -19,12 +19,14 @@
   <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
     <Version>7.0</Version>
     <DCC_WriteableConstants>True</DCC_WriteableConstants>
+    <DCC_SYMBOL_PLATFORM>False</DCC_SYMBOL_PLATFORM>
+    <DCC_UNIT_PLATFORM>False</DCC_UNIT_PLATFORM>
   </PropertyGroup>
   <ProjectExtensions>
     <Borland.Personality>Delphi.Personality</Borland.Personality>
     <Borland.ProjectType>Package</Borland.ProjectType>
     <BorlandProject>
-<BorlandProject><Delphi.Personality><Parameters><Parameters Name="HostApplication">$(BDS)\Bin\bds.exe</Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="PackageDescription">dummzeuch.de - BDS IDE Scripting Expert</Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">1.1</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build"!
 >0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1033</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Excluded_Packages></Exclude!
 d_Packages><Source><Source Name="MainSource">dzBdsIdeScript.dp!
 k</Sourc
e></Source></Delphi.Personality></BorlandProject></BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="HostApplication">$(BDS)\Bin\bds.exe</Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="PackageDescription">dummzeuch.de - BDS IDE Scripting Expert</Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">False</Version!
 Info><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1033</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Excluded_Packages /><Source><Source Name="MainSource">dzBdsIdeScript.dpk</Source></!
 Source></Delphi.Personality></BorlandProject></BorlandProject>
   </ProjectExtensions>
   <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
   <ItemGroup>
@@ -40,6 +42,9 @@
     <DCCReference Include="src\de.dummzeuch.experts.BaseExpert.pas">
       <Form>dm_DzBaseExpert</Form>
     </DCCReference>
+    <DCCReference Include="src\de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.pas">
+      <Form>f_ConfigForm</Form>
+    </DCCReference>
     <DCCReference Include="src\de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas">
       <Form>dm_dzBdsIdeScriptExpert</Form>
     </DCCReference>

Modified: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.groupproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.groupproj	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript.groupproj	2007-05-17 16:46:27 UTC (rev 146)
@@ -28,22 +28,22 @@
   <Target Name="dzBdsIdeScript:Make">
     <MSBuild Projects="dzBdsIdeScript.dproj" Targets="Make" />
   </Target>
-  <Target Name="dzBdsIdeScript_DWS2">
-    <MSBuild Projects="dzBdsIdeScript_DWS2.dproj" Targets="" />
+  <Target Name="DWS2">
+    <MSBuild Projects="DWS2.dproj" Targets="" />
   </Target>
-  <Target Name="dzBdsIdeScript_DWS2:Clean">
-    <MSBuild Projects="dzBdsIdeScript_DWS2.dproj" Targets="Clean" />
+  <Target Name="DWS2:Clean">
+    <MSBuild Projects="DWS2.dproj" Targets="Clean" />
   </Target>
-  <Target Name="dzBdsIdeScript_DWS2:Make">
-    <MSBuild Projects="dzBdsIdeScript_DWS2.dproj" Targets="Make" />
+  <Target Name="DWS2:Make">
+    <MSBuild Projects="DWS2.dproj" Targets="Make" />
   </Target>
   <Target Name="Build">
-    <CallTarget Targets="dzBdsIdeScriptInterfaces;dzBdsIdeScript;dzBdsIdeScript_DWS2" />
+    <CallTarget Targets="dzBdsIdeScriptInterfaces;dzBdsIdeScript;DWS2" />
   </Target>
   <Target Name="Clean">
-    <CallTarget Targets="dzBdsIdeScriptInterfaces:Clean;dzBdsIdeScript:Clean;dzBdsIdeScript_DWS2:Clean" />
+    <CallTarget Targets="dzBdsIdeScriptInterfaces:Clean;dzBdsIdeScript:Clean;DWS2:Clean" />
   </Target>
   <Target Name="Make">
-    <CallTarget Targets="dzBdsIdeScriptInterfaces:Make;dzBdsIdeScript:Make;dzBdsIdeScript_DWS2:Make" />
+    <CallTarget Targets="dzBdsIdeScriptInterfaces:Make;dzBdsIdeScript:Make;DWS2:Make" />
   </Target>
 </Project>
\ No newline at end of file

Modified: utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dproj	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScriptInterfaces.dproj	2007-05-17 16:46:27 UTC (rev 146)
@@ -24,14 +24,14 @@
     <Borland.Personality>Delphi.Personality</Borland.Personality>
     <Borland.ProjectType>Package</Borland.ProjectType>
     <BorlandProject>
-<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">False</Package_Options><Package_Options Name="RuntimeOnly">True</Package_Options><Package_Options Name="PackageDescription">dummzeuch.de - interfaces for dzBdsIdeScript</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">1.1</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo>!
 <VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">2057</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Source><Source Name="MainSource">dzBdsIdeScriptInterfaces.dpk</Source></Source></Delphi.!
 Personality></BorlandProject></BorlandProject>
+<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">False</Package_Options><Package_Options Name="RuntimeOnly">True</Package_Options><Package_Options Name="PackageDescription">dummzeuch.de - interfaces for dzBdsIdeScript</Package_Options><Package_Options Name="LibSuffix">100</Package_Options></Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><Versi!
 onInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">2057</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Source><Source Name="MainSource">dzBdsIdeScriptInterfaces.dpk</Source></Source></Delphi.Personality></BorlandProject></BorlandProject>
   </ProjectExtensions>
   <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
   <ItemGroup>
     <DelphiCompile Include="dzBdsIdeScriptInterfaces.dpk">
       <MainSource>MainSource</MainSource>
     </DelphiCompile>
-    <DCCReference Include="C:\Documents and Settings\developer\rtl.dcp" />
+    <DCCReference Include="C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\rtl.dcp" />
     <DCCReference Include="src\de.dummzeuch.ScriptHandler.Manager.pas" />
   </ItemGroup>
 </Project>
\ No newline at end of file

Deleted: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dpk	2007-05-17 16:46:27 UTC (rev 146)
@@ -1,41 +0,0 @@
-package dzBdsIdeScript_DWS2;
-
-{$R *.res}
-{$ALIGN 8}
-{$ASSERTIONS ON}
-{$BOOLEVAL OFF}
-{$DEBUGINFO ON}
-{$EXTENDEDSYNTAX ON}
-{$IMPORTEDDATA ON}
-{$IOCHECKS ON}
-{$LOCALSYMBOLS ON}
-{$LONGSTRINGS ON}
-{$OPENSTRINGS ON}
-{$OPTIMIZATION ON}
-{$OVERFLOWCHECKS OFF}
-{$RANGECHECKS OFF}
-{$REFERENCEINFO ON}
-{$SAFEDIVIDE OFF}
-{$STACKFRAMES OFF}
-{$TYPEDADDRESS OFF}
-{$VARSTRINGCHECKS ON}
-{$WRITEABLECONST OFF}
-{$MINENUMSIZE 1}
-{$IMAGEBASE $400000}
-{$DESCRIPTION 'dummzeuch.de - BDS IDE scripting using Delphi Web Script 2'}
-{$LIBSUFFIX '100'}
-{$DESIGNONLY}
-{$IMPLICITBUILD OFF}
-
-requires
-  rtl,
-  dws2VCLRuntime,
-  dws2Runtime,
-  dws2ClassesLibrary,
-  dzBdsIdeScriptInterfaces;
-
-contains
-  de.dummzeuch.ScriptHandler.DWS2 in 'src\de.dummzeuch.ScriptHandler.DWS2.pas';
-
-end.
-

Deleted: utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj
===================================================================
--- utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/dzBdsIdeScript_DWS2.dproj	2007-05-17 16:46:27 UTC (rev 146)
@@ -1,40 +0,0 @@
-?<?xml version="1.0" encoding="utf-8"?>
-<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
-  <PropertyGroup>
-    <ProjectGuid>{5606ee84-b6ae-4659-8779-dc746861e8b7}</ProjectGuid>
-    <MainSource>dzBdsIdeScript_DWS2.dpk</MainSource>
-    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
-    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
-    <DCC_DCCCompiler>DCC32</DCC_DCCCompiler>
-    <DCC_DependencyCheckOutputName>C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Bpl\dzBdsIdeScript_DWS2100.bpl</DCC_DependencyCheckOutputName>
-  </PropertyGroup>
-  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
-    <Version>7.0</Version>
-    <DCC_DebugInformation>False</DCC_DebugInformation>
-    <DCC_LocalDebugSymbols>False</DCC_LocalDebugSymbols>
-    <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
-    <DCC_Define>RELEASE</DCC_Define>
-  </PropertyGroup>
-  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
-    <Version>7.0</Version>
-  </PropertyGroup>
-  <ProjectExtensions>
-    <Borland.Personality>Delphi.Personality</Borland.Personality>
-    <Borland.ProjectType>Package</Borland.ProjectType>
-    <BorlandProject>
-<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><Package_Options><Package_Options Name="ImplicitBuild">False</Package_Options><Package_Options Name="DesigntimeOnly">True</Package_Options><Package_Options Name="RuntimeOnly">False</Package_Options><Package_Options Name="LibSuffix">100</Package_Options><Package_Options Name="LibVersion">1.1</Package_Options>  <Package_Options Name="PackageDescription">dummzeuch.de - BDS IDE scripting using Delphi Web Script 2</Package_Options>
-    </Package_Options><VersionInfo><VersionInfo Name="IncludeVerInfo">True</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">2057</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademar!
 ks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Source><Source Name="MainSource">dzBdsIdeScript_DWS2.dpk</Source></Source></Delphi.Personality></BorlandProject></BorlandProject>
-  </ProjectExtensions>
-  <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
-  <ItemGroup>
-    <DelphiCompile Include="dzBdsIdeScript_DWS2.dpk">
-      <MainSource>MainSource</MainSource>
-    </DelphiCompile>
-    <DCCReference Include="C:\Documents and Settings\developer\dws2ClassesLibrary.dcp" />
-    <DCCReference Include="C:\Documents and Settings\developer\dws2Runtime.dcp" />
-    <DCCReference Include="C:\Documents and Settings\developer\dws2VCLRuntime.dcp" />
-    <DCCReference Include="C:\Documents and Settings\developer\dzBdsIdeScriptInterfaces.dcp" />
-    <DCCReference Include="C:\Documents and Settings\developer\rtl.dcp" />
-    <DCCReference Include="src\de.dummzeuch.ScriptHandler.DWS2.pas" />
-  </ItemGroup>
-</Project>
\ No newline at end of file

Modified: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BaseExpert.pas
===================================================================
--- utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BaseExpert.pas	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BaseExpert.pas	2007-05-17 16:46:27 UTC (rev 146)
@@ -24,6 +24,13 @@
     function GetDelphiCustomMenu(const _Caption: string): TMenuItem;
     function TryGetDelphiCustomMenu(const _Caption: string; out _Item: TMenuItem): Boolean;
     procedure DeleteDelphiCustomMenu(const _Caption: string);
+    procedure WriteRegistryString(const _SubBranch, _Entry, _Value: string);
+  protected
+    procedure WriteRegistryStringList(const _SubBranch, _ListBranch: string; _Values: TStrings);
+    function ReadRegistryString(const _SubBranch, _Entry: string): string;
+    procedure ReadRegistryStringList(const _SubBranch, _ListBranch: string;
+      _Values: TStrings);
+  protected // methods for accessing the current editor window
     function GetSelectedText: string;
     function GetSourceEditor: IOTASourceEditor;
     procedure InsertText(const _Text: string);
@@ -34,6 +41,13 @@
 
 {$R *.dfm}
 
+uses
+  Registry;
+
+const
+  REGISTRY_ENGINES_COUNT = 'Count';
+  REGISTRY_ENGINES_ITEMS_D = 'Item%d';
+
 type
   TMsgWindow = class(TInterfacedObject, IMsgWindow)
   private
@@ -119,7 +133,8 @@
 begin
   Result := nil;
   CurrMod := (BorlandIDEServices as IOTAModuleServices).CurrentModule;
-  if not Assigned(CurrMod) then Exit;
+  if not Assigned(CurrMod) then
+    Exit;
   for i := 0 to CurrMod.GetModuleFileCount - 1 do
     if CurrMod.GetModuleFileEditor(i).QueryInterface(IOTASourceEditor, Result) = S_OK then
       Exit;
@@ -200,6 +215,80 @@
   Result := Assigned(_Item);
 end;
 
+function Tdm_DzBaseExpert.ReadRegistryString(const _SubBranch, _Entry: string): string;
+var
+  Reg: TRegistry;
+begin
+  Result := '';
+  Reg := TRegistry.Create;
+  try
+    if not Reg.OpenKeyReadOnly(GetBaseRegistryKey + '\' + _SubBranch) then
+      exit;
+    if Reg.ValueExists(_Entry) then
+      Result := Reg.ReadString(_Entry);
+    Reg.CloseKey;
+  finally
+    Reg.Free;
+  end;
+end;
+
+procedure Tdm_DzBaseExpert.WriteRegistryString(const _SubBranch, _Entry, _Value: string);
+var
+  Reg: TRegistry;
+begin
+  Reg := TRegistry.Create;
+  try
+    if not Reg.OpenKey(GetBaseRegistryKey + '\' + _SubBranch, True) then
+      raise exception.Create('could not open registry branch');
+    Reg.WriteString(_Entry, _Value);
+    Reg.CloseKey;
+  finally
+    Reg.Free;
+  end;
+end;
+
+procedure Tdm_DzBaseExpert.ReadRegistryStringList(const _SubBranch, _ListBranch: string; _Values: TStrings);
+var
+  Reg: TRegistry;
+  i: Integer;
+  cnt: Integer;
+begin
+  _Values.Clear;
+  Reg := TRegistry.Create;
+  try
+    if not Reg.OpenKeyReadOnly(GetBaseRegistryKey + '\' + _SubBranch + '\' + _ListBranch) then
+      exit;
+    if Reg.ValueExists(REGISTRY_ENGINES_COUNT) then begin
+      cnt := Reg.ReadInteger(REGISTRY_ENGINES_COUNT);
+      for i := 0 to cnt - 1 do begin
+        if Reg.ValueExists(Format(REGISTRY_ENGINES_ITEMS_D, [i])) then
+          _Values.Add(Reg.ReadString(Format(REGISTRY_ENGINES_ITEMS_D, [i])));
+      end;
+    end;
+    Reg.CloseKey;
+  finally
+    Reg.Free;
+  end;
+end;
+
+procedure Tdm_DzBaseExpert.WriteRegistryStringList(const _SubBranch, _ListBranch: string; _Values: TStrings);
+var
+  Reg: TRegistry;
+  i: Integer;
+begin
+  Reg := TRegistry.Create;
+  try
+    Reg.OpenKey(GetBaseRegistryKey + '\' + _SubBranch + '\' + _ListBranch, True);
+    Reg.WriteInteger(REGISTRY_ENGINES_COUNT, _Values.Count);
+    for i := 0 to _Values.Count - 1 do begin
+      Reg.WriteString(Format(REGISTRY_ENGINES_ITEMS_D, [i]), _Values[i]);
+    end;
+    Reg.CloseKey;
+  finally
+    Reg.Free;
+  end;
+end;
+
 { TMsgWindow }
 
 procedure TMsgWindow.Clear;

Added: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.dfm
===================================================================
--- utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.dfm	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.dfm	2007-05-17 16:46:27 UTC (rev 146)
@@ -0,0 +1,111 @@
+object f_ConfigForm: Tf_ConfigForm
+  Left = 0
+  Top = 0
+  Caption = 'Configure BDS IDE Script Expert'
+  ClientHeight = 218
+  ClientWidth = 417
+  Color = clBtnFace
+  Font.Charset = DEFAULT_CHARSET
+  Font.Color = clWindowText
+  Font.Height = -11
+  Font.Name = 'Tahoma'
+  Font.Style = []
+  OldCreateOrder = False
+  Position = poScreenCenter
+  DesignSize = (
+    417
+    218)
+  PixelsPerInch = 96
+  TextHeight = 13
+  object l_ScriptsDir: TLabel
+    Left = 8
+    Top = 8
+    Width = 79
+    Height = 13
+    Caption = 'Scripts Directory'
+  end
+  object l_ScriptingEngines: TLabel
+    Left = 8
+    Top = 56
+    Width = 81
+    Height = 13
+    Caption = 'Scripting Engines'
+  end
+  object ed_ScriptsDir: TEdit
+    Left = 8
+    Top = 24
+    Width = 369
+    Height = 21
+    Anchors = [akLeft, akTop, akRight]
+    TabOrder = 0
+  end
+  object b_ScriptsDir: TButton
+    Left = 384
+    Top = 22
+    Width = 27
+    Height = 25
+    Anchors = [akTop, akRight]
+    Caption = '&...'
+    TabOrder = 1
+    OnClick = b_ScriptsDirClick
+  end
+  object b_OK: TButton
+    Left = 256
+    Top = 184
+    Width = 75
+    Height = 25
+    Anchors = [akRight, akBottom]
+    Caption = 'OK'
+    Default = True
+    ModalResult = 1
+    TabOrder = 5
+  end
+  object b_Cancel: TButton
+    Left = 336
+    Top = 184
+    Width = 75
+    Height = 25
+    Anchors = [akRight, akBottom]
+    Cancel = True
+    Caption = 'Cancel'
+    ModalResult = 2
+    TabOrder = 6
+  end
+  object b_Add: TButton
+    Left = 336
+    Top = 72
+    Width = 75
+    Height = 25
+    Anchors = [akTop, akRight]
+    Caption = '&Add'
+    TabOrder = 3
+    OnClick = b_AddClick
+  end
+  object b_Delete: TButton
+    Left = 336
+    Top = 104
+    Width = 75
+    Height = 25
+    Anchors = [akTop, akRight]
+    Caption = 'Delete'
+    TabOrder = 4
+    OnClick = b_DeleteClick
+  end
+  object lb_ScriptingEngines: TListBox
+    Left = 8
+    Top = 72
+    Width = 321
+    Height = 97
+    Anchors = [akLeft, akTop, akRight, akBottom]
+    ItemHeight = 13
+    TabOrder = 2
+  end
+  object od_Select: TOpenDialog
+    Filter = 
+      'Scripting engine packages (*.bpl.script)|*.bpl.script|All Files ' +
+      '(*.*)|*.*'
+    Options = [ofHideReadOnly, ofFileMustExist, ofEnableSizing]
+    Left = 352
+    Top = 136
+  end
+end

Added: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.pas
===================================================================
--- utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.pas	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm.pas	2007-05-17 16:46:27 UTC (rev 146)
@@ -0,0 +1,103 @@
+unit de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm;
+
+interface
+
+uses
+  Windows,
+  Messages,
+  SysUtils,
+  Variants,
+  Classes,
+  Graphics,
+  Controls,
+  Forms,
+  Dialogs,
+  StdCtrls,
+  CheckLst,
+  Mask;
+
+type
+  Tf_ConfigForm = class(TForm)
+    l_ScriptsDir: TLabel;
+    ed_ScriptsDir: TEdit;
+    b_ScriptsDir: TButton;
+    b_OK: TButton;
+    b_Cancel: TButton;
+    l_ScriptingEngines: TLabel;
+    b_Add: TButton;
+    b_Delete: TButton;
+    lb_ScriptingEngines: TListBox;
+    od_Select: TOpenDialog;
+    procedure b_ScriptsDirClick(Sender: TObject);
+    procedure b_AddClick(Sender: TObject);
+    procedure b_DeleteClick(Sender: TObject);
+  private
+  public
+    class function Execute(_Owner: TComponent; var _ScriptsDir: string; _Engines: TStrings): boolean;
+  end;
+
+implementation
+
+{$R *.dfm}
+
+uses
+  FileCtrl;
+
+procedure Tf_ConfigForm.b_AddClick(Sender: TObject);
+var
+  s: string;
+  Handle: Cardinal;
+begin
+  if not od_Select.Execute then
+    exit;
+  s := od_Select.FileName;
+  Handle := LoadPackage(s);
+  lb_ScriptingEngines.Items.AddObject(s, pointer(Handle));
+end;
+
+procedure Tf_ConfigForm.b_DeleteClick(Sender: TObject);
+var
+  Idx: integer;
+  Handle: Cardinal;
+begin
+  Idx := lb_ScriptingEngines.ItemIndex;
+  if Idx = -1 then
+    exit;
+
+  Handle := Integer(lb_ScriptingEngines.Items.Objects[Idx]);
+  UnloadPackage(Handle);
+  lb_ScriptingEngines.Items.Delete(Idx);
+end;
+
+procedure Tf_ConfigForm.b_ScriptsDirClick(Sender: TObject);
+var
+  Root: WideString;
+  Dir: string;
+begin
+  Root := '';
+  Dir := ed_ScriptsDir.Text;
+  if not SelectDirectory('Select Scripts Directory', Root, Dir) then
+    exit;
+  ed_ScriptsDir.Text := Dir;
+end;
+
+class function Tf_ConfigForm.Execute(_Owner: TComponent; var _ScriptsDir: string; _Engines: TStrings): boolean;
+var
+  frm: Tf_ConfigForm;
+begin
+  frm := Tf_ConfigForm.Create(_Owner);
+  try
+    frm.ed_ScriptsDir.Text := _ScriptsDir;
+    frm.lb_ScriptingEngines.Items.Assign(_Engines);
+    Result := (mroK = frm.ShowModal);
+    if not Result then
+      exit;
+    _ScriptsDir := frm.ed_ScriptsDir.Text;
+    _Engines.Assign(frm.lb_ScriptingEngines.Items);
+  finally
+    frm.Free;
+  end;
+end;
+
+end.
+

Modified: utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas
===================================================================
--- utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas	2007-05-06 14:47:58 UTC (rev 145)
+++ utilities/dzBdsIdeScript/trunk/src/de.dummzeuch.experts.BdsIdeScriptExpert.Expert.pas	2007-05-17 16:46:27 UTC (rev 146)
@@ -22,24 +22,36 @@
     TheTimer: TTimer;
     procedure DataModuleCreate(Sender: TObject);
     procedure DataModuleDestroy(Sender: TObject);
-    procedure RunScriptSubItemClick(Sender: TObject);
-    procedure RunScriptExplainClick(Sender: TObject);
     procedure TheTimerTimer(Sender: TObject);
   private
     {: contains all TMenuItems created for scripts }
     FScriptItems: TList;
     {: contains the names of all script files }
     FScripts: TStringList;
+    FScriptsDir: string;
+    FEngines: TStringList;
     {: frees all items in the script menu and clears the FScriptItems list }
     procedure FreeScriptMenuItems;
     {: initializes the FScripts list of available script files }
     procedure InitScriptList;
-    {: recreates the script menu items, called once on startup and
-       after that periodically in the TheTimeTimer event }
-    procedure RefreshMenuItems;
-    {: enables the refresh timer based on the setting in the registry }
-    procedure SetTimerRefreshing;
-//    procedure LoadScriptHandlers;
+    {: creates the main menu item and assigns its OnClick event,
+       called in the constructor and after that periodically in the TheTimeTimer event }
+    procedure InitScriptMenu;
+    {: reads the configuration from the registry and loads the configured
+       scripting engines }
+    procedure ReadConfigAndLoadEngines;
+    {: writes the configuration to the registry }
+    procedure WriteConfig;
+    procedure LoadEngines;
+  private
+    {: assigned to the OnClick handler of the main menu item,
+       recreates the dropdown menu }
+    procedure MenuDropDown(_Sender: TObject);
+    {: assigned to all script menu items, calls the associated script }
+    procedure MenuScriptClick(Sender: TObject);
+    {: assigend to the configure menu item, opens the configuration dialog }
+    procedure MenuConfigClick(Sender: TObject);
+    procedure UnloadEngines;
   end;
 
 implementation
@@ -47,120 +59,135 @@
 {$R *.DFM}
 
 uses
-  Registry;
+  Registry,
+  de.dummzeuch.experts.BdsIdeScriptExpert.ConfigForm;
 
 const
   MESSAGE_WINDOW_TITLE = 'BdsIdeScript';
   CUSTOM_MENU_CAPTION = 'Scripts';
   REGISTRY_BRANCH = 'dzBdsIdeScript';
+  REGISTRY_SCRIPTSDIR_NAME = 'ScriptsDir';
+  REGISTRY_ENGINES_BRANCH = 'Engines';
 
 procedure Tdm_dzBdsIdeScriptExpert.DataModuleCreate(Sender: TObject);
 begin
   FScriptItems := TList.Create;
   FScripts := TStringList.Create;
+  FEngines := TStringList.Create;
 
-//  LoadScriptHandlers;
-  RefreshMenuItems;
+  ReadConfigAndLoadEngines;
+  InitScriptMenu;
 end;
 
 procedure Tdm_dzBdsIdeScriptExpert.DataModuleDestroy(Sender: TObject);
 begin
   FreeScriptMenuItems;
   DeleteDelphiCustomMenu(CUSTOM_MENU_CAPTION);
+  UnloadEngines;
+  FEngines.Free;
   FScripts.Free;
   FScriptItems.Free;
 end;
 
-procedure ListFiles(const Path: string; Strings: TStrings);
+procedure Tdm_dzBdsIdeScriptExpert.ReadConfigAndLoadEngines;
+begin
+  FScriptsDir := ReadRegistryString(REGISTRY_BRANCH, REGISTRY_SCRIPTSDIR_NAME);
+  ReadRegistryStringList(REGISTRY_BRANCH, REGISTRY_ENGINES_BRANCH, FEngines);
+  LoadEngines;
+end;
+
+procedure Tdm_dzBdsIdeScriptExpert.WriteConfig;
+begin
+  WriteRegistryString(REGISTRY_BRANCH, REGISTRY_SCRIPTSDIR_NAME, FScriptsDir);
+  WriteRegistryStringList(REGISTRY_BRANCH, REGISTRY_ENGINES_BRANCH, FEngines);
+end;
+
+procedure ListFiles(const _Mask: string; _Files: TStrings);
 var
   Found: Integer;
   SearchRec: TSearchRec;
 begin
-  Found := FindFirst(Path, faAnyFile, SearchRec);
-  while Found = 0 do begin
-    if (SearchRec.Attr and faDirectory) <> faDirectory then
-      Strings.Add(SearchRec.Name);
-    Found := FindNext(SearchRec);
+  Found := FindFirst(_Mask, faAnyFile, SearchRec);
+  try
+    while Found = 0 do begin
+      if (SearchRec.Attr and faDirectory) <> faDirectory then
+        _Files.Add(SearchRec.Name);
+      Found := FindNext(SearchRec);
+    end;
+  finally
+    FindClose(SearchRec);
   end;
-  FindClose(SearchRec);
 end;
 
 procedure Tdm_dzBdsIdeScriptExpert.InitScriptList;
 var
-  Folder: string;
   i: Integer;
-  Reg: TRegistry;
   Handler: IScriptHandler;
   HandlerIdx: Integer;
+  Dir: string;
 begin
-  Reg := TRegistry.Create;
-  try
-    Reg.OpenKey(GetBaseRegistryKey + '\' + REGISTRY_BRANCH, True);
-    if not Reg.ValueExists('ScriptFolder') then
-      { Add the IDE's folder. }
-      Reg.WriteString('ScriptFolder',
-        IncludeTrailingPathDelimiter(ExtractFilePath(Application.ExeName)) + 'Scripts')
-    else
-      Folder := Reg.ReadString('ScriptFolder');
-  finally
-    Reg.Free;
-  end;
-  Folder := IncludeTrailingPathDelimiter(Folder);
+  Dir := IncludeTrailingPathDelimiter(FScriptsDir);
 
   FScripts.Clear;
   for HandlerIdx := 0 to GetScriptManager.Count - 1 do begin
     Handler := GetScriptManager.GetHandlers(HandlerIdx);
-    ListFiles(Folder + '*' + Handler.GetScriptExtension, FScripts);
+    ListFiles(Dir + '*' + Handler.GetScriptExtension, FScripts);
     for i := 0 to FScripts.Count - 1 do
-      FScripts[i] := Folder + FScripts[i];
+      FScripts[i] := Dir + FScripts[i];
   end;
 end;
 
-//procedure Tdm_dzBdsIdeScriptExpert.LoadScriptHandlers;
-//var
-//  Packages: TStringList;
-//  Filename: string;
-//  i: Integer;
-//begin
-//  Filename := GetModuleName(hInstance);
-//  Packages := TStringList.Create;
-//  try
-//    ListFiles(ExtractFilePath(Filename) + 'dzBdsIdeScript_*.bpl.*', Packages);
-//    for i := 0 to Packages.Count - 1 do begin
-//      LoadPackage(Packages[i]);
-//    end;
-//  finally
-//    Packages.Free;
-//  end;
-//end;
+procedure Tdm_dzBdsIdeScriptExpert.MenuConfigClick(Sender: TObject);
+begin
+  if Tf_ConfigForm.Execute(Self, FScriptsDir, FEngines) then
+    WriteConfig;
+end;
 
-procedure Tdm_dzBdsIdeScriptExpert.RunScriptExplainClick(Sender: TObject);
+procedure Tdm_dzBdsIdeScriptExpert.LoadEngines;
+var
+  Handle: Cardinal;
+  i: Integer;
 begin
-  ShowMessage(
-    'Scripts should be placed in the folder pointed by '#13 +
-    'the registry value at:'#13#13 +
-    'HKCU\' + GetBaseRegistryKey + '\' + REGISTRY_BRANCH +
-    #13#13'The value should be assigned to "ScriptFolder".' +
-    #13#13'You can always refresh the script list by clicking this item.'
-    );
-  RefreshMenuItems;
+  for i := FEngines.Count - 1 downto 0 do begin
+    try
+      if FEngines.Objects[i] = nil then begin
+        Handle := LoadPackage(FEngines[i]);
+        FEngines.Objects[i] := Pointer(Handle);
+      end;
+    except
+      FEngines.Delete(i);
+    end;
+  end;
 end;
 
+procedure Tdm_dzBdsIdeScriptExpert.UnloadEngines;
+var
+  i: Integer;
+begin
+  for i := 0 to FEngines.Count - 1 do begin
+    if FEngines.Objects[i] <> nil then
+      try
+        UnloadPackage(Cardinal(FEngines.Objects[i]));
+        FEngines.Objects[i] := nil;
+      except
+        // ignore
+      end;
+  end;
+end;
+
 procedure Tdm_dzBdsIdeScriptExpert.TheTimerTimer(Sender: TObject);
 begin
-  RefreshMenuItems;
+  InitScriptMenu;
 end;
 
-procedure Tdm_dzBdsIdeScriptExpert.RefreshMenuItems;
+procedure Tdm_dzBdsIdeScriptExpert.MenuDropDown(_Sender: TObject);
 var
   i: Integer;
-  Item, ScriptMenu: TMenuItem;
+  Item: TMenuItem;
+  ScriptMenu: TMenuItem;
 begin
-  ScriptMenu := GetDelphiCustomMenu(CUSTOM_MENU_CAPTION);
-  if ScriptMenu = nil then begin { The menu may not exist yet. }
-    TheTimer.Enabled := True;
-    Exit;
-  end;
+  if not TryGetDelphiCustomMenu(CUSTOM_MENU_CAPTION, ScriptMenu) then
+    exit;
 
   InitScriptList;
   FreeScriptMenuItems;
@@ -170,18 +197,34 @@
     FScriptItems.Add(Item);
     Item.Caption := ChangeFileExt(ExtractFileName(FScripts[i]), '');
     Item.Tag := i;
-    Item.OnClick := RunScriptSubItemClick;
+    Item.OnClick := MenuScriptClick;
     ScriptMenu.Add(Item);
   end;
 
   Item := TMenuItem.Create(nil);
   FScriptItems.Add(Item);
-  Item.Caption := '(customize)';
-  Item.OnClick := RunScriptExplainClick;
+  Item.Caption := '-';
   ScriptMenu.Add(Item);
-  SetTimerRefreshing;
+
+  Item := TMenuItem.Create(nil);
+  FScriptItems.Add(Item);
+  Item.Caption := 'Configure ...';
+  Item.OnClick := MenuConfigClick;
+  ScriptMenu.Add(Item);
 end;
 
+procedure Tdm_dzBdsIdeScriptExpert.InitScriptMenu;
+var
+  ScriptMenu: TMenuItem;
+begin
+  ScriptMenu := GetDelphiCustomMenu(CUSTOM_MENU_CAPTION);
+  if not Assigned(ScriptMenu) then begin
+    TheTimer.Enabled := True;
+    Exit;
+  end;
+  ScriptMenu.OnClick := MenuDropDown;
+end;
+
 procedure Tdm_dzBdsIdeScriptExpert.FreeScriptMenuItems;
 var
   i: Integer;
@@ -193,24 +236,6 @@
   FScriptItems.Clear;
 end;
 
-procedure Tdm_dzBdsIdeScriptExpert.SetTimerRefreshing;
-var
-  Reg: TRegistry;
-begin
-  Reg := TRegistry.Create;
-  try
-    Reg.OpenKey(GetBaseRegistryKey + '\' + REGISTRY_BRANCH + '\Options', True);
-    if Reg.ValueExists('Refresh') then begin
-      TheTimer.Enabled := Reg.ReadBool('Refresh');
-    end else begin
-      Reg.WriteBool('Refresh', True);
-      TheTimer.Enabled := True;
-    end;
-  finally
-    Reg.Free;
-  end;
-end;
-
 type
   TMsgWindowWrapper = class(TInterfacedObject, IMessageOutput)
   private
@@ -220,7 +245,7 @@
     constructor Create(_MsgWindow: IMsgWindow);
   end;
 
-procedure Tdm_dzBdsIdeScriptExpert.RunScriptSubItemClick(Sender: TObject);
+procedure Tdm_dzBdsIdeScriptExpert.MenuScriptClick(Sender: TObject);
 var
   Code: TStringList;
   FileName: string;



From twm at mail.berlios.de  Sat May 19 19:51:37 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Sat, 19 May 2007 19:51:37 +0200
Subject: [Dzchart-svncheckins] r147 - utilities
Message-ID: <200705191751.l4JHpbtH005022@sheep.berlios.de>

Author: twm
Date: 2007-05-19 19:51:36 +0200 (Sat, 19 May 2007)
New Revision: 147

Added:
   utilities/dzLiveTemplates/
Log:
Created folder remotely



From twm at mail.berlios.de  Sat May 19 19:52:06 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Sat, 19 May 2007 19:52:06 +0200
Subject: [Dzchart-svncheckins] r148 - in utilities/dzLiveTemplates: . trunk
Message-ID: <200705191752.l4JHq6wK005061@sheep.berlios.de>

Author: twm
Date: 2007-05-19 19:52:04 +0200 (Sat, 19 May 2007)
New Revision: 148

Added:
   utilities/dzLiveTemplates/trunk/
   utilities/dzLiveTemplates/trunk/FormExecute.xml
   utilities/dzLiveTemplates/trunk/cr_live_template_integerdecl.xml
   utilities/dzLiveTemplates/trunk/cr_live_template_stringdecl.xml
   utilities/dzLiveTemplates/trunk/point.xml
   utilities/dzLiveTemplates/trunk/propfreadonly.xml
   utilities/dzLiveTemplates/trunk/propfreadwrite.xml
   utilities/dzLiveTemplates/trunk/semicolon-equals-typo.xml
Log:


Added: utilities/dzLiveTemplates/trunk/FormExecute.xml
===================================================================
--- utilities/dzLiveTemplates/trunk/FormExecute.xml	2007-05-19 17:51:36 UTC (rev 147)
+++ utilities/dzLiveTemplates/trunk/FormExecute.xml	2007-05-19 17:52:04 UTC (rev 148)
@@ -0,0 +1,51 @@
+<?xml version="1.0" encoding="utf-8" ?>
+<codetemplate	xmlns="http://schemas.borland.com/Delphi/2005/codetemplates"
+				version="1.0.0">
+	<template name="FormExecute" invoke="manual">
+		<description>
+			creates an Execute class method for a form, press Shift-Ctrl afterwards
+			to add the method declaration.
+		</description>
+		<author>
+			twm
+		</author>
+		<point name="FormClass">
+			<text>TForm</text>
+			<hint>name of the form class</hint>
+		</point>
+		<point name="Value">
+			<text>_Value</text>
+			<hint>value edited with this form</hint>
+		</point>
+		<point name="Type">
+			<text>string</text>
+			<hint>Type of value</hint>
+		</point>
+		<point name="control">
+			<text>Edit1</text>
+			<hint>control that edits the value</hint>
+		</point>
+		<point name="property">
+			<text>Text</text>
+			<hint>property of the control for editing</hint>
+		</point>
+		<code language="Delphi" delimiter="|"><![CDATA[
+class function |FormClass|.Execute(_Owner: TComponent; var |Value|: |Type|): boolean;
+var
+  frm: |FormClass|;
+begin
+  frm := |FormClass|.Create(_Owner);
+  try
+	frm.|control|.|property| := |Value|;|end|
+	Result := (frm.ShowModal = mrOK);
+	if Result then begin
+	  |Value| := frm.|control|.|property|;
+	end;
+  finally
+	frm.Free;
+  end;
+end;
+		]]>
+		</code>
+	</template>
+</codetemplate>
\ No newline at end of file

Added: utilities/dzLiveTemplates/trunk/cr_live_template_integerdecl.xml
===================================================================
--- utilities/dzLiveTemplates/trunk/cr_live_template_integerdecl.xml	2007-05-19 17:51:36 UTC (rev 147)
+++ utilities/dzLiveTemplates/trunk/cr_live_template_integerdecl.xml	2007-05-19 17:52:04 UTC (rev 148)
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8" ?>
+<codetemplate xmlns="http://schemas.borland.com/Delphi/2005/codetemplates" version="1.0.0">
+  <template name="i:" invoke="auto">
+    <description>
+      AutoComplete i: Integer declaration
+    </description>
+    <author>
+      Sebastian Modersohn / Thomas Mueller
+    </author>
+    <point name="ident" editable="false">
+      <text>i</text>
+    </point>
+    <point name="type" editable="false">
+      <text>Integer</text>
+    </point>
+    <script language="Delphi" onenter="false" onleave="true">
+      DeclareVariable(|ident|, |type|);
+      RemoveTemplate;
+    </script>
+    <code language="Delphi" context="methodbody" delimiter="|">
+      <![CDATA[|ident||type|]]>
+    </code>
+  </template>
+</codetemplate>
+

Added: utilities/dzLiveTemplates/trunk/cr_live_template_stringdecl.xml
===================================================================
--- utilities/dzLiveTemplates/trunk/cr_live_template_stringdecl.xml	2007-05-19 17:51:36 UTC (rev 147)
+++ utilities/dzLiveTemplates/trunk/cr_live_template_stringdecl.xml	2007-05-19 17:52:04 UTC (rev 148)
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8" ?>
+<codetemplate xmlns="http://schemas.borland.com/Delphi/2005/codetemplates" version="1.0.0">
+  <template name="s:" invoke="auto">
+	<description>
+	  AutoComplete s: String declaration
+	</description>
+	<author>
+	  Sebastian Modersohn / Thomas Mueller
+	</author>
+	<point name="ident" editable="false">
+	  <text>s</text>
+	</point>
+	<point name="type" editable="false">
+	  <text>String</text>
+	</point>
+	<script language="Delphi" onenter="false" onleave="true">
+      DeclareVariable(|ident|, |type|);
+      RemoveTemplate;
+    </script>
+    <code language="Delphi" context="methodbody" delimiter="|">
+      <![CDATA[|ident||type|]]>
+    </code>
+  </template>
+</codetemplate>
+

Added: utilities/dzLiveTemplates/trunk/point.xml
===================================================================
--- utilities/dzLiveTemplates/trunk/point.xml	2007-05-19 17:51:36 UTC (rev 147)
+++ utilities/dzLiveTemplates/trunk/point.xml	2007-05-19 17:52:04 UTC (rev 148)
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8" ?>
+<codetemplate xmlns="http://schemas.borland.com/Delphi/2005/codetemplates" version="1.0.0">
+ <template name="point" invoke="auto">
+   <description>Used to enter points in Live Templates</description>
+   <author>Stolen from Nick Hodges who borrowed it from Deborah Pate</author>
+   <point name="pointname">
+	 <text>pointname</text>
+	 <hint>The name to be used for this point.</hint>
+   </point>
+   <point name="pointtext">
+	 <text />
+	 <hint>The default text to insert.</hint>
+   </point>
+   <point name="pointhint">
+	 <text />
+	 <hint>The text describing the point.</hint>
+   </point>
+   <code language="XML" delimiter="|">
+	 <![CDATA[ <point name="|pointname|">
+	  |*|<text>|pointtext|</text>
+	  |*|<hint>|pointhint|</hint>
+	  </point>
+	 |end|]]>
+   </code>
+  </template>
+ </codetemplate>
+

Added: utilities/dzLiveTemplates/trunk/propfreadonly.xml
===================================================================
--- utilities/dzLiveTemplates/trunk/propfreadonly.xml	2007-05-19 17:51:36 UTC (rev 147)
+++ utilities/dzLiveTemplates/trunk/propfreadonly.xml	2007-05-19 17:52:04 UTC (rev 148)
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8" ?>
+<codetemplate	xmlns="http://schemas.borland.com/Delphi/2005/codetemplates"
+				version="1.0.0">
+	<template name="propfreadonly" invoke="none">
+		<description>
+			read only property for field, press Ctrl-Shift-C afterwards to add the fields
+		</description>
+		<author>
+			twm
+		</author>
+		<point name="ident">
+			<text>Name</text>
+			<hint>the name for the property</hint>
+		</point>
+		<point name="type">
+			<text>Integer</text>
+			<hint>the type for the property</hint>
+		</point>
+		<code language="Delphi" delimiter="|">
+		<![CDATA[property |ident|: |type| read F|ident|;
+|end|]]>
+		</code>
+	</template>
+</codetemplate>
+

Added: utilities/dzLiveTemplates/trunk/propfreadwrite.xml
===================================================================
--- utilities/dzLiveTemplates/trunk/propfreadwrite.xml	2007-05-19 17:51:36 UTC (rev 147)
+++ utilities/dzLiveTemplates/trunk/propfreadwrite.xml	2007-05-19 17:52:04 UTC (rev 148)
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8" ?>
+<codetemplate	xmlns="http://schemas.borland.com/Delphi/2005/codetemplates"
+				version="1.0.0">
+	<template name="propfreadwrite" invoke="none">
+		<description>
+			read write property for field, press Ctrl-Shift-C afterwards to add the fields
+		</description>
+		<author>
+			twm
+		</author>
+		<point name="ident">
+			<text>Name</text>
+			<hint>the name for the property</hint>
+		</point>
+		<point name="type">
+			<text>Integer</text>
+			<hint>the type for the property</hint>
+		</point>
+		<code language="Delphi" delimiter="|">
+		<![CDATA[property |ident|: |type| read F|ident| write F|ident|;
+|end|]]>
+		</code>
+	</template>
+</codetemplate>
+

Added: utilities/dzLiveTemplates/trunk/semicolon-equals-typo.xml
===================================================================
--- utilities/dzLiveTemplates/trunk/semicolon-equals-typo.xml	2007-05-19 17:51:36 UTC (rev 147)
+++ utilities/dzLiveTemplates/trunk/semicolon-equals-typo.xml	2007-05-19 17:52:04 UTC (rev 148)
@@ -0,0 +1,15 @@
+<?xml version="1.0" encoding="utf-8" ?>
+<codetemplate xmlns="http://schemas.borland.com/Delphi/2005/codetemplates" version="1.0.0">
+  <template name=";=" invoke="auto">
+    <description>
+      convert typo ;= to :=
+    </description>
+    <author>
+      twm
+    </author>
+    <code language="Delphi" delimiter="|">
+      <![CDATA[:= |end|]]>
+    </code>
+  </template>
+</codetemplate>
+



From twm at mail.berlios.de  Mon May 28 16:36:51 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Mon, 28 May 2007 16:36:51 +0200
Subject: [Dzchart-svncheckins] r149 - in utilities/dzLib/trunk: . src
Message-ID: <200705281436.l4SEapwW021853@sheep.berlios.de>

Author: twm
Date: 2007-05-28 16:36:45 +0200 (Mon, 28 May 2007)
New Revision: 149

Modified:
   utilities/dzLib/trunk/default_de.po
   utilities/dzLib/trunk/src/u_dzConvertUtils.pas
   utilities/dzLib/trunk/src/u_dzMiscUtils.pas
Log:
* added MinInt64 and MaxInt64 constants to ConvertUtils
* moved Str2Int, Str2Int64, GuessDecimalSeparator, Str2Float, TryStr2Float from MiscUtils to ConvertUtils


Modified: utilities/dzLib/trunk/default_de.po
===================================================================
--- utilities/dzLib/trunk/default_de.po	2007-05-19 17:52:04 UTC (rev 148)
+++ utilities/dzLib/trunk/default_de.po	2007-05-28 14:36:45 UTC (rev 149)
@@ -6,167 +6,176 @@
 msgid ""
 msgstr ""
 "Project-Id-Version: dzLib 1.0\n"
-"POT-Creation-Date: 2007-03-19 15:29\n"
-"PO-Revision-Date: 2007-03-19 15:41+0100\n"
+"POT-Creation-Date: 2007-05-23 17:05\n"
+"PO-Revision-Date: 2007-05-23 17:10+0100\n"
 "Last-Translator: Schniering Ingenieursgesellschaft <info at schniering.com>\n"
+"Language-Team: Thomas Mueller <dzlib at dummzeuch.de>\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
 "X-Generator: dxgettext 1.2.1\n"
-"Language-Team: Thomas Mueller <dzlib at dummzeuch.de>\n"
 "X-Poedit-Language: German\n"
 "X-Poedit-Country: GERMANY\n"
 
-#: u_dzConvertUtils.pas:126
+#. "%s" ist kein g??ltiger Flie??komma Wert: %s
+#. Programmer's name for it: STR_X_IS_NOT_A_VALID_FLOAT_VALUE_SS
+#: u_dzConvertUtils.pas:182
+msgid "\"%s\" is not a valid floating point value: %s"
+msgstr "\"%s\" ist kein g??ltiger Flie??kommawert: %s"
+
+#. "%s" ist kein g??ltiger %s Wert: %s
+#. Programmer's name for it: STR_X_IS_NOT_A_VALID_Y_VALUE_SSS
+#: u_dzConvertUtils.pas:184
+msgid "\"%s\" is not a valid %s value: %s"
+msgstr "\"%s\" ist kein g??ltiger %s Wert: %s"
+
+#: u_dzConvertUtils.pas:215
 msgid "Digit out of range %s"
 msgstr "ung??ltige Ziffer %s"
 
-#: u_dzConvertUtils.pas:139
+#: u_dzConvertUtils.pas:228
 msgid "Digit #%d (%s) out of range"
 msgstr "Ung??ltige Ziffer #%d (%s)"
 
-#: u_dzDefaultMain.pas:113
+#: u_dzDefaultMain.pas:114
 msgid "Error: %s"
 msgstr "Fehler: %s"
 
 #. Programmer's name for it: STR_GETTEMPPATH_ERROR_DS
-#: u_dzFileUtils.pas:244
+#: u_dzFileUtils.pas:450
 msgid "u_dzFileUtils.GetTempPath: %1:s (code: %0:d) calling Windows.GetTempPath"
 msgstr "u_dzFileUtils.GetTempPath: %1:s (code: %0:d) beim Aufruf von Windows.GetTempPath"
 
 #. Programmer's name for it: STR_GETTEMPPATH_ERROR2_DS
-#: u_dzFileUtils.pas:245
+#: u_dzFileUtils.pas:451
 msgid "u_dzFileUtils.GetTempPath: %1:s (code: %0:d) calling Windows.GetTempPath (2nd)"
 msgstr "u_dzFileUtils.GetTempPath: %1:s (code: %0:d) beim Aufruf von Windows.GetTempPath (zweiter)"
 
 #. Programmer's name for it: STR_CREATEUNIQUEDIR_ERROR_S
-#: u_dzFileUtils.pas:246
+#: u_dzFileUtils.pas:452
 msgid "could not find a unique directory name based on \"%s\""
 msgstr "Konnte keinen eindeutigen Verzeichnisnamen basierend auf \"%s\" finden."
 
 #. Programmer's name for it: STR_GETTEMPFILENAME_ERROR_DS
-#: u_dzFileUtils.pas:247
+#: u_dzFileUtils.pas:453
 msgid "u_dzFileUtils.GetTempFilename: %1:s (Code: %0:d) calling Windows.GetTempFileName"
 msgstr "u_dzFileUtils.GetTempFilename: %1:s (Code: %0:d) beim Aufruf von Windows.GetTempFileName"
 
 #. Programmer's name for it: STR_GETSHORTPATHNAME_ERROR_DS
-#: u_dzFileUtils.pas:248
+#: u_dzFileUtils.pas:454
 msgid "u_dzFileUtils.GetShortPathname: %1:s (Code: %0:d) calling Windows.GetShortPathname"
 msgstr "u_dzFileUtils.GetShortPathname: %1:s (Code: %0:d) beim Aufruf von Windows.GetShortPathname"
 
 #. Programmer's name for it: STR_GETSHORTPATHNAME_TOO_LONG_D
-#: u_dzFileUtils.pas:249
+#: u_dzFileUtils.pas:455
 msgid "Short pathname is longer than MAX_PATH (%d) characters"
 msgstr "Kurzer Pfad ist l??nger als MAX_PATH (%d) Zeichen"
 
 #. doppelte % zum Durchreichen in Prozedur
 #. Programmer's name for it: STR_MOVEFILE_ERROR_SS
-#: u_dzFileUtils.pas:251
+#: u_dzFileUtils.pas:457
 msgid "Error %%1:s (%%0:d) while trying to move \"%s\" to \"%s\"."
 msgstr "Fehler %%1:s (%%0:d) beim Verschieben von \"%s\" nach \"%s\"."
 
 #. doppelte % zum Durchreichen in Prozedur
 #. Programmer's name for it: STR_SETREADONLY_ERROR_S
-#: u_dzFileUtils.pas:253
+#: u_dzFileUtils.pas:459
 msgid "Error %%1:s (%%0:d) while changing the readonly flag of \"%s\""
 msgstr "Fehler %%1:s (%%0:d) beim ??ndern des Schreibschutz-Flags von \"%s\""
 
 #. doppelte % zum Durchreichen in Prozedur
 #. Programmer's name for it: STR_COPYFILE_ERROR_SS
-#: u_dzFileUtils.pas:255
+#: u_dzFileUtils.pas:461
 msgid "Error %%1:s (%%0:d) while trying to copy \"%s\" to \"%s\"."
 msgstr "Fehler %%1:s (%%0:d) beim Kopieren von \"%s\" nach \"%s\"."
 
 #. doppelte % zum Durchreichen in Prozedur
 #. Programmer's name for it: STR_DELETEFILE_ERROR_S
-#: u_dzFileUtils.pas:257
+#: u_dzFileUtils.pas:463
 msgid "Error %%1:s (%%0:d) deleting file \"%s\""
 msgstr "Fehler %%1:s (%%0:d) beim L??schen der Datei \"%s\""
 
 #. doppelte % zum Durchreichen in Prozedur
 #. Programmer's name for it: STR_REMOVEDIR_ERROR_S
-#: u_dzFileUtils.pas:259
+#: u_dzFileUtils.pas:465
 msgid "Error %%1:s (%%0:d) deleting directory \"%s\""
 msgstr "Fehler %%1:s (%%0:d) beim L??schen des Verzeichnisses \"%s\""
 
 #. Programmer's name for it: STR_DELTREE_ERROR_S
-#: u_dzFileUtils.pas:260
+#: u_dzFileUtils.pas:466
 msgid "\"%s\" does not exist or is not a directory"
 msgstr "\"%s\" existiert nicht oder ist kein Verzeichnis"
 
 #. doppelte % zum Durchreichen in Prozedur
 #. Programmer's name for it: STR_CREATEDIR_ERROR_S
-#: u_dzFileUtils.pas:262
+#: u_dzFileUtils.pas:468
 msgid "Error %%1:s (%%0:d) creating directory \"%s\""
 msgstr "Fehler %%1:s (%%0:d) beim Erstellen des Verzeichnisses \"%s\""
 
 #. Variant ist Null, sollte %s sein: %s
 #. Programmer's name for it: STR_VARIANT_IS_NULL_SHOULD_BE_SS
-#: u_dzMiscUtils.pas:427
+#. Variant ist Null, sollte %s sein: %s
+#. Programmer's name for it: STR_VARIANT_IS_NULL_SHOULD_BE_SS
+#: u_dzMiscUtils.pas:350
 msgid "Variant is Null, should be %s: %s"
 msgstr "Variant ist Null, sollte %s sein: %s"
 
 #. Variant ist Empty, sollte %s sein: %s
 #. Programmer's name for it: STR_VARIANT_IS_EMPTY_SHOULD_BE_SS
-#: u_dzMiscUtils.pas:429
+#. Variant ist Empty, sollte %s sein: %s
+#. Programmer's name for it: STR_VARIANT_IS_EMPTY_SHOULD_BE_SS
+#: u_dzMiscUtils.pas:352
 msgid "Variant is Empty, should be %s: %s"
 msgstr "Variant ist leer, sollte %s sein: %s"
 
 #. Variant kann nicht nach %s konvertiert werden: %s
 #. Programmer's name for it: STR_VARAINT_CAN_NOT_BE_CONVERTED_TO_SS
-#: u_dzMiscUtils.pas:431
+#. Programmer's name for it: STR_VARIANT_CAN_NOT_BE_CONVERTED_TO_SS
+#: u_dzMiscUtils.pas:354
 msgid "Variant can not be converted to %s: %s"
 msgstr "Variant kann nicht nach %s konvertiert werden: %s"
 
 #. Unbekannter Betriebssystem Fehler
 #. Programmer's name for it: STR_UNKNOWN_WIN32_ERROR
-#: u_dzMiscUtils.pas:434
+#: u_dzMiscUtils.pas:357
 msgid "unknown OS error"
 msgstr "Unbekannter Betriebssystemfehler"
 
 #. Unbekannter Win32 Fehler
 #. Programmer's name for it: STR_UNKNOWN_WIN32_ERROR
-#: u_dzMiscUtils.pas:437
+#: u_dzMiscUtils.pas:360
 msgid "unknown Win32 error"
 msgstr "Unbekannter Windows Fehler"
 
-#. "%s" ist kein g??ltiger Flie??komma Wert: %s
-#. Programmer's name for it: STR_X_IS_NOT_A_VALID_FLOAT_VALUE_SS
-#: u_dzMiscUtils.pas:440
-msgid "\"%s\" is not a valid floating point value: %s"
-msgstr "\"%s\" ist kein g??ltiger Flie??kommawert: %s"
-
-#. "%s" ist kein g??ltiger %s Wert: %s
-#. Programmer's name for it: STR_X_IS_NOT_A_VALID_Y_VALUE_SSS
-#: u_dzMiscUtils.pas:442
-msgid "\"%s\" is not a valid %s value: %s"
-msgstr "\"%s\" ist kein g??ltiger %s Wert: %s"
-
 #. nthWord: Nulltes Wort nicht verf??gbar
 #. Programmer's name for it: STR_NO_0TH_WORD
-#: u_dzStringUtils.pas:242
+#: u_dzStringUtils.pas:262
 msgid "nthWord: 0th word not available"
 msgstr "nthWord: 0tes Wort ist nicht verf??gbar"
 
 #. Zu zentrierender String ist l??nger als die Maximall??nge und kann nicht zentriert werden.
 #. Programmer's name for it: STR_STRING_TOO_LONG_TO_CENTER
-#: u_dzStringUtils.pas:245
+#: u_dzStringUtils.pas:265
 msgid "Cannot center string that is larger than the maximum length."
 msgstr "Kann keinen String zentrieren, der l??nger als die maximale L??nge ist."
 
 #. Strings haben kein nulltes Zeichen.
 #. Programmer's name for it: STR_CHAR_INDEX_OUT_OF_RANGE
-#: u_dzStringUtils.pas:248
+#: u_dzStringUtils.pas:268
 msgid "Strings do not have a 0th character."
 msgstr "Strings haben kein 0tes Zeichen."
 
-#: u_dzVclUtils.pas:483
-#: u_dzVclUtils.pas:521
+#. Variant kann nicht nach %s konvertiert werden: %s
+#. Programmer's name for it: STR_VARIANT_CAN_NOT_BE_CONVERTED_TO_S
+#: u_dzVariantUtils.pas:159
+msgid "Variant can not be converted to %s"
+msgstr "Variant kann nicht nach %s konvertiert werden"
+
+#: u_dzVclUtils.pas:491
 msgid "\"%s\" is not a valid floating point value."
 msgstr "\"%s\" ist kein g??ltiger Flie??kommawert."
 
-#: u_dzVclUtils.pas:503
-#: u_dzVclUtils.pas:539
+#: u_dzVclUtils.pas:511
 msgid "\"%s\" is not a valid integer value."
 msgstr "\"%s\" ist kein g??ltiger Integerwert."
 

Modified: utilities/dzLib/trunk/src/u_dzConvertUtils.pas
===================================================================
--- utilities/dzLib/trunk/src/u_dzConvertUtils.pas	2007-05-19 17:52:04 UTC (rev 148)
+++ utilities/dzLib/trunk/src/u_dzConvertUtils.pas	2007-05-28 14:36:45 UTC (rev 149)
@@ -4,7 +4,7 @@
    which originally was a Delphi conversion of TwmStringFunc. }
 unit u_dzConvertUtils;
 
-{$i jedi.inc}
+{$I jedi.inc}
 
 interface
 
@@ -20,6 +20,8 @@
      given base. }
   EdzConvert = class(Exception);
   EDigitOutOfRange = class(EdzConvert);
+  {: raised if there is a conversion error in one of the Str2XxxEx functions }
+  EStringConvertError = class(EdzConvert);
 
 type
   ULong = LongWord;
@@ -28,6 +30,10 @@
   TBaseN = 2..36;
 
 const
+  MinInt64 = $8000000000000000;
+  MaxInt64 = $7FFFFFFFFFFFFFFF;
+
+const
   {: String containing all characters that can be used as digits }
   DIGIT_CHARS: string[36] = '0123456789ABCDEFGHIJKlMNOPQRSTUVWXYZ';
 
@@ -90,6 +96,72 @@
 function TimeToSeconds(_Zeit: TDateTime): integer; deprecated;
 {$ENDIF}
 
+{: Converts a string to an integer.
+   If s can not be converted, it returns the Default.
+   @param(s string to convert)
+   @param(Default value to return if s can not be converted)
+   @returns(the integer value of s or Default, if s can not be converted) }
+
+function Str2Int(_s: string; _Default: integer): integer; overload;
+
+{: Converts a string to an integer.
+   If s can not be converted, it raises an exception EStringConvertError.
+   @param(s string to convert)
+   @param(Source string to include in the exception message)
+   @returns(the integer value of s)
+   @raises(EStringConvertError if s can not be converted) }
+
+function Str2Int(_s: string; const _Source: string): integer; overload;
+
+{: Converts a string to an int64.
+   If s can not be converted, it returns the Default.
+   @param(s string to convert)
+   @param(Default value to return if s can not be converted)
+   @returns(the int64 value of s or Default, if s can not be converted) }
+
+function Str2Int64(_s: string; _Default: Int64): Int64; overload;
+
+{: Converts a string to an int64.
+   If s can not be converted, it raises an exception EStringConvertError.
+   @param(s string to convert)
+   @param(Source string to include in the exception message)
+   @returns(the integer value of s)
+   @raises(EStringConvertError if s can not be converted) }
+
+function Str2Int64(_s: string; const _Source: string): Int64; overload;
+
+{: tries to guess the decimal separator }
+function GuessDecimalSeparator(const _s: string): char;
+
+{: Converts a string to a float.
+   If s can not be converted, it returns the Default.
+   @param s string to convert
+   @param Default value to return if s can not be converted
+   @param DecSeparator is the decimal separator, defaults to '.'
+          if passed as #0, GuessDecimalSeparator is called to guess it
+   @returns the float value of s or Default, if s can not be converted }
+function Str2Float(_s: string; _Default: extended; _DecSeparator: char = '.'): extended; overload;
+
+{: Converts a string to a float.
+   If s can not be converted, it raises an exception EStringConvertError.
+   @param(s string to convert)
+   @param(Source string to include in the exception message)
+   @param DecSeparator is the decimal separator, defaults to '.'
+          if passed as #0, GuessDecimalSeparator is called to guess it
+   @returns(the float value of s)
+   @raises(EStringConvertError if s can not be converted) }
+
+function Str2Float(_s: string; const _Source: string; _DecSeparator: char = '.'): extended; overload;
+
+{: tries to convert a string to a float, returns false if it fails
+   @param s is the string to convert
+   @param flt is the float, only valid if the function returns true
+   @param DecSeparator is the decimal separator to use, defaults to '.',
+          if passed as #0, GuessDecimalSeparator is called to guess it
+   @returns true, if s could be converted, false otherwise }
+function TryStr2Float(_s: string; out _flt: extended; _DecSeparator: char = '.'): boolean; overload;
+function TryStr2Float(_s: string; out _flt: double; _DecSeparator: char = '.'): boolean; overload;
+
 {: Converts a floating point number to a string using the given decimal separator
    in "General number format" with 15 significant digits
    @param(flt is an extended floating point value)
@@ -105,6 +177,12 @@
   u_dzTranslator,
   u_dzStringUtils;
 
+resourcestring
+  // "%s" ist kein g?ltiger Flie?komma Wert: %s
+  STR_X_IS_NOT_A_VALID_FLOAT_VALUE_SS = '"%s" is not a valid floating point value: %s';
+  // "%s" ist kein g?ltiger %s Wert: %s
+  STR_X_IS_NOT_A_VALID_Y_VALUE_SSS = '"%s" is not a valid %s value: %s';
+
 function isDigit(_a: char; _Base: TBaseN): boolean;
 begin
   Result := (Pos(UpCase(_a), LeftStr(DIGIT_CHARS, _Base)) <> 0);
@@ -320,6 +398,104 @@
   Result := SysUtils.FloatToStr(_Flt, FormatSettings);
 end;
 
+function Str2Int(_s: string; _Default: integer): integer;
+var
+  e: integer;
+begin
+  Val(_s, Result, e);
+  if e <> 0 then
+    Result := _Default
+end;
+
+function Str2Int(_s: string; const _Source: string): integer;
+var
+  e: integer;
+begin
+  Val(_s, Result, e);
+  if e <> 0 then
+    raise EStringConvertError.CreateFmt(STR_X_IS_NOT_A_VALID_Y_VALUE_SSS, [_s, 'Integer', _Source]);
+end;
+
+function Str2Int64(_s: string; _Default: Int64): Int64;
+var
+  e: integer;
+begin
+  Val(_s, Result, e);
+  if e <> 0 then
+    Result := _Default
+end;
+
+function Str2Int64(_s: string; const _Source: string): Int64;
+var
+  e: integer;
+begin
+  Val(_s, Result, e);
+  if e <> 0 then
+    raise EStringConvertError.CreateFmt(STR_X_IS_NOT_A_VALID_Y_VALUE_SSS, [_s, 'Int64', _Source]);
+end;
+
+function GuessDecimalSeparator(const _s: string): char;
+var
+  i: integer;
+  //  DotCnt: integer;
+  CommaCnt: integer;
+begin
+  //  DotCnt := 0;
+  CommaCnt := 0;
+  Result := '.';
+  for i := 1 to length(_s) do begin
+    case _s[i] of
+      '.': begin
+            //            Inc(DotCnt);
+          Result := '.';
+        end;
+      ',': begin
+          Inc(CommaCnt);
+          Result := ',';
+        end;
+    end;
+  end;
+  if (Result = ',') and (CommaCnt = 1) then
+    exit;
+  Result := '.';
+end;
+
+function TryStr2Float(_s: string; out _flt: extended; _DecSeparator: char = '.'): boolean;
+var
+  TmpDecSeparator: char;
+begin
+  if _DecSeparator = #0 then
+    _DecSeparator := GuessDecimalSeparator(_s);
+  TmpDecSeparator := DecimalSeparator;
+  DecimalSeparator := _DecSeparator;
+  try
+    Result := TextToFloat(PChar(_s), _flt, fvExtended);
+  finally
+    DecimalSeparator := TmpDecSeparator;
+  end;
+end;
+
+function TryStr2Float(_s: string; out _flt: double; _DecSeparator: char = '.'): boolean; overload;
+var
+  flt: extended;
+begin
+  Result := TryStr2Float(_s, flt, _DecSeparator);
+  if Result then
+    _flt := flt;
+end;
+
+function Str2Float(_s: string; _Default: extended; _DecSeparator: char = '.'): extended; overload;
+begin
+  if not TryStr2Float(_s, Result, _DecSeparator) then
+    Result := _Default
+end;
+
+function Str2Float(_s: string; const _Source: string; _DecSeparator: char = '.'): extended; overload;
+begin
+  if not TryStr2Float(_s, Result, _DecSeparator) then
+    raise EStringConvertError.CreateFmt(STR_X_IS_NOT_A_VALID_FLOAT_VALUE_SS, [_s, _Source]);
+end;
+
 initialization
   DZ_FORMAT_DECIMAL_POINT := GetUserDefaultLocaleSettings;
   DZ_FORMAT_DECIMAL_POINT.DecimalSeparator := '.';

Modified: utilities/dzLib/trunk/src/u_dzMiscUtils.pas
===================================================================
--- utilities/dzLib/trunk/src/u_dzMiscUtils.pas	2007-05-19 17:52:04 UTC (rev 148)
+++ utilities/dzLib/trunk/src/u_dzMiscUtils.pas	2007-05-28 14:36:45 UTC (rev 149)
@@ -15,7 +15,6 @@
 {$I jedi.inc}
 
 { TODO -otwm : Move variant functions to u_dzVariants }
-{ TODO -otwm : Move float functions to u_dzConvertUtils }
 
 {$WARN SYMBOL_PLATFORM off}
 
@@ -40,9 +39,6 @@
   {: raised if the variant passed to one of the Var2XxxEx functions is empty }
   EVarIsEmpty = class(EVariantConvertError);
 
-  {: raised if there is a conversion error in one of the Str2XxxEx functions }
-  EStringConvertError = class(EConvertError);
-
   {: raised by Max([array of const]) and Min([array of const]) if the passed
      paramter is empty }
   EEmptyArray = class(Exception);
@@ -80,7 +76,7 @@
 {: returns a hex dump of the buffer (no spaces added)
    @param(Buffer is the memory block to dump)
    @param(Len is the length of the block)
-   @returns(a string containting the hex dump of the buffer) }
+   @returns(a string containing the hex dump of the buffer) }
 
 function HexDump(const _Buffer; _Len: integer): string;
 
@@ -225,79 +221,6 @@
 
 function Var2StrEx(_v: variant; const _Source: string): string;
 
-{: Converts a string to an integer.
-   If s can not be converted, it returns the Default.
-   @param(s string to convert)
-   @param(Default value to return if s can not be converted)
-   @returns(the integer value of s or Default, if s can not be converted) }
-
-function Str2Int(_s: string; _Default: integer): integer; overload;
-
-{: Converts a string to an integer.
-   If s can not be converted, it raises an exception EStringConvertError.
-   @param(s string to convert)
-   @param(Source string to include in the exception message)
-   @returns(the integer value of s)
-   @raises(EStringConvertError if s can not be converted) }
-
-function Str2Int(_s: string; const _Source: string): integer; overload;
-
-{: Converts a string to an int64.
-   If s can not be converted, it returns the Default.
-   @param(s string to convert)
-   @param(Default value to return if s can not be converted)
-   @returns(the int64 value of s or Default, if s can not be converted) }
-
-function Str2Int64(_s: string; _Default: Int64): Int64; overload;
-
-{: Converts a string to an int64.
-   If s can not be converted, it raises an exception EStringConvertError.
-   @param(s string to convert)
-   @param(Source string to include in the exception message)
-   @returns(the integer value of s)
-   @raises(EStringConvertError if s can not be converted) }
-
-function Str2Int64(_s: string; const _Source: string): Int64; overload;
-
-{: tries to guess the decimal separator }
-function GuessDecimalSeparator(const _s: string): char;
-
-{: Converts a string to a float.
-   If s can not be converted, it returns the Default.
-   @param s string to convert
-   @param Default value to return if s can not be converted
-   @param DecSeparator is the decimal separator, defaults to '.'
-          if passed as #0, GuessDecimalSeparator is called to guess it
-   @returns the float value of s or Default, if s can not be converted }
-function Str2Float(_s: string; _Default: extended; _DecSeparator: char = '.'): extended; overload;
-
-{: Converts a string to a float.
-   If s can not be converted, it raises an exception EStringConvertError.
-   @param(s string to convert)
-   @param(Source string to include in the exception message)
-   @param DecSeparator is the decimal separator, defaults to '.'
-          if passed as #0, GuessDecimalSeparator is called to guess it
-   @returns(the float value of s)
-   @raises(EStringConvertError if s can not be converted) }
-
-function Str2Float(_s: string; const _Source: string; _DecSeparator: char = '.'): extended; overload;
-
-{: tries to convert a string to a float, returns false if it fails
-   @param s is the string to convert
-   @param flt is the float, only valid if the function returns true
-   @param DecSeparator is the decimal separator to use, defaults to '.',
-          if passed as #0, GuessDecimalSeparator is called to guess it
-   @returns true, if s could be converted, false otherwise }
-function TryStr2Float(_s: string; out _flt: extended; _DecSeparator: char = '.'): boolean; overload;
-function TryStr2Float(_s: string; out _flt: double; _DecSeparator: char = '.'): boolean; overload;
-
-{: Converts a floating point number to a string using the given decimal separator
-   in "General number format" with 15 significant digits
-   @param(flt is an extended floating point value)
-   @param(DecSeparator is the decimal separator to use)
-   @returns(a string representation of the floating point value) }
-function Float2Str(_flt: extended; _DecSeparator: char = '.'): string;
-
 {: Uses GetLastError to get the last WinAPI error code, then
    calls SysErrorMessage to get the corresponding error string,
    optionally takes a format string.
@@ -436,10 +359,6 @@
   // Unbekannter Win32 Fehler
   STR_UNKNOWN_WIN32_ERROR = 'unknown Win32 error';
 {$ENDIF delphi7up}
-  // "%s" ist kein g?ltiger Flie?komma Wert: %s
-  STR_X_IS_NOT_A_VALID_FLOAT_VALUE_SS = '"%s" is not a valid floating point value: %s';
-  // "%s" ist kein g?ltiger %s Wert: %s
-  STR_X_IS_NOT_A_VALID_Y_VALUE_SSS = '"%s" is not a valid %s value: %s';
 
 {$IFDEF debug}
 
@@ -579,111 +498,6 @@
     end;
 end;
 
-function Str2Int(_s: string; _Default: integer): integer;
-var
-  e: integer;
-begin
-  Val(_s, Result, e);
-  if e <> 0 then
-    Result := _Default
-end;
-
-function Str2Int(_s: string; const _Source: string): integer;
-var
-  e: integer;
-begin
-  Val(_s, Result, e);
-  if e <> 0 then
-    raise EStringConvertError.CreateFmt(STR_X_IS_NOT_A_VALID_Y_VALUE_SSS, [_s, 'Integer', _Source]);
-end;
-
-function Str2Int64(_s: string; _Default: Int64): Int64;
-var
-  e: integer;
-begin
-  Val(_s, Result, e);
-  if e <> 0 then
-    Result := _Default
-end;
-
-function Str2Int64(_s: string; const _Source: string): Int64;
-var
-  e: integer;
-begin
-  Val(_s, Result, e);
-  if e <> 0 then
-    raise EStringConvertError.CreateFmt(STR_X_IS_NOT_A_VALID_Y_VALUE_SSS, [_s, 'Int64', _Source]);
-end;
-
-function GuessDecimalSeparator(const _s: string): char;
-var
-  i: integer;
-  //  DotCnt: integer;
-  CommaCnt: integer;
-begin
-  //  DotCnt := 0;
-  CommaCnt := 0;
-  Result := '.';
-  for i := 1 to length(_s) do begin
-    case _s[i] of
-      '.': begin
-            //            Inc(DotCnt);
-          Result := '.';
-        end;
-      ',': begin
-          Inc(CommaCnt);
-          Result := ',';
-        end;
-    end;
-  end;
-  if (Result = ',') and (CommaCnt = 1) then
-    exit;
-  Result := '.';
-end;
-
-function TryStr2Float(_s: string; out _flt: extended; _DecSeparator: char = '.'): boolean;
-var
-  TmpDecSeparator: char;
-begin
-  if _DecSeparator = #0 then
-    _DecSeparator := GuessDecimalSeparator(_s);
-  TmpDecSeparator := DecimalSeparator;
-  DecimalSeparator := _DecSeparator;
-  try
-    Result := TextToFloat(PChar(_s), _flt, fvExtended);
-  finally
-    DecimalSeparator := TmpDecSeparator;
-  end;
-end;
-
-function TryStr2Float(_s: string; out _flt: double; _DecSeparator: char = '.'): boolean; overload;
-var
-  flt: extended;
-begin
-  Result := TryStr2Float(_s, flt, _DecSeparator);
-  if Result then
-    _flt := flt;
-end;
-
-function Str2Float(_s: string; _Default: extended; _DecSeparator: char = '.'): extended; overload;
-begin
-  if not TryStr2Float(_s, Result, _DecSeparator) then
-    Result := _Default
-end;
-
-function Str2Float(_s: string; const _Source: string; _DecSeparator: char = '.'): extended; overload;
-begin
-  if not TryStr2Float(_s, Result, _DecSeparator) then
-    raise EStringConvertError.CreateFmt(STR_X_IS_NOT_A_VALID_FLOAT_VALUE_SS, [_s, _Source]);
-end;
-
-function Float2Str(_flt: extended; _DecSeparator: char = '.'): string;
-begin
-  Result := SysUtils.FloatToStr(_Flt);
-  if _DecSeparator <> SysUtils.DecimalSeparator then
-    Result := StringReplace(Result, SysUtils.DecimalSeparator, _DecSeparator, [rfReplaceAll]);
-end;
-
 function TryVar2Dbl(const _v: variant; out _Value: double): boolean;
 begin
   Result := not VarIsNull(_v) and not VarIsEmpty(_v);



From twm at mail.berlios.de  Mon May 28 16:37:59 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Mon, 28 May 2007 16:37:59 +0200
Subject: [Dzchart-svncheckins] r150 - utilities/dzLib/trunk/src
Message-ID: <200705281437.l4SEbxb9022030@sheep.berlios.de>

Author: twm
Date: 2007-05-28 16:37:26 +0200 (Mon, 28 May 2007)
New Revision: 150

Modified:
   utilities/dzLib/trunk/src/u_dzCmdLineParser.pas
Log:
* added support for -? to CmdLineParser


Modified: utilities/dzLib/trunk/src/u_dzCmdLineParser.pas
===================================================================
--- utilities/dzLib/trunk/src/u_dzCmdLineParser.pas	2007-05-28 14:36:45 UTC (rev 149)
+++ utilities/dzLib/trunk/src/u_dzCmdLineParser.pas	2007-05-28 14:37:26 UTC (rev 150)
@@ -6,7 +6,7 @@
    @author Thomas Mueller <http://www.dummzeuch.de> }
 unit u_dzCmdLineParser;
 
-{$i jedi.inc}
+{$I jedi.inc}
 
 interface
 
@@ -315,7 +315,7 @@
   c: char;
 begin
   c := _Context.GetNextChar;
-  if c in ALPHANUMERIC_CHARS then begin
+  if c in ALPHANUMERIC_CHARS + ['?'] then begin
     _Context.AddToOption(c);
     Result := TEngineStateShortOption.Create;
   end else if c = '-' then



From twm at mail.berlios.de  Mon May 28 16:38:32 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Mon, 28 May 2007 16:38:32 +0200
Subject: [Dzchart-svncheckins] r151 - utilities/dzLib/trunk/src
Message-ID: <200705281438.l4SEcWht022086@sheep.berlios.de>

Author: twm
Date: 2007-05-28 16:38:31 +0200 (Mon, 28 May 2007)
New Revision: 151

Modified:
   utilities/dzLib/trunk/src/u_dzDefaultMain.pas
Log:
* added exception logging to Main function


Modified: utilities/dzLib/trunk/src/u_dzDefaultMain.pas
===================================================================
--- utilities/dzLib/trunk/src/u_dzDefaultMain.pas	2007-05-28 14:37:26 UTC (rev 150)
+++ utilities/dzLib/trunk/src/u_dzDefaultMain.pas	2007-05-28 14:38:31 UTC (rev 151)
@@ -190,7 +190,10 @@
     end;
   except
     // Exception handling findet im MainObj statt, was bis hierher kommt,
-    // kann man eh nicht mehr behandeln.
+    // kann man eh nicht mehr behandeln - aber evt. Loggen ? AS
+    on e: Exception do begin
+      LogError('Exception in function Main: '+e.Message+' '+e.ClassName);
+    end;
   end;
 end;
 



From twm at mail.berlios.de  Mon May 28 16:42:03 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Mon, 28 May 2007 16:42:03 +0200
Subject: [Dzchart-svncheckins] r152 - in utilities/dzLib/trunk: src
	tests/dzfileutils
Message-ID: <200705281442.l4SEg3RQ022437@sheep.berlios.de>

Author: twm
Date: 2007-05-28 16:41:55 +0200 (Mon, 28 May 2007)
New Revision: 152

Modified:
   utilities/dzLib/trunk/src/u_dzFileUtils.pas
   utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dpr
   utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dproj
   utilities/dzLib/trunk/tests/dzfileutils/Testu_dzFileUtils.pas
Log:
* added an Execute class method to TSimpleDirEnumerator to simplify usage
* New TDirectorySync class for synchronizing directories
* new class methods BackupFile and GetFileInfo in TFileSystem
* New TFileGenerationHandler class for automatically handling multiple generations of a file
* Bugfix: TFileSystem.CopyFileWithProgress no longer raises an exception if the user aborts
* Unit tests

Modified: utilities/dzLib/trunk/src/u_dzFileUtils.pas
===================================================================
--- utilities/dzLib/trunk/src/u_dzFileUtils.pas	2007-05-28 14:38:31 UTC (rev 151)
+++ utilities/dzLib/trunk/src/u_dzFileUtils.pas	2007-05-28 14:41:55 UTC (rev 152)
@@ -17,6 +17,8 @@
   {: raised by DelTree if the DirName parameter is not a valid directory name }
   EDirNotFound = class(EFileUtils);
   EPathTooLong = class(EFileUtils);
+  EInvalidPropertyCombination = class(EFileUtils);
+  EFileNotFound = class(EFileUtils);
 
 type
   TFileAttributes = (
@@ -30,6 +32,13 @@
 
   TFileAttributeSet = set of TFileAttributes;
 
+  TFileInfoRec = record
+  public
+    Filename: string;
+    Size: Int64;
+    Timestamp: TDateTime;
+  end;
+
 type
   {: a simple wrapper around FindFirst/FindNext which allows to search for
      specified attributes only (e.g. only directories), it automatically
@@ -58,6 +67,8 @@
     constructor Create(const _Mask: string);
     {: Destructor, will call FindClose if necessary }
     destructor Destroy; override;
+    {: creates a TSimpleDirEnumerator, calls its FindAll method and frees it }
+    class function Execute(const _Mask: string; _List: TStrings): integer;
     {: Calls SysUtils.FindFirst on first call and SysUtls.FindNext in later
        calls.
        @param Filename is the name of the file found, if result is true, if you need
@@ -140,6 +151,51 @@
   TCopyFileProgressEvt = procedure(_Status: TCopyProgressStatus;
     var _Continue: TCopyProgressStatus.TProgressResult) of object;
 
+  {: defines the action to take if a file already exists but has a different content }
+  TFileExistsAction = (feaIgnore, feaOverwrite);
+  TOnSyncing = procedure(_Sender: TObject; const _SrcDir, _DstDir: string) of object;
+  {: called if a destination file already exists
+     @param Action is the action to take, default is feaIgnore }
+  TOnFileExists = procedure(_Sender: TObject; const _SrcFile, _DstFile: TFileInfoRec; var _Action: TFileExistsAction) of object;
+  {: Synchronizes two directories }
+  TDirectorySync = class
+  private
+    FOnSyncingDir: TOnSyncing;
+    FOnSyncingFile: TOnSyncing;
+    FOnFileExists: TOnFileExists;
+//    FOnDifferentFileExists: TOnDifferentFileExists;
+//    FCheckContent: boolean;
+//    procedure doOnDifferentFileExists(const _Filename: string; var _Action: TFileExistsAction);
+    procedure doOnSyncingDir(const _SrcDir, _DstDir: string);
+    procedure doOnSyncingFile(const _SrcFile, _DstFile: string);
+    function doOnFileExists(const _SrcDir, _DstDir, _Filename: string): TFileExistsAction;
+  public
+    {: Checks if there are files in the source directory that are already in
+       the destination directory, for each file that exists, the OnFileExists
+       event is called. }
+    procedure CheckOneWay(const _SrcDir, _DstDir: string);
+    {: copies all files from DirA to DirB if they don't already exists
+       (not implemented: if CheckContent=true, the content existing files will be checked and if
+                         it doesn't match, OnDifferentFileExists is called ) }
+    procedure SyncOneWay(const _SrcDir, _DstDir: string);
+    {: calls SyncOneWay(DirA, DirB) and SyncOneWay(DirB, DirA)
+       (not implemented: if CheckContent=true, the content existing files will be checked and if
+                         it doesn't match, OnDifferentFileExists is called ) }
+    procedure SyncBothWays(const _DirA, _DirB: string);
+//    {: Not implemented: Called, if the content of an existing file is different }
+//    property OnDifferentFileExists: TOnDifferentFileExists read FOnDifferentFileExists write FOnDifferentFileExists;
+//    {: Not implemented: if true, OnDifferentFileExists will be called }
+//    property CheckContent: boolean read FCheckContent write FCheckContent default false;
+    {: called when a new directory is entered, to abort synchronization,
+       raise an exception (e.g. SysUtils.Abort), and catch it in the calling method }
+    property OnSyncingDir: TOnSyncing read FOnSyncingDir write FOnSyncingDir;
+    {: called when a file is being copied, to abort synchronization,
+      raise an exception (e.g. SysUtils.Abort), and catch it in the calling method }
+    property OnSyncingFile: TOnSyncing read FOnSyncingFile write FOnSyncingFile;
+    {: called from CheckOneWay if a destination file already exists }
+    property OnFileExists: TOnFileExists read FOnFileExists write FOnFileExists;
+  end;
+
   {: This class owns all utility functions as class methods so they don't pollute the name space }
   TFileSystem = class
   public
@@ -336,8 +392,51 @@
        @param ErrPos is the first error position, only valid it result = false
        @returns true, if the string is a valid filename, false otherwise }
     class function IsValidFilename(const _s: string; out _ErrPos: integer): boolean; overload;
+    {: creates a backup of the file appending the current date and time to the base
+       file name.
+       @param Filename is the name of the file to back up
+       @param BackupDir is a directory in which to create the backup file, if empty
+                        the same directory as the original file is used }
+    class procedure BackupFile(const _Filename: string; _BackupDir: string = '');
+    class function GetFileInfo(const _Filename: string): TFileInfoRec;
   end;
 
+type
+  {: callback event for generating a filename for the given generation }
+  TOnGenerateFilename = procedure(_Sender: TObject; _Generation: integer; var _Filename: string) of object;
+type
+  TFileGenerationHandler = class
+  private
+    FBaseName: string;
+    FSuffix: string;
+    FOnGenerateFilename: TOnGenerateFilename;
+    FMaxGenerations: integer;
+    FResultContainsNumber: boolean;
+    FOldestIsHighest: boolean;
+    FPrependZeros: integer;
+    function GenerateFilename(_Generation: integer): string;
+  public
+    {: @param BaseName is the base filename to which by default _<n> followed by
+                       the Suffix will be appended
+       @param Suffix is the suffix for the filename, usually an extension which
+                     must include the dot (.) }
+    constructor Create(const _BaseName, _Suffix: string);
+    {: generates the filename and returns it }
+    function Execute(_KeepOriginal: boolean): string;
+    {: the maximum of file generations that should be kept }
+    property MaxGenerations: integer read FMaxGenerations write FMaxGenerations default 5;
+    {: should the resulting filename contain a number? }
+    property ResultContainsNumber: boolean read FResultContainsNumber write FResultContainsNumber default false;
+    {: does the oldest file have the highest number? }
+    property OldestIsHighest: boolean read FOldestIsHighest write FOldestIsHighest default true;
+    property PrependZeros: integer read FPrependZeros write FPrependZeros default 0;
+    {: allows read access to the file's base name as passed to the constructor }
+    property BaseName: string read FBaseName;
+    property Suffix: string read FSuffix;
+    {: callback event for generating a filename for the given generation }
+    property OnGenerateFilename: TOnGenerateFilename read FOnGenerateFilename write FOnGenerateFilename;
+  end;
+
 {: This is an abbreviation for IncludeTrailingPathDelimiter }
 function itpd(const _Dirname: string): string; inline;
 
@@ -345,7 +444,9 @@
 
 uses
   FileCtrl,
-  u_dzMiscUtils;
+  u_dzMiscUtils,
+  u_dzStringUtils,
+  u_dzDateUtils;
 
 resourcestring
   STR_GETTEMPPATH_ERROR_DS = 'u_dzFileUtils.GetTempPath: %1:s (code: %0:d) calling Windows.GetTempPath';
@@ -388,6 +489,18 @@
   inherited;
 end;
 
+class function TSimpleDirEnumerator.Execute(const _Mask: string; _List: TStrings): integer;
+var
+  enum: TSimpleDirEnumerator;
+begin
+  enum := TSimpleDirEnumerator.Create(_Mask);
+  try
+    Result := enum.FindAll(_List);
+  finally
+    enum.Free;
+  end;
+end;
+
 function TSimpleDirEnumerator.FindAll(_List: TStrings): integer;
 var
   s: string;
@@ -525,7 +638,7 @@
   if _BaseDir = '' then
     _BaseDir := GetTempPath;
   Pid := GetCurrentProcessId;
-  s := IncludeTrailingPathDelimiter(_BaseDir) + _Prefix + '_' + IntToStr(Pid) + '_';
+  s := itpd(_BaseDir) + _Prefix + '_' + IntToStr(Pid) + '_';
   Counter := 0;
   Ok := false;
   while not OK do begin
@@ -556,6 +669,23 @@
   Result := PChar(Result); // remove trailing characters
 end;
 
+class function TFileSystem.GetFileInfo(const _Filename: string): TFileInfoRec;
+var
+  sr: TSearchRec;
+  Res: integer;
+begin
+  Res := FindFirst(_Filename, faAnyFile, sr);
+  if Res <> 0 then
+    raise EFileNotFound.CreateFmt('File not found: "%s"', [_Filename]);
+  try
+    Result.Filename := _Filename;
+    Result.Size := sr.Size;
+    Result.Timestamp := FileDateToDateTime(sr.Time);
+  finally
+    FindClose(sr);
+  end;
+end;
+
 class function TFileSystem.GetShortPathname(const _LongName: string): string;
 var
   Res: integer;
@@ -618,6 +748,21 @@
   end;
 end;
 
+class procedure TFileSystem.BackupFile(const _Filename: string; _BackupDir: string = '');
+var
+  Ext: string;
+  FilenameOnly: string;
+  Base: string;
+begin
+  if _BackupDir = '' then
+    _BackupDir := ExtractFilePath(_Filename);
+  _BackupDir := itpd(_BackupDir);
+  FilenameOnly := ExtractFileName(_Filename);
+  Ext := ExtractFileExt(FilenameOnly);
+  Base := ChangeFileExt(FilenameOnly, '');
+  CopyFile(_Filename, _BackupDir + Base + '_' + ReplaceChars(DateTime2Iso(now, true), ': ', '-_') + Ext, true);
+end;
+
 class function TFileSystem.CopyFile(const _Source, _Dest: string; _Flags: TCopyFileFlagSet): boolean;
 begin
   Result := CopyFile(_Source, _Dest,
@@ -659,8 +804,8 @@
   Status.FStreamBytesTransferred := _StreamBytesTransferred;
   Status.FStreamNumber := _StreamNumber;
   case _CallbackReason of
-  CALLBACK_CHUNK_FINISHED: Status.FCallbackReason := prChunkFinished;
-  CALLBACK_STREAM_SWITCH: Status.FCallbackReason := prStreamSwitch;
+    CALLBACK_CHUNK_FINISHED: Status.FCallbackReason := prChunkFinished;
+    CALLBACK_STREAM_SWITCH: Status.FCallbackReason := prStreamSwitch;
   else
     // Shouldn't happen, assume CALLBACK_CHUNK_FINISHED for now
     Status.FCallbackReason := prChunkFinished;
@@ -694,19 +839,19 @@
     Flags := 0;
     if cfwFailIfExists in _Flags then
       Flags := Flags or COPY_FILE_FAIL_IF_EXISTS;
-     if cfwRestartable in _Flags then
-       Flags := Flags or COPY_FILE_RESTARTABLE;
+    if cfwRestartable in _Flags then
+      Flags := Flags or COPY_FILE_RESTARTABLE;
     Res := Windows.CopyFileEx(PChar(_Source), PChar(_Dest), @ProgressCallback, Redir,
       @Redir.CancelFlag, Flags);
     if not Res then begin
       LastError := GetLastError;
-      if cfwRaiseException in _Flags then
-        RaiseLastOsErrorEx(LastError, Format(STR_COPYFILE_ERROR_SS, [_Source, _Dest]));
-
       if LastError = ERROR_REQUEST_ABORTED then
         Result := cfwAborted
-      else
+      else begin
+        if cfwRaiseException in _Flags then
+          RaiseLastOsErrorEx(LastError, Format(STR_COPYFILE_ERROR_SS, [_Source, _Dest]));
         Result := cfwError;
+      end;
     end else
       Result := cfwOK;
   finally
@@ -827,7 +972,7 @@
     end;
 end;
 
-class function TFileSystem.ForceDir(const _DirectoryPath: string; _RaiseException: boolean): boolean;
+class function TFileSystem.ForceDir(const _DirectoryPath: string; _RaiseException: boolean = true): boolean;
 var
   LastError: Cardinal;
 begin
@@ -951,5 +1096,260 @@
     FOnProgress(Self, Result);
 end;
 
+{ TFileGenerationHandler }
+
+constructor TFileGenerationHandler.Create(const _BaseName, _Suffix: string);
+begin
+  inherited Create;
+  FMaxGenerations := 5;
+  FOldestIsHighest := true;
+  FResultContainsNumber := false;
+  FPrependZeros := 0;
+  FBaseName := _BaseName;
+  FSuffix := _Suffix;
+end;
+
+function TFileGenerationHandler.Execute(_KeepOriginal: boolean): string;
+
+  function doNoNumberOldIsHighest(): string;
+  var
+    i: Integer;
+    dst: string;
+    src: string;
+    MaxGen: integer;
+  begin
+    MaxGen := FMaxGenerations - 1;
+    for i := MaxGen - 1 downto 1 do begin
+      dst := GenerateFilename(i + 1);
+      if FileExists(dst) then
+        TFileSystem.DeleteFile(dst);
+      src := GenerateFilename(i);
+      if FileExists(src) then
+        TFileSystem.MoveFile(src, dst);
+    end;
+    dst := GenerateFilename(1);
+    Result := GenerateFilename(0);
+    if FileExists(dst) then
+      TFileSystem.DeleteFile(dst);
+    if FileExists(Result) then begin
+      if _KeepOriginal then
+        TFileSystem.CopyFile(Result, dst, true)
+      else
+        TFileSystem.MoveFile(Result, dst);
+    end;
+  end;
+
+  function doNumberOldIsHighest(): string;
+  var
+    i: Integer;
+    dst: string;
+    src: string;
+    MaxGen: integer;
+  begin
+    MaxGen := FMaxGenerations;
+    for i := MaxGen - 1 downto 1 do begin
+      dst := GenerateFilename(i + 1);
+      if FileExists(dst) then
+        TFileSystem.DeleteFile(dst);
+      src := GenerateFilename(i);
+      if FileExists(src) then
+        TFileSystem.MoveFile(src, dst);
+    end;
+    Result := GenerateFilename(1);
+  end;
+
+  function doNoNumberOldIsLowest(): string;
+  var
+    i: Integer;
+    MaxGen: integer;
+    src: string;
+    dst: string;
+    SlotFound: Boolean;
+  begin
+    Result := GenerateFilename(0);
+    if not FileExists(Result) then
+      exit;
+
+    SlotFound := false;
+    MaxGen := FMaxGenerations - 1;
+    for i := 1 to MaxGen do begin
+      dst := GenerateFilename(i);
+      if not FileExists(dst) then begin
+        SlotFound := true;
+        break;
+      end;
+    end;
+
+    if not SlotFound then begin
+      dst := GenerateFilename(1);
+      if FileExists(dst) then
+        TFileSystem.DeleteFile(dst);
+      for i := 2 to MaxGen do begin
+        src := GenerateFilename(i);
+        if FileExists(src) then
+          TFileSystem.MoveFile(src, dst);
+        dst := src;
+      end;
+    end;
+
+    if _KeepOriginal then
+      TFileSystem.CopyFile(Result, dst, true)
+    else
+      TFileSystem.MoveFile(Result, dst);
+  end;
+
+  function doNumberOldIsLowest(): string;
+  var
+    i: Integer;
+    MaxGen: integer;
+  begin
+    MaxGen := FMaxGenerations;
+    for i := 1 to MaxGen do begin
+      Result := GenerateFilename(i);
+      if not FileExists(Result) then
+        exit;
+    end;
+
+    TFileSystem.DeleteFile(GenerateFilename(1));
+    for i := 2 to MaxGen do begin
+      TFileSystem.MoveFile(GenerateFilename(i), GenerateFilename(i - 1));
+    end;
+    Result := GenerateFilename(MaxGen);
+    if _KeepOriginal then
+      TFileSystem.CopyFile(GenerateFilename(MaxGen - 1), Result, true);
+  end;
+
+begin
+  if FResultContainsNumber then begin
+    if _KeepOriginal then
+      raise EInvalidPropertyCombination.Create('Combination of ResultContainsNumber and KeepOriginal is not allowed');
+    if FOldestIsHighest then begin
+      Result := doNumberOldIsHighest();
+    end else begin
+      Result := doNumberOldIsLowest();
+    end;
+  end else begin
+    if FOldestIsHighest then begin
+      Result := doNoNumberOldIsHighest();
+    end else begin
+      Result := doNoNumberOldIsLowest();
+    end;
+  end;
+end;
+
+function TFileGenerationHandler.GenerateFilename(_Generation: integer): string;
+begin
+  if _Generation = 0 then
+    Result := FBaseName + FSuffix
+  else begin
+    if FPrependZeros = 0 then
+      Result := FBaseName + '_' + IntToStr(_Generation) + FSuffix
+    else
+      Result := Format('%s_%.*u%s', [FBaseName, FPrependZeros, _Generation, FSuffix]);
+  end;
+  if Assigned(FOnGenerateFilename) then
+    FOnGenerateFilename(Self, _Generation, Result);
+end;
+
+{ TDirectorySync }
+
+//procedure TDirectorySync.doOnDifferentFileExists(const _Filename: string; var _Action: TFileExistsAction);
+//begin
+//  _Action := feaIgnore;
+//  if Assigned(FOnDifferentFileExists) then
+//    FOnDifferentFileExists(_Filename, _Action);
+//end;
+
+function TDirectorySync.doOnFileExists(const _SrcDir, _DstDir, _Filename: string): TFileExistsAction;
+var
+  Src: TFileInfoRec;
+  Dst: TFileInfoRec;
+begin
+  Result := feaIgnore;
+  if not Assigned(FOnFileExists) then
+    exit;
+
+  Src := TFileSystem.GetFileInfo(_SrcDir + _Filename);
+  Dst := TFileSystem.GetFileInfo(_DstDir + _Filename);
+  FOnFileExists(self, Src, Dst, Result);
+end;
+
+procedure TDirectorySync.doOnSyncingDir(const _SrcDir, _DstDir: string);
+begin
+  if Assigned(FOnSyncingDir) then
+    FOnSyncingDir(Self, _SrcDir, _DstDir);
+end;
+
+procedure TDirectorySync.doOnSyncingFile(const _SrcFile, _DstFile: string);
+begin
+  if Assigned(FOnSyncingFile) then
+    FOnSyncingFile(self, _SrcFile, _DstFile);
+end;
+
+procedure TDirectorySync.CheckOneWay(const _SrcDir, _DstDir: string);
+var
+  Filename: string;
+  EnumA: TSimpleDirEnumerator;
+  DstDirBS: string;
+  SrcDirBS: string;
+begin
+  doOnSyncingDir(_SrcDir, _DstDir);
+  SrcDirBS := itpd(_SrcDir);
+  DstDirBS := itpd(_DstDir);
+  EnumA := TSimpleDirEnumerator.Create(SrcDirBS + '*.*');
+  try
+    while EnumA.FindNext(Filename) do begin
+      if (EnumA.Sr.Attr and SysUtils.faDirectory) <> 0 then begin
+        if DirectoryExists(DstDirBS + Filename) then
+          CheckOneWay(SrcDirBS + Filename, DstDirBS + Filename);
+      end else if FileExists(DstDirBS + Filename) then begin
+        doOnFileExists(SrcDirBS, DstDirBS, Filename);
+      end else begin
+        doOnSyncingFile(SrcDirBS + Filename, DstDirBS + Filename);
+      end;
+    end;
+  finally
+    EnumA.Free;
+  end;
+end;
+
+procedure TDirectorySync.SyncOneWay(const _SrcDir, _DstDir: string);
+var
+  Filename: string;
+  EnumA: TSimpleDirEnumerator;
+  DstDirBS: string;
+  SrcDirBS: string;
+begin
+  doOnSyncingDir(_SrcDir, _DstDir);
+  SrcDirBS := itpd(_SrcDir);
+  DstDirBS := itpd(_DstDir);
+  EnumA := TSimpleDirEnumerator.Create(SrcDirBS + '*.*');
+  try
+    while EnumA.FindNext(Filename) do begin
+      if (EnumA.Sr.Attr and SysUtils.faDirectory) <> 0 then begin
+        if not DirectoryExists(DstDirBS + Filename) then
+          TFileSystem.CreateDir(DstDirBS + Filename);
+        SyncOneWay(SrcDirBS + Filename, DstDirBS + Filename);
+      end else if FileExists(DstDirBS + Filename) then begin
+        if doOnFileExists(SrcDirBS, DstDirBS, Filename) = feaOverwrite then begin
+          doOnSyncingFile(SrcDirBS + Filename, DstDirBS + Filename);
+          TFileSystem.CopyFile(SrcDirBS + Filename, DstDirBS + Filename, false, true);
+        end;
+      end else begin
+        doOnSyncingFile(SrcDirBS + Filename, DstDirBS + Filename);
+        TFileSystem.CopyFile(SrcDirBS + Filename, DstDirBS + Filename, true, true);
+      end;
+    end;
+  finally
+    EnumA.Free;
+  end;
+end;
+
+procedure TDirectorySync.SyncBothWays(const _DirA, _DirB: string);
+begin
+  SyncOneWay(_DirA, _DirB);
+  SyncOneWay(_DirB, _DirA);
+end;
+
 end.
 

Modified: utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dpr
===================================================================
--- utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dpr	2007-05-28 14:38:31 UTC (rev 151)
+++ utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dpr	2007-05-28 14:41:55 UTC (rev 152)
@@ -24,7 +24,8 @@
   u_dzMiscUtils in '..\..\src\u_dzMiscUtils.pas',
   u_dzStringUtils in '..\..\src\u_dzStringUtils.pas',
   u_dzConvertUtils in '..\..\src\u_dzConvertUtils.pas',
-  u_dzTranslator in '..\..\src\u_dzTranslator.pas';
+  u_dzTranslator in '..\..\src\u_dzTranslator.pas',
+  u_dzDateUtils in '..\..\src\u_dzDateUtils.pas';
 
 {$R *.RES}
 

Modified: utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dproj
===================================================================
--- utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dproj	2007-05-28 14:38:31 UTC (rev 151)
+++ utilities/dzLib/trunk/tests/dzfileutils/DUnitTest_dzFileUtils.dproj	2007-05-28 14:41:55 UTC (rev 152)
@@ -1,5 +1,4 @@
-?<?xml version="1.0" encoding="utf-8"?>
-<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+?<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
   <PropertyGroup>
     <ProjectGuid>{9732bdc0-39a6-4dbb-817c-3fb77772e288}</ProjectGuid>
     <MainSource>DUnitTest_dzFileUtils.dpr</MainSource>
@@ -18,10 +17,10 @@
   <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
     <Version>7.0</Version>
     <DCC_Define>DEBUG;_CONSOLE_TESTRUNNER;no_translation</DCC_Define>
-    <DCC_UnitSearchPath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;..\..\inc</DCC_UnitSearchPath>
-    <DCC_ResourcePath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;..\..\inc</DCC_ResourcePath>
-    <DCC_ObjPath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;..\..\inc</DCC_ObjPath>
-    <DCC_IncludePath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;..\..\inc</DCC_IncludePath>
+    <DCC_UnitSearchPath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;;$(BDS)\Source\DUnit\src;..\..\inc</DCC_UnitSearchPath>
+    <DCC_ResourcePath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;;$(BDS)\Source\DUnit\src;..\..\inc</DCC_ResourcePath>
+    <DCC_ObjPath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;;$(BDS)\Source\DUnit\src;..\..\inc</DCC_ObjPath>
+    <DCC_IncludePath>$(BDS)\lib\Debug;$(BDS)\Lib\Debug\Indy10;;$(BDS)\Source\DUnit\src;..\..\inc</DCC_IncludePath>
     <DCC_DcuOutput>dcu</DCC_DcuOutput>
     <DCC_ObjOutput>dcu</DCC_ObjOutput>
     <DCC_HppOutput>dcu</DCC_HppOutput>
@@ -35,7 +34,45 @@
     <Borland.Personality>Delphi.Personality</Borland.Personality>
     <Borland.ProjectType />
     <BorlandProject>
-<BorlandProject><Delphi.Personality><Parameters><Parameters Name="UseLauncher">False</Parameters><Parameters Name="LoadAllSymbols">True</Parameters><Parameters Name="LoadUnspecifiedSymbols">False</Parameters></Parameters><VersionInfo><VersionInfo Name="IncludeVerInfo">False</VersionInfo><VersionInfo Name="AutoIncBuild">False</VersionInfo><VersionInfo Name="MajorVer">1</VersionInfo><VersionInfo Name="MinorVer">0</VersionInfo><VersionInfo Name="Release">0</VersionInfo><VersionInfo Name="Build">0</VersionInfo><VersionInfo Name="Debug">False</VersionInfo><VersionInfo Name="PreRelease">False</VersionInfo><VersionInfo Name="Special">False</VersionInfo><VersionInfo Name="Private">False</VersionInfo><VersionInfo Name="DLL">False</VersionInfo><VersionInfo Name="Locale">1033</VersionInfo><VersionInfo Name="CodePage">1252</VersionInfo></VersionInfo><VersionInfoKeys><VersionInfoKeys Name="CompanyName"></VersionInfoKeys><VersionInfoKeys Name="FileDescription"></VersionInfoKeys><VersionI!
 nfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="InternalName"></VersionInfoKeys><VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys><VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys><VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys><VersionInfoKeys Name="ProductName"></VersionInfoKeys><VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys><VersionInfoKeys Name="Comments"></VersionInfoKeys></VersionInfoKeys><Source><Source Name="MainSource">DUnitTest_dzFileUtils.dpr</Source></Source></Delphi.Personality><UnitTesting><TestFramework>DUnit / Delphi Win32</TestFramework><TestRunner>GUI</TestRunner></UnitTesting></BorlandProject></BorlandProject>
+<BorlandProject xmlns=""> <Delphi.Personality>   <Parameters>
+      <Parameters Name="UseLauncher">False</Parameters>
+      <Parameters Name="LoadAllSymbols">True</Parameters>
+      <Parameters Name="LoadUnspecifiedSymbols">False</Parameters>
+    </Parameters>
+    <VersionInfo>
+      <VersionInfo Name="IncludeVerInfo">False</VersionInfo>
+      <VersionInfo Name="AutoIncBuild">False</VersionInfo>
+      <VersionInfo Name="MajorVer">1</VersionInfo>
+      <VersionInfo Name="MinorVer">0</VersionInfo>
+      <VersionInfo Name="Release">0</VersionInfo>
+      <VersionInfo Name="Build">0</VersionInfo>
+      <VersionInfo Name="Debug">False</VersionInfo>
+      <VersionInfo Name="PreRelease">False</VersionInfo>
+      <VersionInfo Name="Special">False</VersionInfo>
+      <VersionInfo Name="Private">False</VersionInfo>
+      <VersionInfo Name="DLL">False</VersionInfo>
+      <VersionInfo Name="Locale">1033</VersionInfo>
+      <VersionInfo Name="CodePage">1252</VersionInfo>
+    </VersionInfo>
+    <VersionInfoKeys>
+      <VersionInfoKeys Name="CompanyName"></VersionInfoKeys>
+      <VersionInfoKeys Name="FileDescription"></VersionInfoKeys>
+      <VersionInfoKeys Name="FileVersion">1.0.0.0</VersionInfoKeys>
+      <VersionInfoKeys Name="InternalName"></VersionInfoKeys>
+      <VersionInfoKeys Name="LegalCopyright"></VersionInfoKeys>
+      <VersionInfoKeys Name="LegalTrademarks"></VersionInfoKeys>
+      <VersionInfoKeys Name="OriginalFilename"></VersionInfoKeys>
+      <VersionInfoKeys Name="ProductName"></VersionInfoKeys>
+      <VersionInfoKeys Name="ProductVersion">1.0.0.0</VersionInfoKeys>
+      <VersionInfoKeys Name="Comments"></VersionInfoKeys>
+    </VersionInfoKeys>
+    <Source>
+      <Source Name="MainSource">DUnitTest_dzFileUtils.dpr</Source>
+    </Source>
+  </Delphi.Personality>   <UnitTesting>   <TestFramework>DUnit / Delphi Win32</TestFramework>
+    <TestRunner>GUI</TestRunner>
+  </UnitTesting>
+</BorlandProject></BorlandProject>
   </ProjectExtensions>
   <Import Project="$(MSBuildBinPath)\Borland.Delphi.Targets" />
   <ItemGroup>

Modified: utilities/dzLib/trunk/tests/dzfileutils/Testu_dzFileUtils.pas
===================================================================
--- utilities/dzLib/trunk/tests/dzfileutils/Testu_dzFileUtils.pas	2007-05-28 14:38:31 UTC (rev 151)
+++ utilities/dzLib/trunk/tests/dzfileutils/Testu_dzFileUtils.pas	2007-05-28 14:41:55 UTC (rev 152)
@@ -10,24 +10,174 @@
   u_dzFileUtils;
 
 type
-  TestTFileSystem = class(TTestCase)
+  TFileSystemTestCase = class(TTestCase)
+  protected
+    FTestDir: string;
+    procedure SetUp; override;
+    procedure TearDown; override;
+    function CreateTestFile(const _Filename, _Content: string): string;
+    procedure CheckTestfile(const _Filename, _Content: string);
+    procedure CheckSubdirExists(const _Dirname: string);
+  end;
+
+type
+  TestTFileSystem = class(TFileSystemTestCase)
   private
     FCallbackCount: integer;
+    FSourceFile: string;
+    FDestFile: string;
     procedure ProgressContinue(_Status: TCopyProgressStatus;
       var _Continue: TCopyProgressStatus.TProgressResult);
     procedure ProgressCancel(_Status: TCopyProgressStatus;
       var _Continue: TCopyProgressStatus.TProgressResult);
   protected
     procedure SetUp; override;
+    procedure TearDown; override;
   published
     procedure TestCopyFileWithProgressContinue;
     procedure TestCopyFileWithProgressCancel;
     procedure TestMoveFileWithProgressCancel;
   end;
 
+  TestTDirectorySync = class(TFileSystemTestCase)
+  private
+    FDirA: string;
+    FDirB: string;
+    FSync: TDirectorySync;
+    FFile1: string;
+    FFile2: string;
+    FFile3: string;
+    FFile4: string;
+    FFile5: string;
+    FFile6: string;
+    FFileA7: string;
+    FFileB7: string;
+    FCallbacks: TStringList;
+    FExistingFiles: TStringList;
+    procedure OnSyncDirAbort(_Sender: TObject; const _Src, _Dst: string);
+    procedure OnSyncCallback(_Sender: TObject; const _Src, _Dst: string);
+    procedure OnFileExistsCallback(_Sender: TObject; const _Src, _Dst: TFileInfoRec);
+    procedure CheckSameText(const _Expected, _Actual, _Msg: string);
+  protected
+    procedure SetUp; override;
+    procedure TearDown; override;
+  published
+    procedure TestSyncOneWay;
+    procedure TestSyncBoth;
+    procedure TestSyncAbortImmediately;
+    procedure TestSyncOneWayCallback;
+    procedure TestCheckOneWay;
+  end;
+
+  TestTFileGenerationHandler_Base = class(TFileSystemTestCase)
+  private
+    FHandler: TFileGenerationHandler;
+  protected
+    procedure SetUp; override;
+    procedure TearDown; override;
+  end;
+
+  TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_NotKeep = class(TestTFileGenerationHandler_Base)
+  published
+    procedure TestNoneExisting;
+    procedure TestOneExisting;
+    procedure TestAllExisting;
+  end;
+
+  TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_Keep = class(TestTFileGenerationHandler_Base)
+  published
+    procedure TestNoneExisting;
+    procedure TestOneExisting;
+    procedure TestAllExisting;
+  end;
+
+  TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_NotKeep = class(TestTFileGenerationHandler_Base)
+  protected
+    procedure SetUp; override;
+  published
+    procedure TestNoneExisting;
+    procedure TestOneExisting;
+    procedure TestTwoExisting;
+    procedure TestAllExisting;
+  end;
+
+  TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_Keep = class(TestTFileGenerationHandler_Base)
+  protected
+    procedure SetUp; override;
+  published
+    procedure TestNoneExisting;
+    procedure TestOneExisting;
+    procedure TestTwoExisting;
+    procedure TestAllExisting;
+  end;
+
+  TestTFileGenerationHandler_OldestIsHighest_ResultContainsNumber_NotKeep = class(TestTFileGenerationHandler_Base)
+  protected
+    procedure SetUp; override;
+  published
+    procedure TestNoneExisting;
+    procedure TestOneExisting;
+    procedure TestAllExisting;
+  end;
+
+  TestTFileGenerationHandler_NotOldestIsHighest_ResultContainsNumber_NotKeep = class(TestTFileGenerationHandler_Base)
+  protected
+    procedure SetUp; override;
+  published
+    procedure TestNoneExisting;
+    procedure TestOneExisting;
+    procedure TestAllExisting;
+  end;
+
 implementation
 
+{ TFileSystemTestCase }
 
+procedure TFileSystemTestCase.CheckTestfile(const _Filename, _Content: string);
+var
+  t: TextFile;
+  s: string;
+begin
+  Check(FileExists(FTestDir + _Filename), _Filename + ' does not exist');
+  AssignFile(t, FTestDir + _Filename);
+  Reset(t);
+  Read(t, s);
+  Close(t);
+  CheckEquals(_Content, s, 'content of file ' + _Filename);
+end;
+
+procedure TFileSystemTestCase.CheckSubdirExists(const _Dirname: string);
+begin
+  Check(DirectoryExists(FTestDir + _Dirname), 'directory ' + _Dirname + ' missing');
+end;
+
+function TFileSystemTestCase.CreateTestFile(const _Filename, _Content: string): string;
+var
+  t: TextFile;
+begin
+  Result := FTestDir + _Filename;
+  AssignFile(t, Result);
+  Rewrite(t);
+  WriteLn(t, _Content);
+  Close(t);
+end;
+
+procedure TFileSystemTestCase.SetUp;
+begin
+  inherited;
+  FTestDir := itpd(TFileSystem.CreateUniqueDirectory());
+end;
+
+procedure TFileSystemTestCase.TearDown;
+begin
+  TFileSystem.DelTree(FTestDir);
+  inherited;
+end;
+
+const
+  GENERATION_FILENAME = 'hallo';
+  GENERATION_SUFFIX = '.txt';
+
 { TestTFileSystem }
 
 procedure TestTFileSystem.ProgressCancel(_Status: TCopyProgressStatus;
@@ -45,48 +195,588 @@
 end;
 
 procedure TestTFileSystem.SetUp;
+const
+  SOURCEFILE = 'sourcefile.txt';
+  DESTFILE = 'destfile.txt';
 begin
   inherited;
   FCallbackCount := 0;
+  FSourceFile := CreateTestFile(SOURCEFILE, 'source');
+  FDestFile := FTestDir + DESTFILE;
+  if FileExists(FDestFile) then
+    TFileSystem.DeleteFile(FDestFile);
 end;
 
+procedure TestTFileSystem.TearDown;
+begin
+  inherited;
+  TFileSystem.DeleteFile(FSourceFile, false);
+  TFileSystem.DeleteFile(FDestFile, false);
+end;
+
 procedure TestTFileSystem.TestCopyFileWithProgressContinue;
-const
-  SOURCEFILE = 'testdata\sourcefile.txt';
-  DESTFILE = 'testdata\destfile.txt';
 var
   Res: TFileSystem.TCopyFileWithProgressResult;
 begin
-  Res := TFileSystem.CopyFileWithProgress(SOURCEFILE, DESTFILE, ProgressContinue);
+  Res := TFileSystem.CopyFileWithProgress(FSourceFile, FDestFile, ProgressContinue);
   Check(Res = cfwOK, 'aborted or error');
-  CheckTrue(FileExists(DESTFILE), 'destination file missing');
+  CheckTrue(FileExists(FDestFile), 'destination file missing');
   CheckEquals(2, FCallbackCount, 'Callback count wrong');
 end;
 
 procedure TestTFileSystem.TestMoveFileWithProgressCancel;
-const
-  SOURCEFILE = 'testdata\sourcefile.txt';
-  DESTFILE = 'testdata\destfile.txt';
 var
   Res: TFileSystem.TCopyFileWithProgressResult;
 begin
-  Res := TFileSystem.MoveFileWithProgress(SOURCEFILE, DESTFILE, ProgressCancel, []);
+  Res := TFileSystem.MoveFileWithProgress(FSourceFile, FDestFile, ProgressCancel, []);
   Check(Res = cfwOK, 'aborted expected');
+  CheckFalse(FileExists(FDestFile), 'destination file exists');
 end;
 
 procedure TestTFileSystem.TestCopyFileWithProgressCancel;
-const
-  SOURCEFILE = 'testdata\sourcefile.txt';
-  DESTFILE = 'testdata\destfile.txt';
 var
   Res: TFileSystem.TCopyFileWithProgressResult;
 begin
-  Res := TFileSystem.CopyFileWithProgress(SOURCEFILE, DESTFILE, ProgressCancel, []);
+  Res := TFileSystem.CopyFileWithProgress(FSourceFile, FDestFile, ProgressCancel, []);
   Check(Res = cfwAborted, 'aborted expected');
   CheckEquals(1, FCallbackCount, 'Callback count wrong');
 end;
 
+{ TestTFileGenerationHandler_Base }
+
+procedure TestTFileGenerationHandler_Base.SetUp;
+begin
+  inherited;
+  FHandler := TFileGenerationHandler.Create(FTestDir + GENERATION_FILENAME, GENERATION_SUFFIX);
+end;
+
+procedure TestTFileGenerationHandler_Base.TearDown;
+begin
+  FHandler.Free;
+  inherited;
+end;
+
+{ TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber }
+
+procedure TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_NotKeep.TestAllExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '1');
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '2');
+  CreateTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '3');
+  CreateTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '4');
+  CreateTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '5');
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CheckTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '2');
+  CheckTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '3');
+  CheckTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '4');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_5' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+procedure TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_NotKeep.TestNoneExisting;
+var
+  s: string;
+begin
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+end;
+
+procedure TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_NotKeep.TestOneExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_2' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+{ TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_Keep }
+
+procedure TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_Keep.TestAllExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '1');
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '2');
+  CreateTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '3');
+  CreateTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '4');
+  CreateTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '5');
+  s := FHandler.Execute(True);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '1');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CheckTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '2');
+  CheckTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '3');
+  CheckTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '4');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_5' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+procedure TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_Keep.TestNoneExisting;
+var
+  s: string;
+begin
+  s := FHandler.Execute(true);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+end;
+
+procedure TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_Keep.TestOneExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(true);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '1');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_2' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+{ TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber }
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_NotKeep.SetUp;
+begin
+  inherited;
+  FHandler.OldestIsHighest := false;
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_NotKeep.TestAllExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '5');
+  CreateTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '4');
+  CreateTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '3');
+  CreateTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '2');
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '2');
+  CheckTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '3');
+  CheckTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '4');
+  CheckTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '5');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_5' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_NotKeep.TestNoneExisting;
+var
+  s: string;
+begin
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_NotKeep.TestOneExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_2' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_NotKeep.TestTwoExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '2');
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CheckTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '2');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_3' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+{ TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_Keep }
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_Keep.SetUp;
+begin
+  inherited;
+  FHandler.OldestIsHighest := false;
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_Keep.TestAllExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '5');
+  CreateTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '4');
+  CreateTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '3');
+  CreateTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '2');
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(true);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '5');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '2');
+  CheckTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '3');
+  CheckTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '4');
+  CheckTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '5');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_5' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_Keep.TestNoneExisting;
+var
+  s: string;
+begin
+  s := FHandler.Execute(true);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_Keep.TestOneExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(true);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '1');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_2' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_Keep.TestTwoExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '2');
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(true);
+  CheckEquals(FTestDir + GENERATION_FILENAME + GENERATION_SUFFIX, s, 'filename');
+  CheckTestfile(GENERATION_FILENAME + GENERATION_SUFFIX, '2');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CheckTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '2');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_3' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+{ TestTFileGenerationHandler_OldestIsHighest_ResultContainsNumber }
+
+procedure TestTFileGenerationHandler_OldestIsHighest_ResultContainsNumber_NotKeep.SetUp;
+begin
+  inherited;
+  FHandler.ResultContainsNumber := true;
+end;
+
+procedure TestTFileGenerationHandler_OldestIsHighest_ResultContainsNumber_NotKeep.TestAllExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '2');
+  CreateTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '3');
+  CreateTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '4');
+  CreateTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '5');
+  CreateTestfile(GENERATION_FILENAME + '_5' + GENERATION_SUFFIX, '6');
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+  CheckTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '2');
+  CheckTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '3');
+  CheckTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '4');
+  CheckTestfile(GENERATION_FILENAME + '_5' + GENERATION_SUFFIX, '5');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_6' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+procedure TestTFileGenerationHandler_OldestIsHighest_ResultContainsNumber_NotKeep.TestNoneExisting;
+var
+  s: string;
+begin
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+end;
+
+procedure TestTFileGenerationHandler_OldestIsHighest_ResultContainsNumber_NotKeep.TestOneExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+  CheckTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '1');
+end;
+
+{ TestTFileGenerationHandler_NotOldestIsHighest_ResultContainsNumber }
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_ResultContainsNumber_NotKeep.SetUp;
+begin
+  inherited;
+  FHandler.OldestIsHighest := false;
+  FHandler.ResultContainsNumber := true;
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_ResultContainsNumber_NotKeep.TestAllExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CreateTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '2');
+  CreateTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '3');
+  CreateTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '4');
+  CreateTestfile(GENERATION_FILENAME + '_5' + GENERATION_SUFFIX, '5');
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + '_5' + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '2');
+  CheckTestfile(GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, '3');
+  CheckTestfile(GENERATION_FILENAME + '_3' + GENERATION_SUFFIX, '4');
+  CheckTestfile(GENERATION_FILENAME + '_4' + GENERATION_SUFFIX, '5');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_6' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_ResultContainsNumber_NotKeep.TestNoneExisting;
+var
+  s: string;
+begin
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+end;
+
+procedure TestTFileGenerationHandler_NotOldestIsHighest_ResultContainsNumber_NotKeep.TestOneExisting;
+var
+  s: string;
+begin
+  CreateTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  s := FHandler.Execute(false);
+  CheckEquals(FTestDir + GENERATION_FILENAME + '_2' + GENERATION_SUFFIX, s, 'filename');
+  CheckFalse(FileExists(s), 'file exists');
+  CheckTestfile(GENERATION_FILENAME + '_1' + GENERATION_SUFFIX, '1');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_3' + GENERATION_SUFFIX), 'additional backup file exists');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_4' + GENERATION_SUFFIX), 'additional backup file exists');
+  CheckFalse(FileExists(FTestDir + GENERATION_FILENAME + '_5' + GENERATION_SUFFIX), 'additional backup file exists');
+end;
+
+{ TestTDirectorySync }
+
+procedure TestTDirectorySync.SetUp;
+begin
+  inherited;
+  FDirA := FTestDir + 'a\';
+  FDirB := FTestDir + 'b\';
+  TFileSystem.CreateDir(FDirA);
+  TFileSystem.CreateDir(FDirB);
+
+  FFile1 := CreateTestfile('a\file1.txt', 'File1');
+  FFile2 := CreateTestfile('a\.txt', 'File2');
+  FFile3 := CreateTestfile('a\file3', 'File3');
+  TFileSystem.CreateDir(FDirA + '\Sub1');
+  TFileSystem.CreateDir(FDirA + '\Sub2');
+  FFile4 := CreateTestfile('a\Sub2\file4.txt', 'File4');
+
+  FFile5 := CreateTestFile('b\file5.txt', 'File5');
+  TFileSystem.CreateDir(FDirB + '\Sub3');
+  FFile6 := CreateTestFile('b\sub3\file6.txt', 'File6');
+  TFileSystem.CreateDir(FDirB + '\Sub4');
+
+  TFileSystem.CreateDir(FDirA + '\Sub5');
+  TFileSystem.CreateDir(FDirB + '\Sub5');
+
+  TFileSystem.CreateDir(FDirA + '\Sub6');
+  TFileSystem.CreateDir(FDirB + '\Sub6');
+  FFileA7 := CreateTestFile('a\sub6\file7.txt', 'FileA7');
+  FFileB7 := CreateTestFile('b\sub6\file7.txt', 'FileB7');
+
+  FCallbacks := TStringList.Create;
+
+  FSync := TDirectorySync.Create;
+end;
+
+procedure TestTDirectorySync.TearDown;
+begin
+  FSync.Free;
+  FCallbacks.Free;
+  inherited;
+end;
+
+procedure TestTDirectorySync.TestSyncOneWay;
+var
+  Enum: TSimpleDirEnumerator;
+  Files: TStringList;
+  cnt: integer;
+begin
+  FSync.SyncOneWay(FDirA, FDirB);
+  Enum := TSimpleDirEnumerator.Create(FDirB + '*.*');
+  try
+    Files := TStringList.Create;
+    cnt := Enum.FindAll(Files);
+    Files.Free;
+  finally
+    Enum.Free;
+  end;
+  CheckEquals(10, cnt, 'number of files and subdirs');
+  CheckTestfile('b\' + ExtractFileName(FFile1), 'File1');
+  CheckTestfile('b\' + ExtractFileName(FFile2), 'File2');
+  CheckTestfile('b\' + ExtractFileName(FFile3), 'File3');
+  CheckSubdirExists('b\Sub1');
+  CheckSubdirExists('b\Sub2');
+  CheckTestfile('b\Sub2\' + ExtractFileName(FFile4), 'File4');
+  CheckTestfile('b\' + ExtractFileName(FFile5), 'File5');
+  CheckSubdirExists('b\Sub3');
+  CheckTestfile('b\Sub3\' + ExtractFileName(FFile6), 'File6');
+  CheckSubdirExists('b\Sub4');
+
+  CheckSubdirExists('b\Sub5');
+  CheckSubdirExists('b\Sub6');
+  CheckTestfile('b\Sub6\' + ExtractFileName(FFileB7), 'FileB7');
+end;
+
+procedure TestTDirectorySync.TestSyncOneWayCallback;
+begin
+  FSync.OnSyncingDir := OnSyncCallback;
+  FSync.OnSyncingFile := OnSyncCallback;
+  FSync.SyncOneWay(FDirA, FDirB);
+  CheckEquals(9, FCallbacks.Count, 'callback count');
+  CheckEquals(FDirA + ' -> ' + FDirB, FCallbacks[0], 'callback 0');
+  CheckEquals(FDirA + '.txt -> ' + FDirB + '.txt', FCallbacks[1], 'callback 1');
+  CheckEquals(FDirA + 'file1.txt -> ' + FDirB + 'file1.txt', FCallbacks[2], 'callback 2');
+  CheckEquals(FDirA + 'file3 -> ' + FDirB + 'file3', FCallbacks[3], 'callback 3');
+  CheckEquals(FDirA + 'Sub1 -> ' + FDirB + 'Sub1', FCallbacks[4], 'callback 4');
+  CheckEquals(FDirA + 'Sub2 -> ' + FDirB + 'Sub2', FCallbacks[5], 'callback 5');
+  CheckEquals(FDirA + 'Sub2\file4.txt -> ' + FDirB + 'Sub2\file4.txt', FCallbacks[6], 'callback 6');
+  CheckEquals(FDirA + 'Sub5 -> ' + FDirB + 'Sub5', FCallbacks[7], 'callback 7');
+  CheckEquals(FDirA + 'Sub6 -> ' + FDirB + 'Sub6', FCallbacks[8], 'callback 8');
+end;
+
+procedure TestTDirectorySync.OnSyncCallback(_Sender: TObject; const _Src, _Dst: string);
+begin
+  FCallbacks.Add(_Src + ' -> ' + _Dst);
+end;
+
+procedure TestTDirectorySync.OnSyncDirAbort(_Sender: TObject; const _Src, _Dst: string);
+begin
+  SysUtils.Abort;
+end;
+
+procedure TestTDirectorySync.CheckSameText(const _Expected, _Actual, _Msg: string);
+begin
+  if not SameText(_Expected, _Actual) then
+    FailNotEquals(_Expected, _Actual, _Msg);
+end;
+
+procedure TestTDirectorySync.OnFileExistsCallback(_Sender: TObject; const _Src, _Dst: TFileInfoRec);
+begin
+  FExistingFiles.Add(_Src.Filename + ' <> ' + _Dst.Filename);
+  CheckEquals(_Src.Size, _Dst.Size, 'Size');
+  CheckEquals(_Src.Timestamp, _Dst.Timestamp, 'Timestamp');
+end;
+
+procedure TestTDirectorySync.TestCheckOneWay;
+begin
+  FExistingFiles := TStringList.Create;
+  try
+    FSync.OnFileExists := OnFileExistsCallback;
+    FSync.CheckOneWay(FDirA, FDirB);
+    CheckEquals(1, FExistingFiles.Count, 'existing count');
+    CheckSameText(FFileA7 + ' <> ' + FFileB7, FExistingFiles[0], 'File7');
+  finally
+    FExistingFiles.Free;
+  end;
+end;
+
+procedure TestTDirectorySync.TestSyncAbortImmediately;
+var
+  Enum: TSimpleDirEnumerator;
+  Files: TStringList;
+  cnt: integer;
+begin
+  FSync.OnSyncingDir := OnSyncDirAbort;
+  try
+    FSync.SyncOneWay(FDirA, FDirB);
+  except on EAbort do
+      ;
+  end;
+  Enum := TSimpleDirEnumerator.Create(FDirB + '*.*');
+  try
+    Files := TStringList.Create;
+    cnt := Enum.FindAll(Files);
+    Files.Free;
+  finally
+    Enum.Free;
+  end;
+  CheckEquals(5, cnt, 'number of files and subdirs');
+end;
+
+procedure TestTDirectorySync.TestSyncBoth;
+var
+  Enum: TSimpleDirEnumerator;
+  Files: TStringList;
+  cnt: integer;
+begin
+  FSync.SyncBothWays(FDirA, FDirB);
+
+  Enum := TSimpleDirEnumerator.Create(FDirB + '*.*');
+  try
+    Files := TStringList.Create;
+    cnt := Enum.FindAll(Files);
+    Files.Free;
+  finally
+    Enum.Free;
+  end;
+  CheckEquals(10, cnt, 'number of files and subdirs');
+  CheckTestfile('b\' + ExtractFileName(FFile1), 'File1');
+  CheckTestfile('b\' + ExtractFileName(FFile2), 'File2');
+  CheckTestfile('b\' + ExtractFileName(FFile3), 'File3');
+  CheckSubdirExists('b\Sub1');
+  CheckSubdirExists('b\Sub2');
+  CheckTestfile('b\Sub2\' + ExtractFileName(FFile4), 'File4');
+  CheckTestfile('b\' + ExtractFileName(FFile5), 'File5');
+  CheckSubdirExists('b\Sub3');
+  CheckTestfile('b\Sub3\' + ExtractFileName(FFile6), 'File6');
+  CheckSubdirExists('b\Sub4');
+
+  CheckSubdirExists('b\Sub5');
+  CheckSubdirExists('b\Sub6');
+  CheckTestfile('b\Sub6\' + ExtractFileName(FFileB7), 'FileB7');
+
+  Enum := TSimpleDirEnumerator.Create(FDirA + '*.*');
+  try
+    Files := TStringList.Create;
+    cnt := Enum.FindAll(Files);
+    Files.Free;
+  finally
+    Enum.Free;
+  end;
+  CheckEquals(10, cnt, 'number of files and subdirs');
+  CheckTestfile('a\' + ExtractFileName(FFile1), 'File1');
+  CheckTestfile('a\' + ExtractFileName(FFile2), 'File2');
+  CheckTestfile('a\' + ExtractFileName(FFile3), 'File3');
+  CheckSubdirExists('a\Sub1');
+  CheckSubdirExists('a\Sub2');
+  CheckTestfile('a\Sub2\' + ExtractFileName(FFile4), 'File4');
+  CheckTestfile('a\' + ExtractFileName(FFile5), 'File5');
+  CheckSubdirExists('a\Sub3');
+  CheckTestfile('a\Sub3\' + ExtractFileName(FFile6), 'File6');
+  CheckSubdirExists('a\Sub4');
+
+  Check(DirectoryExists(FDirA + 'Sub5'), 'directory Sub5 missing');
+  Check(DirectoryExists(FDirA + 'Sub6'), 'directory Sub6 missing');
+  CheckTestfile('a\Sub6\' + ExtractFileName(FFileB7), 'FileA7');
+end;
+
 initialization
   RegisterTest(TestTFileSystem.Suite);
+  RegisterTest(TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_NotKeep.Suite);
+  RegisterTest(TestTFileGenerationHandler_OldestIsHighest_NotResultContainsNumber_Keep.Suite);
+  RegisterTest(TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_NotKeep.Suite);
+  RegisterTest(TestTFileGenerationHandler_NotOldestIsHighest_NotResultContainsNumber_Keep.Suite);
+  RegisterTest(TestTFileGenerationHandler_OldestIsHighest_ResultContainsNumber_NotKeep.Suite);
+  RegisterTest(TestTFileGenerationHandler_NotOldestIsHighest_ResultContainsNumber_NotKeep.Suite);
+  RegisterTest(TestTDirectorySync.Suite);
 end.
 



From twm at mail.berlios.de  Mon May 28 16:42:47 2007
From: twm at mail.berlios.de (twm at mail.berlios.de)
Date: Mon, 28 May 2007 16:42:47 +0200
Subject: [Dzchart-svncheckins] r153 - utilities/dzLib/trunk/src
Message-ID: <200705281442.l4SEgltw022709@sheep.berlios.de>

Author: twm
Date: 2007-05-28 16:42:41 +0200 (Mon, 28 May 2007)
New Revision: 153

Modified:
   utilities/dzLib/trunk/src/u_dzVclUtils.pas
Log:
adapted VclUtils to moved functions

Modified: utilities/dzLib/trunk/src/u_dzVclUtils.pas
===================================================================
--- utilities/dzLib/trunk/src/u_dzVclUtils.pas	2007-05-28 14:41:55 UTC (rev 152)
+++ utilities/dzLib/trunk/src/u_dzVclUtils.pas	2007-05-28 14:42:41 UTC (rev 153)
@@ -364,7 +364,7 @@
   rxGif,
 {$ENDIF GIFByRx}
   u_dzTranslator,
-  u_dzMiscUtils,
+  u_dzConvertUtils,
   u_dzStringUtils;
 
 // we need this to access protected methods



