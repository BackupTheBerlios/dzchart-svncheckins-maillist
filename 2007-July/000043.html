<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dzchart-svncheckins] r168 - utilities/dzLib/trunk/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dzchart-svncheckins/2007-July/index.html" >
   <LINK REL="made" HREF="mailto:dzchart-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5BDzchart-svncheckins%5D%20r168%20-%20utilities/dzLib/trunk/src&In-Reply-To=%3C200707141243.l6EChfrF002823%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000042.html">
   <LINK REL="Next"  HREF="000044.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dzchart-svncheckins] r168 - utilities/dzLib/trunk/src</H1>
    <B>twm at mail.berlios.de</B> 
    <A HREF="mailto:dzchart-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5BDzchart-svncheckins%5D%20r168%20-%20utilities/dzLib/trunk/src&In-Reply-To=%3C200707141243.l6EChfrF002823%40sheep.berlios.de%3E"
       TITLE="[Dzchart-svncheckins] r168 - utilities/dzLib/trunk/src">twm at mail.berlios.de
       </A><BR>
    <I>Sat Jul 14 14:43:41 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000042.html">[Dzchart-svncheckins] r167 - utilities/dzLib/trunk/src
</A></li>
        <LI>Next message: <A HREF="000044.html">[Dzchart-svncheckins] r169 - in utilities/dzPrepBuild/trunk: . src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43">[ date ]</a>
              <a href="thread.html#43">[ thread ]</a>
              <a href="subject.html#43">[ subject ]</a>
              <a href="author.html#43">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: twm
Date: 2007-07-14 14:43:40 +0200 (Sat, 14 Jul 2007)
New Revision: 168

Modified:
   utilities/dzLib/trunk/src/u_dzDefaultMain.pas
Log:
if running in the debugger at the end the exit code is displayed and the program waits for Enter

Modified: utilities/dzLib/trunk/src/u_dzDefaultMain.pas
===================================================================
--- utilities/dzLib/trunk/src/u_dzDefaultMain.pas	2007-07-14 11:48:45 UTC (rev 167)
+++ utilities/dzLib/trunk/src/u_dzDefaultMain.pas	2007-07-14 12:43:40 UTC (rev 168)
@@ -30,51 +30,52 @@
     FExitCode: integer;
     {: Created in InitCmdLineParser, allows reading the parameters }
     FGetOpt: TGetOpt;
-    {: Initializes FCmdLineParser with a Parser, should be overridden }
+    {: Initializes FGetOptr with a Parser, should be overridden, but make
+       sure you call inherited }
     procedure InitCmdLineParser; virtual;
-    {: Zeigt eine vom FCmdLineParser generierte Kurzhilfe zum Programm an und
-       beendet das Programm durch Aufruf von SysUtils.Abort.
-       @param Error ist eine optionale Fehlermeldung, wenn nicht leer, wird sie ausgegeben }
+    {: Shows a short help generated by the TGetOpt and exits the program by calling
+       SysUtils.Abort.
+       @param Error is an optional error message, which is displayed if not empty }
     procedure Usage(const _Error: string = ''); virtual;
-    {: Ruft die Execute-Methode des Commandline-Parsers auf, danach stehen die
-       Parameter zur Verfuegung. Falls beim Parsen ein Fehler auftritt, so wird
-       automatisch Usage mit der entsprechenden Fehlermeldung aufgerufen. }
+    {: Calls the Parse method of the commandline parser. Afterwards the parameters
+       and options can be accessed using the perser's methods and properties.
+       If there is an error during parsing it automatically calls Usage with
+       the error message. If a help option (-?, -h or -Help) is found, usage
+       will be called without an error message. }
     procedure ParseCmdLine; virtual;
-    {: Diese Methode sollte ueberschrieben werden und die eigentliche Programmfunktion
-       ausfuehren. Sie wird nach dem Parsen der Commandline aufgerufen, so dass
-       zu diesem Zeitpunkt sichergestellt ist, dass die Parameter OK sind.
-       @returns den Exit-Code fuer das Programm }
+    {: This method should be overridden to implement the actual program functionality.
+       It is called after the commandline has ben parsed so you can be sure that
+       the parameters are OK.
+       @returns the exit code for the program }
     function doExecute: integer; virtual;
   public
-    {: Erzeugt eine TDefaultMain-Instanz, setzt den Exit-Code auf 1 (=Fehler)
-       und initialisiert das Logging. }
+    {: Creates a TDefaultMain instance, sets the exit code to 1 (=error) and
+       initializes logging }
     constructor Create; virtual;
-    {: Gibt eine TDefaultMain-Instanz frei und schreibt das
-       Programmende ins Log. }
+    {: Frees a TDefaultMain instance and writes the progrem end into the log }
     destructor Destroy; override;
-    {: Diese Methode sollte aufgerufen werden. Sie initialisiert den Commandline-Parser,
-       fuehrt ihn aus und ruft dann doExecute innerhalb eines Try-Except-Blocks auf
-       Falls in doExecute eine Exception geraised wird, so wird sie hier abgefangen,
-       eine Fehlermeldung auf die Konsole ausgegeben und der Exit-Code auf 1 (=Fehler) gesetzt
-       Falls doExecute ganz normal beendet wird, so wird dessen Ergebnis als
-       Exit-Code verwendet.
-       @returns den Exit-Code des Programms }
+    {: This method should be called after the instance of TDefaultMain has been
+       created. It initialzies the commandline parser, executes it on the given
+       commandline and calls doExecute within a try..except block.
+       If doExecute raises an exception it will write an error message to the
+       console and set the exit code to 1 (=error). If doExecute exits normally
+       it uses the result as exit code.
+       @returns the exit code for the program }
     function Execute: integer;
   end;
 
 type
-  {: Class-Type fuer die globale Variable MainClass }
+  {: Class-Type for the global variable MainClass }
   TMainClass = class of TDefaultMain;
 
 var
-  {: Globale Variable, die auf die Main-Klasse zeigt. Diese
-     Variable wird innerhalb der Funktion @link(Main) verwendet,
-     um eine Klasse zu erzeugen und auszufuehren }
+  {: global variable that points to the main class. This variable is used in
+     @link(Main) to create a TDefaultMain descendant and exeute it. }
   MainClass: TMainClass = TDefaultMain;
 
-  {: Erzeugt eine Instanz von MainClass, ruft deren Execute-Methode auf und liefert
-     den Exit-Code zurueck
-     @returns den Exit-Code des Programms }
+  {: Creates an instance of MainClass, calls its execute method and returns
+     the exit code.
+     @returns the exit code for the program }
 function Main: integer;
 
 implementation
@@ -89,7 +90,7 @@
 constructor TDefaultMain.Create;
 begin
   inherited;
-  // default: Fehler
+  // default: error
   FExitCode := 1;
 end;
 
@@ -178,12 +179,17 @@
       MainObj.Free;
     end;
   except
-    // Exception handling findet im MainObj statt, was bis hierher kommt,
-    // kann man eh nicht mehr behandeln - aber evt. Loggen ? AS
+    // Exception handling is done within the MainObj. If something gets here
+    // it cannot be handled anyway.
+    // - but maybe log it? -- AS
     on e: Exception do begin
       LogError('Exception in function Main: ' + e.Message + ' ' + e.ClassName);
     end;
   end;
+  if DebugHook &lt;&gt; 0 then begin
+    Write('Exit Code: ', Result, ' -- press Enter');
+    Readln;
+  end;
 end;
 
 end.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000042.html">[Dzchart-svncheckins] r167 - utilities/dzLib/trunk/src
</A></li>
	<LI>Next message: <A HREF="000044.html">[Dzchart-svncheckins] r169 - in utilities/dzPrepBuild/trunk: . src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43">[ date ]</a>
              <a href="thread.html#43">[ thread ]</a>
              <a href="subject.html#43">[ subject ]</a>
              <a href="author.html#43">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dzchart-svncheckins">More information about the dzchart-svncheckins
mailing list</a><br>
</body></html>
